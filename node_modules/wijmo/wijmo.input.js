/*!
    *
    * Wijmo Library 5.20231.879
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);t.default=e;return t};Object.defineProperty(exports,"__esModule",{value:!0});var wijmo_1=require("wijmo/wijmo"),selfModule=__importStar(require("wijmo/wijmo.input"));wijmo_1._addCultureInfo("InputNumber",{ariaLabels:{incVal:"Increase Value",decVal:"Decrease Value"}});var InputNumber=function(e){__extends(InputNumber,e);function InputNumber(t,i){var o=e.call(this,t)||this;o._value=null;o._min=null;o._max=null;o._format="";o._step=null;o._showBtn=!0;o._readOnly=!1;o._handleWheel=!0;o._oldText="";o._fromKb=!0;o.textChanged=new wijmo_1.Event;o.valueChanged=new wijmo_1.Event;var n=o.hostElement;wijmo_1.setAttribute(n,"role","spinbutton",!0);var s=o.getTemplate();o.applyTemplate("wj-control wj-content wj-inputnumber",s,{_tbx:"input",_btnUp:"btn-inc",_btnDn:"btn-dec"},"input");var r=wijmo_1.culture.InputNumber.ariaLabels;wijmo_1.setAriaLabel(o._btnUp.querySelector("button"),r.incVal);wijmo_1.setAriaLabel(o._btnDn.querySelector("button"),r.decVal);o._tbx.type.match(/number/i)&&(o.inputType="");var a=o._tbx;a.autocomplete="off";a.spellcheck=!1;o._updateSymbols();var l=o.addEventListener.bind(o);l(a,"keypress",o._keypress.bind(o));l(a,"keydown",o._keydown.bind(o));l(a,"input",o._input.bind(o));l(a,"blur",(function(){o.text!=o._oldText&&o._setText(o.text)}));l(a,"paste",(function(){o._fromKb=!1}));l(a,"compositionstart",(function(){o._composing=!0}));l(a,"compositionend",(function(){o._composing=!1;setTimeout((function(){var e=o.text,t=o._oldText,i=o._chrPct;t&&t.indexOf(i)>-1&&e.indexOf(i)<0&&(e+=i);o._setText(e)}))}));var h=o._clickSpinner.bind(o);l(o._btnUp,"click",h);l(o._btnDn,"click",h);o._rptUp=new wijmo_1._ClickRepeater(o._btnUp.querySelector("button"));o._rptDn=new wijmo_1._ClickRepeater(o._btnDn.querySelector("button"));l(a,"wheel",(function(e){if(o.handleWheel&&!e.defaultPrevented&&!e.ctrlKey&&o._isEditable()&&o.containsFocus()){var t=wijmo_1.clamp(-e.deltaY,-1,1);o._increment((o.step||1)*t);setTimeout((function(){return o.selectAll()}));e.preventDefault()}}));o.value=0;o.isRequired=!0;o.initialize(i);return o}Object.defineProperty(InputNumber.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"value",{get:function(){return this._value},set:function(e){if(e!=this._value)if(null==(e=wijmo_1.asNumber(e,!this.isRequired||null==e&&null==this._value)))this._setText("");else if(!isNaN(e)){var t=wijmo_1.Globalize.format(e,this.format);this._setText(t)}},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(e){this._tbx.required=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(e){this._readOnly=wijmo_1.asBoolean(e);this.inputElement.readOnly=this._readOnly;wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"handleWheel",{get:function(){return this._handleWheel},set:function(e){this._handleWheel=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"min",{get:function(){return this._min},set:function(e){if(e!=this._min){this._min=wijmo_1.asNumber(e,!0);this._updateAria()}},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"max",{get:function(){return this._max},set:function(e){if(e!=this._max){this._max=wijmo_1.asNumber(e,!0);this._updateAria()}},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"step",{get:function(){return this._step},set:function(e){this._step=wijmo_1.asNumber(e,!0);this._updateBtn()},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"format",{get:function(){return this._format},set:function(e){if(e!=this.format){this._format=wijmo_1.asString(e);this.refresh()}},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"text",{get:function(){return this._tbx.value},set:function(e){if(e!=this.text){this._oldText=null;this._setText(e)}},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(e){this._tbx.placeholder=e},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"showSpinner",{get:function(){return this._showBtn},set:function(e){this._showBtn=wijmo_1.asBoolean(e);this._updateBtn()},enumerable:!0,configurable:!0});Object.defineProperty(InputNumber.prototype,"repeatButtons",{get:function(){return!this._rptUp.disabled},set:function(e){this._rptUp.disabled=this._rptDn.disabled=!wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});InputNumber.prototype.selectAll=function(){var e=this._tbx;wijmo_1.setSelectionRange(e,0,e.value.length)};InputNumber.prototype.clamp=function(e){return wijmo_1.clamp(e,this.min,this.max)};InputNumber.prototype.onTextChanged=function(e){this.textChanged.raise(this,e);this._updateState()};InputNumber.prototype.onValueChanged=function(e){this._updateAria();this.valueChanged.raise(this,e)};InputNumber.prototype.dispose=function(){this._rptUp.element=null;this._rptDn.element=null;e.prototype.dispose.call(this)};InputNumber.prototype.onGotFocus=function(t){this._oldValue=this.value;if(!this.isTouching){this._tbx.focus();this.selectAll()}e.prototype.onGotFocus.call(this,t)};InputNumber.prototype.onLostFocus=function(t){if(this._composing){this._composing=!1;this._setText(this.text)}if(this._isEditable()){var i=this.clamp(this.value);if(i==this.value||this.onInvalidInput(new wijmo_1.CancelEventArgs)){var o=wijmo_1.Globalize.format(i,this.format);this._setText(o)}}e.prototype.onLostFocus.call(this,t)};InputNumber.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);if(this.hostElement){this._updateSymbols();var i=wijmo_1.Globalize.format(this.value,this.format);this._setText(i)}};InputNumber.prototype._isEditable=function(){return!this.isReadOnly&&!this.isDisabled};InputNumber.prototype._updateSymbols=function(){var e=wijmo_1.culture.Globalize.numberFormat,t=wijmo_1.Globalize._parseNumericFormat(this.format);this._chrDec=e["."]||".";this._chrTho=e[","]||",";this._chrNeg=e["-"]||"-";this._chrPls=e["+"]||"+";this._chrPct=e["%"]||"%";this._chrCur=t.curr||e.currency.symbol||"$";this._fmtSpc=t.spec;this._fmtPrc=t.prec;this._rxSym=new RegExp("^[%+\\-() \\"+this._chrDec+"\\"+this._chrCur+"\\"+this._chrNeg+"\\"+this._chrPls+"\\"+this._chrPct+"]*$");this._rxNeg=new RegExp("^\\s*(\\-|\\"+this._chrNeg+")|([^e](\\-|\\"+this._chrNeg+")|\\()")};InputNumber.prototype._isNumeric=function(e,t){var i=e==this._chrDec||e>="0"&&e<="9",o="x"==this._fmtSpc;!i&&o&&(i=e>="a"&&e<="f"||e>="A"&&e<="F");i||t||o||(i=e==this._chrPls||e==this._chrNeg||"("==e||")"==e);return i};InputNumber.prototype._getInputRange=function(e){for(var t=[0,0],i=this.text,o=!1,n=0;n<i.length;n++)if(this._isNumeric(i[n],e)){if(!o){t[0]=n;o=!0}t[1]=n+1}return t};InputNumber.prototype._flipSign=function(){var e=this._getSelStartDigits();this.value*=-1;this._setSelStartDigits(e)};InputNumber.prototype._getSelStartDigits=function(){for(var e=0,t=this._tbx.selectionStart,i=this._tbx.value,o=0;o<i.length&&o<t;o++)this._isNumeric(i[o],!0)&&e++;return e};InputNumber.prototype._setSelStartDigits=function(e){for(var t=this._tbx.value,i=0;i<t.length&&e>=0;i++)if(this._isNumeric(t[i],!0)){if(!e){wijmo_1.setSelectionRange(this._tbx,i);break}e--}else if(!e){wijmo_1.setSelectionRange(this._tbx,i);break}};InputNumber.prototype._increment=function(e){if(e){var t=this.clamp(wijmo_1.isNumber(this.value)?this.value+e:0),i=wijmo_1.Globalize.format(t,this.format,!1,!1);this._setText(i)}};InputNumber.prototype._updateBtn=function(){var e=this.showSpinner&&!!this.step,t=e;wijmo_1.setCss([this._btnUp,this._btnDn],{display:e?"":"none"});wijmo_1.toggleClass(this.hostElement,"wj-input-show-spinner",e);wijmo_1.enable(this._btnUp,t);wijmo_1.enable(this._btnDn,t);this._updateAria()};InputNumber.prototype._setText=function(e,t){void 0===t&&(t=!1);if(!this._composing){var i=this._tbx,o=this._chrDec,n=this._rxNeg.test(e),s=this._delKey,r=this.containsFocus();e&&this._rxSym.test(e)&&r&&(e=this.isRequired||!s?(n?"-0":"0")+(e.indexOf(o)>-1?o:""):"");this._delKey=!1;s&&0==this.value&&!this.isRequired&&(e="");if(!e){if(!this.isRequired){i.value="";if(null!=this._value){this._value=null;this.onValueChanged()}if(this._oldText){this._oldText=e;this.onTextChanged()}this._updateBtn();return}e="0"}var a=e.indexOf(o),l=this._format||(a>-1?"n2":"n0"),h=wijmo_1.Globalize.parseFloat(e,l);isFinite(h)||(h=this.clamp(h));if(isNaN(h))this.onInvalidInput(new wijmo_1.CancelEventArgs)?i.value=this._oldText:this.focus();else{var u=r&&a>-1?2:null,c=wijmo_1.Globalize.format(h,l,!1,t,u);n&&h>=0&&!s&&(c=this._chrNeg+c);r&&a>-1&&"g"==this._fmtSpc&&0!=this._fmtPrc&&(c=e).indexOf(o)<0&&(c+=o);if(i.value!=c){i.value=c;h=wijmo_1.Globalize.parseFloat(c,l)}if(h!=this._value){this._value=h;this.onValueChanged()}if(this.text!=this._oldText){this._oldText=this.text;this.onTextChanged()}this._updateBtn();this._updateState()}}};InputNumber.prototype._keypress=function(e){if(!e.defaultPrevented&&!this._composing&&this._isEditable()&&e.charCode&&!e.ctrlKey&&!e.metaKey&&e.keyCode!=wijmo_1.Key.Enter){var t=this._tbx,i=String.fromCharCode(e.charCode);if(this._isNumeric(i,!1)){var o=t.maxLength;if(o>-1&&t.value.length>=o&&t.selectionEnd==t.selectionStart){e.preventDefault();return}var n=this._getInputRange(!0),s=t.selectionStart,r=t.selectionEnd;if(s<n[0]&&r<t.value.length){r=Math.max(r,n[0]);wijmo_1.setSelectionRange(t,n[0],r)}if(s>=n[1]){var a=null!=this._fmtPrc?this._fmtPrc:2,l=t.value.indexOf(this._chrDec);l>-1&&s-l>a&&e.preventDefault()}}else e.preventDefault();switch(i){case"-":case this._chrNeg:if(this.clamp(-1)>=0)this.value<0&&this._flipSign();else if(this.value&&t.selectionStart==t.selectionEnd)this._flipSign();else if(this.clamp(-1)<0){t.value=this._chrNeg;wijmo_1.setSelectionRange(t,1)}e.preventDefault();break;case"+":case this._chrPls:this.value<0&&this._flipSign();e.preventDefault();break;case".":case this._chrDec:if(0==this._fmtPrc)e.preventDefault();else{var h=t.value.indexOf(this._chrDec);if(h>-1){t.selectionStart<=h&&h++;wijmo_1.setSelectionRange(t,h);e.preventDefault()}}}if(!e.defaultPrevented&&wijmo_1.isIE()){var u=t.value;if((s=t.selectionStart)==(r=t.selectionEnd)){t.value=u.substr(0,s)+i+u.substr(r);wijmo_1.setSelectionRange(t,s+1);e.preventDefault();this._input()}}}};InputNumber.prototype._keydown=function(e){var t=this;this._delKey=!1;if(!e.defaultPrevented&&!this._composing&&!wijmo_1.hasClass(this._tbx,"wj-grid-ime")){var i=this._tbx,o=i.value,n=i.selectionStart,s=i.selectionEnd;switch(e.keyCode){case 65:if(e.ctrlKey){setTimeout((function(){t.selectAll()}));e.preventDefault()}break;case wijmo_1.Key.Up:case wijmo_1.Key.Down:if(this.step&&this._isEditable()){this._increment(this.step*(e.keyCode==wijmo_1.Key.Up?1:-1));setTimeout((function(){t.selectAll()}));e.preventDefault()}break;case wijmo_1.Key.Back:this._delKey=!0;if(s-n<2&&this._isEditable()){var r=o[s-1];if(r==this._chrDec||r==this._chrPct||r==this._chrTho||")"==r){setTimeout((function(){s=r==t._chrPct?t._getInputRange(!0)[1]:s-1;wijmo_1.setSelectionRange(i,s)}));e.preventDefault()}}break;case wijmo_1.Key.Delete:this._delKey=!0;if(s-n<2&&this._isEditable())if("0"==o&&1==n)wijmo_1.setSelectionRange(i,0);else{var a=o[n];if(a==this._chrDec||a==this._chrPct){setTimeout((function(){wijmo_1.setSelectionRange(i,n+1)}));e.preventDefault()}}break;case wijmo_1.Key.Escape:this.value=this._oldValue;this.selectAll()}}};InputNumber.prototype._input=function(){var e=this;this._composing?this._fromKb=!0:setTimeout((function(){var t=e._tbx,i=t.value,o=i.indexOf(e._chrDec),n=t.selectionStart,s=e._getSelStartDigits();"p"==e._fmtSpc&&i.length&&i.indexOf(e._chrPct)<0&&(i+=e._chrPct);e._setText(i,e._fromKb);e._fromKb=!0;if(e.containsFocus()){var r=t.value,a=r.indexOf(e._chrDec),l=e._getInputRange(!0);if(i==e._chrNeg+e._chrDec&&a>-1){wijmo_1.setSelectionRange(t,a+1);return}if(i[0]==e._chrNeg&&r[0]!=e._chrNeg){1==r.length?wijmo_1.setSelectionRange(t,1):e._setSelStartDigits(s);return}i?i==e._chrDec&&a>-1?n=a+1:n<=o&&a>-1||o<0&&a<0?n+=r.length-i.length:o<0&&a>-1&&(n=a):n=a>-1?a:l[1];n=wijmo_1.clamp(n,l[0],l[1]);wijmo_1.setSelectionRange(t,n)}}))};InputNumber.prototype._clickSpinner=function(e){var t=this;if(!e.defaultPrevented&&this._isEditable()&&this.step){this._increment(this.step*(wijmo_1.contains(this._btnUp,e.target)?1:-1));this.isTouching||setTimeout((function(){return t.selectAll()}))}};InputNumber.prototype._updateAria=function(){var e=this.hostElement;if(e){wijmo_1.setAttribute(e,"aria-valuemin",this.min);wijmo_1.setAttribute(e,"aria-valuemax",this.max);wijmo_1.setAttribute(e,"aria-valuenow",this.value);wijmo_1.enable(this._btnDn,null==this.min||this.value>this.min);wijmo_1.enable(this._btnUp,null==this.max||this.value<this.max)}};InputNumber.controlTemplate='<div class="wj-template"><div class="wj-input"><div class="wj-input-group"><span wj-part="btn-dec" class="wj-input-group-btn" tabindex="-1"><button class="wj-btn wj-btn-default" tabindex="-1">-</button></span><input type="tel" wj-part="input" class="wj-form-control wj-numeric"/><span wj-part="btn-inc" class="wj-input-group-btn" tabindex="-1"><button class="wj-btn wj-btn-default" tabindex="-1">+</button></span></div></div></div>';return InputNumber}(wijmo_1.Control);exports.InputNumber=InputNumber;var InputMask=function(e){__extends(InputMask,e);function InputMask(t,i){var o=e.call(this,t)||this;o.valueChanged=new wijmo_1.Event;var n=o.getTemplate();o.applyTemplate("wj-control wj-content wj-inputmask",n,{_tbx:"input"},"input");if("INPUT"==o._orgTag){var s=o._tbx.getAttribute("value");s&&(o.value=s)}o._msk=new wijmo_1._MaskProvider(o._tbx);o.isRequired=!0;o.initialize(i);o.addEventListener(o._tbx,"input",(function(){o.onValueChanged()}));o.addEventListener(o._tbx,"blur",o._commitText.bind(o));o.addEventListener(o._tbx,"keydown",(function(e){e.keyCode==wijmo_1.Key.Enter&&o._commitText()}));return o}Object.defineProperty(InputMask.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0});Object.defineProperty(InputMask.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputMask.prototype,"value",{get:function(){return this._tbx.value},set:function(e){if(e!=this.value){this._tbx.value=wijmo_1.asString(e);e=this._msk._applyMask();this._tbx.value=e;this.onValueChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(InputMask.prototype,"rawValue",{get:function(){return this._msk.getRawValue()},set:function(e){e!=this.rawValue&&(this.value=wijmo_1.asString(e))},enumerable:!0,configurable:!0});Object.defineProperty(InputMask.prototype,"mask",{get:function(){return this._msk.mask||""},set:function(e){var t=this.value;this._msk.mask=wijmo_1.asString(e);this.value!=t&&this.onValueChanged()},enumerable:!0,configurable:!0});Object.defineProperty(InputMask.prototype,"promptChar",{get:function(){return this._msk.promptChar},set:function(e){var t=this.value;this._msk.promptChar=e;this.value!=t&&this.onValueChanged()},enumerable:!0,configurable:!0});Object.defineProperty(InputMask.prototype,"overwriteMode",{get:function(){return this._msk.overwriteMode},set:function(e){this._msk.overwriteMode=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputMask.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(e){this._tbx.placeholder=e},enumerable:!0,configurable:!0});Object.defineProperty(InputMask.prototype,"maskFull",{get:function(){return this._msk.maskFull},enumerable:!0,configurable:!0});Object.defineProperty(InputMask.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(e){this._tbx.required=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputMask.prototype,"isReadOnly",{get:function(){return this._tbx.readOnly},set:function(e){this._tbx.readOnly=wijmo_1.asBoolean(e);wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0});InputMask.prototype.selectAll=function(){var e=this._msk.getMaskRange();wijmo_1.setSelectionRange(this._tbx,e[0],e[1]+1)};InputMask.prototype.onValueChanged=function(e){if(this.value!=this._oldValue){this._oldValue=this.value;this.valueChanged.raise(this,e)}this._updateState()};InputMask.prototype._commitText=function(){(this.rawValue||this.isRequired)&&(this.maskFull||this.onInvalidInput(new wijmo_1.CancelEventArgs));this._updateState()};InputMask.prototype.dispose=function(){this._msk.input=null;e.prototype.dispose.call(this)};InputMask.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);this.hostElement&&this._msk.refresh()};InputMask.prototype.onGotFocus=function(t){e.prototype.onGotFocus.call(this,t);this.selectAll()};InputMask.controlTemplate='<div class="wj-input"><div class="wj-input-group"><input wj-part="input" class="wj-form-control"/></div></div>';return InputMask}(wijmo_1.Control);exports.InputMask=InputMask;var ColorPicker=function(e){__extends(ColorPicker,e);function ColorPicker(t,i){var o=e.call(this,t)||this;o._hsb=[.5,1,1];o._alpha=1;o.valueChanged=new wijmo_1.Event;var n=o.getTemplate();o.applyTemplate("wj-control wj-content wj-colorpicker",n,{_eSB:"div-sb",_eHue:"div-hue",_eAlpha:"div-alpha",_ePreview:"div-pv",_ePal:"div-pal",_eText:"div-text"});o._palette="#FFF,#000,#F00,#FFC000,#FFFF00,#92D050,#00B050,#00B0F0,#0070C0,#7030A0".split(",");o._updatePalette();o._eHue.style.backgroundImage="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAD4CAIAAACi6hsPAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAGvSURBVDhPXdBPaM9xHMfxz4pWaxcmtoOhpdXSVpiyHWxqmVpDjaU5rK34XfypjTJ/p+ZPay6jhsOsRrKwaJElf9IQq03WIkv4FeMwMq221tfje1ByeFzfvd7PEKWGEKWTQRZLySWfVRRTQjmVbKWGOhLsZT+HaeY0bbTTQSfdXOcWffTzmAFeMcwoYyT5ygS/mA5hNgphip98J8kHRnnNSwZ4yH1uc4OrdHGR87RximYO0cgedlLLdqqoYAPrWMtKVrCcJSxiPmnMJUQp/Bsyk2xyyKOAQooopYwKtlDNDur5G7SBJo7RQiv/B+2hl3s84CkvGGKEOOYnxolj/mYmhBmDJ5ngCx95xxsGecYj4pB3iENeoZMO2mmlhaMcpIE4ZII6aqhmM3HMMkooopB88sghm0wySCeVlCjMCVFIYx4LWUwOeRSwhmLWU84mqqihll3sppEmjnOSs5zjEl1c4yZ99POE5wwxwns+840fTDFLFKaZZIJxkozxlmEGGSC+GF++Sy89dHOZC8Rr4lVnOMERDrCPBPXEX22jko2UEn+/mnxyWUYWC0gnNUQh/AEc0HJs6cex0gAAAABJRU5ErkJggg==)";o._eHue.style.backgroundSize="contain";if(navigator.appVersion.indexOf("MSIE 9")>-1){o._eSB.children[0].style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#ffffffff,endColorstr=#00ffffff,GradientType=1)";o._eSB.children[1].style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00000000,endColorstr=#ff000000,GradientType=0)"}n=ColorPicker._tplCursor;o._cSB=wijmo_1.createElement(n);o._cHue=wijmo_1.createElement(n);o._cHue.style.width="100%";o._cAlpha=wijmo_1.createElement(n);o._cAlpha.style.height="100%";o._eSB.appendChild(o._cSB);o._eHue.appendChild(o._cHue);o._eAlpha.appendChild(o._cAlpha);var s=o.addEventListener.bind(o),r=o.removeEventListener.bind(o),a=document;s(o.hostElement,"mousedown",(function(e){s(a,"mousemove",mouseMove);s(a,"mouseup",mouseUp);o._mouseDown(e)}));s(o.hostElement,"touchstart",(function(e){s(a,"touchmove",mouseMove);s(a,"touchend",mouseUp);o._mouseDown(e)}));var mouseMove=function(e){o._mouseMove(e)},mouseUp=function(e){r(a,"mousemove",mouseMove);r(a,"mouseup",mouseUp);r(a,"touchmove",mouseMove);r(a,"touchend",mouseUp);o._mouseUp(e)};s(o.hostElement,"click",(function(e){var t=e.target;if(t&&"DIV"==t.tagName&&wijmo_1.contains(o._ePal,t)){var i=t.style.backgroundColor;i&&(o.value=new wijmo_1.Color(i).toString())}}));o.value="#ffffff";o.initialize(i);o._updatePanels();return o}Object.defineProperty(ColorPicker.prototype,"showAlphaChannel",{get:function(){return"none"!=this._eAlpha.parentElement.style.display},set:function(e){this._eAlpha.parentElement.style.display=wijmo_1.asBoolean(e)?"":"none"},enumerable:!0,configurable:!0});Object.defineProperty(ColorPicker.prototype,"showColorString",{get:function(){return"none"!=this._eText.style.display},set:function(e){this._eText.style.display=wijmo_1.asBoolean(e)?"":"none"},enumerable:!0,configurable:!0});Object.defineProperty(ColorPicker.prototype,"value",{get:function(){return this._value},set:function(e){if(e!=this.value){e=wijmo_1.asString(e);var t=wijmo_1.Color.fromString(e);if(t){this._value=e;this._eText.innerText=e;var i=t.getHsb();if(this._hsb[0]!=i[0]||this._hsb[1]!=i[1]||this._hsb[2]!=i[2]||this._alpha!=t.a){if(0==i[2]){i[0]=this._hsb[0];i[1]=this._hsb[1]}else 0==i[1]&&(i[0]=this._hsb[0]);this._hsb=i;this._alpha=t.a;this._updatePanels();this.onValueChanged()}}}},enumerable:!0,configurable:!0});Object.defineProperty(ColorPicker.prototype,"palette",{get:function(){return this._palette},set:function(e){if((e=(e=wijmo_1.asArray(e)).slice(0,10)).every((function(e){return null!=wijmo_1.Color.fromString(e)}))){this._palette=e;this._updatePalette()}},enumerable:!0,configurable:!0});ColorPicker.prototype.onValueChanged=function(e){this._updatePanels();this.valueChanged.raise(this,e)};ColorPicker.prototype._mouseDown=function(e){this._htDown=this._getTargetPanel(e);if(this._htDown){e.preventDefault();this.focus();this._mouseMove(e)}};ColorPicker.prototype._mouseMove=function(e){var t=e.touches?e.touches[0]:e,i=this._htDown;if(i){var o=i.getBoundingClientRect(),n=this._hsb;if(i==this._eHue)n[0]=wijmo_1.clamp((t.clientY-o.top)/o.height,0,.99);else if(i==this._eSB){n[1]=wijmo_1.clamp((t.clientX-o.left)/o.width,0,1);n[2]=wijmo_1.clamp(1-(t.clientY-o.top)/o.height,0,1)}else i==this._eAlpha&&(this._alpha=wijmo_1.clamp((t.clientX-o.left)/o.width,0,1));this._updateColor()}};ColorPicker.prototype._mouseUp=function(e){this._htDown=null};ColorPicker.prototype._updateColor=function(){var e=wijmo_1.Color.fromHsb(this._hsb[0],this._hsb[1],this._hsb[2],this._alpha);this.value=e.toString();this._updatePanels()};ColorPicker.prototype._updatePalette=function(){var e=new wijmo_1.Color("#fff"),t=new wijmo_1.Color("#000");this._ePal.innerHTML="";for(var i=0;i<this._palette.length;i++){var o=wijmo_1.createElement('<div style="float:left;width:10%;box-sizing:border-box;padding:1px">'),n=new wijmo_1.Color(this._palette[i]),s=n.getHsb();o.appendChild(this._makePalEntry(n,4));for(var r=0;r<5;r++){if(0==s[1]){var a=.1*r+(s[2]>.5?.05:.55);n=wijmo_1.Color.interpolate(e,t,a)}else n=wijmo_1.Color.fromHsb(s[0],.1+.2*r,1-.1*r);o.appendChild(this._makePalEntry(n,0))}this._ePal.appendChild(o)}};ColorPicker.prototype._makePalEntry=function(e,t){var i=document.createElement("div");wijmo_1.setCss(i,{cursor:"pointer",backgroundColor:e.toString(),marginBottom:t||""});i.innerHTML="&nbsp";return i};ColorPicker.prototype._updatePanels=function(){var e=wijmo_1.Color.fromHsb(this._hsb[0],1,1,1),t=wijmo_1.Color.fromHsb(this._hsb[0],this._hsb[1],this._hsb[2],1);this._eSB.style.backgroundColor=e.toString();this._eAlpha.style.background="linear-gradient(to right, transparent 0%, "+t.toString()+" 100%)";navigator.appVersion.indexOf("MSIE 9")>-1&&(this._eAlpha.style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#00000000,endColorstr="+t.toString()+", GradientType = 1)");this._ePreview.style.backgroundColor=this.value;this._cHue.style.top=(100*this._hsb[0]).toFixed(0)+"%";this._cSB.style.left=(100*this._hsb[1]).toFixed(0)+"%";this._cSB.style.top=(100-100*this._hsb[2]).toFixed(0)+"%";this._cAlpha.style.left=(100*this._alpha).toFixed(0)+"%"};ColorPicker.prototype._getTargetPanel=function(e){var t=e.target;return wijmo_1.contains(this._eSB,t)?this._eSB:wijmo_1.contains(this._eHue,t)?this._eHue:wijmo_1.contains(this._eAlpha,t)?this._eAlpha:null};ColorPicker.controlTemplate='<div style="position:relative;width:100%;height:100%"><div style="float:left;width:50%;height:100%;box-sizing:border-box;padding:2px"><div wj-part="div-pal"><div style="float:left;width:10%;box-sizing:border-box;padding:2px"><div style="background-color:black;width:100%">&nbsp;</div><div style="height:6px"></div></div></div><div wj-part="div-text" style="position:absolute;bottom:0px;display:none"></div></div><div style="float:left;width:50%;height:100%;box-sizing:border-box;padding:2px"><div wj-part="div-sb" class="wj-colorbox" style="float:left;width:89%;height:89%"><div style="position:absolute;width:100%;height:100%;background:linear-gradient(to right, white 0%,transparent 100%)"></div><div style="position:absolute;width:100%;height:100%;background:linear-gradient(to top, black 0%,transparent 100%)"></div></div><div style="float:left;width:1%;height:89%"></div><div style="float:left;width:10%;height:89%"><div wj-part="div-hue" class="wj-colorbox"></div></div><div style="float:left;width:89%;height:1%"></div><div style="float:left;width:89%;height:10%"><div style="width:100%;height:100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAAcSURBVBhXY/iPBBYgAWpKQGkwgMqDAdUk/v8HAM7Mm6GatDUYAAAAAElFTkSuQmCC)"><div wj-part="div-alpha" class="wj-colorbox"></div></div></div><div style="float:left;width:1%;height:10%"></div><div style="float:left;width:10%;height:10%"><div wj-part="div-pv" class="wj-colorbox" style="position:static"></div></div></div></div>';ColorPicker._tplCursor='<div style="position:absolute;left:50%;top:50%;width:7px;height:7px;transform:translate(-50%,-50%);border:2px solid #f0f0f0;border-radius:50px;box-shadow:0px 0px 4px 2px #0f0f0f"></div>';return ColorPicker}(wijmo_1.Control);exports.ColorPicker=ColorPicker;var CollectionViewNavigator=function(e){__extends(CollectionViewNavigator,e);function CollectionViewNavigator(t,i){var o=e.call(this,t)||this;o._view=null;o._byPage=!1;o._fmt="{current:n0} / {count:n0}";var n=o.getTemplate();o.applyTemplate("wj-control wj-content wj-pager wj-collectionview-navigator",n,{_btnFirst:"btn-first",_btnPrev:"btn-prev",_txtCurr:"txt-curr",_btnNext:"btn-next",_btnLast:"btn-last"},"input");o._rptNext=new wijmo_1._ClickRepeater(o._btnNext.querySelector("button"));o._rptPrev=new wijmo_1._ClickRepeater(o._btnPrev.querySelector("button"));o.addEventListener(o.hostElement,"click",o._click.bind(o));o.initialize(i);o._update();return o}Object.defineProperty(CollectionViewNavigator.prototype,"cv",{get:function(){return this._view},set:function(e){if(e!=this._view){var t=this._view;if(t){t.collectionChanged.removeHandler(this._collectionChanged);t.currentChanged.removeHandler(this._currentChanged)}t=this._view=wijmo_1.asType(e,"ICollectionView",!0);this._update();if(t){t.collectionChanged.addHandler(this._collectionChanged,this);t.currentChanged.addHandler(this._currentChanged,this)}}},enumerable:!0,configurable:!0});Object.defineProperty(CollectionViewNavigator.prototype,"byPage",{get:function(){return this._byPage},set:function(e){if(e!=this._byPage){this._byPage=wijmo_1.asBoolean(e);this._update()}},enumerable:!0,configurable:!0});Object.defineProperty(CollectionViewNavigator.prototype,"headerFormat",{get:function(){return this._fmt},set:function(e){if(e!=this._fmt){this._fmt=wijmo_1.asString(e);this._update()}},enumerable:!0,configurable:!0});Object.defineProperty(CollectionViewNavigator.prototype,"repeatButtons",{get:function(){return!this._rptNext.disabled},set:function(e){this._rptNext.disabled=this._rptPrev.disabled=!wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});CollectionViewNavigator.prototype._update=function(){var e=this._view,t=this._byPage,i=e?t?e.pageIndex:e.currentPosition:0,o=e?t?e.pageCount:e.itemCount:0;wijmo_1.enable(this._btnFirst,e&&i>0);wijmo_1.enable(this._btnPrev,e&&i>0);wijmo_1.enable(this._txtCurr,null!=e);wijmo_1.enable(this._btnNext,e&&i<o-1);wijmo_1.enable(this._btnLast,e&&i<o-1);this._txtCurr.value=wijmo_1.format(this._fmt,{current:e?i+1:0,count:e?o:0,currentItem:e?e.currentPosition+1:0,itemCount:e?e.itemCount:0,currentPage:e?e.pageIndex+1:0,pageCount:e?e.pageCount:0})};CollectionViewNavigator.prototype._currentChanged=function(){this._update()};CollectionViewNavigator.prototype._collectionChanged=function(){this._update()};CollectionViewNavigator.prototype._click=function(e){var t=e.target,i=this._view,o=this._byPage;if(i){wijmo_1.contains(this._btnFirst,t)?o?i.moveToFirstPage():i.moveCurrentToFirst():wijmo_1.contains(this._btnPrev,t)?o?i.moveToPreviousPage():i.moveCurrentToPrevious():wijmo_1.contains(this._btnNext,t)?o?i.moveToNextPage():i.moveCurrentToNext():wijmo_1.contains(this._btnLast,t)&&(o?i.moveToLastPage():i.moveCurrentToLast());e.preventDefault()}};CollectionViewNavigator.controlTemplate='<div class="wj-input-group"><span wj-part="btn-first" class="wj-input-group-btn"><button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-step-backward"></span></button></span><span wj-part="btn-prev" class="wj-input-group-btn"> <button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-left"></span> </button></span><input wj-part="txt-curr" class="wj-form-control" readonly><span wj-part="btn-next" class="wj-input-group-btn"><button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-right"></span></button></span><span wj-part="btn-last" class="wj-input-group-btn"><button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-step-forward"></span></button></span></div>';return CollectionViewNavigator}(wijmo_1.Control);exports.CollectionViewNavigator=CollectionViewNavigator;var ListBox=function(e){__extends(ListBox,e);function ListBox(t,i){var o=e.call(this,t,null,!0)||this;o._cv=null;o._itemFormatter=null;o._pathDisplay=new wijmo_1.Binding("");o._pathValue=new wijmo_1.Binding("");o._pathChecked=new wijmo_1.Binding("");o._html=!1;o._shGroups=!1;o._checkedItems=[];o._itemRole="option";o._caseSensitive=!1;o._vThreshold=ListBox._VTHRESH;o._isVirtual=!1;o._children=[];o._clientHeight=-1;o._itemHeight=30;o._itemsAbove=-1;o._itemsBelow=-1;o._eSizer=document.createElement("div");o._ePadTop=document.createElement("div");o._ePadBot=document.createElement("div");o._checking=!1;o._ignoredItemChangedEvents=!1;o._search="";o._fmtItemHandlers=0;o._itemCount=0;o._oldSel=null;o._container=null;o.selectedIndexChanged=new wijmo_1.Event;o.itemsChanged=new wijmo_1.Event;o.loadingItems=new wijmo_1.Event;o.loadedItems=new wijmo_1.Event;o.itemChecked=new wijmo_1.Event;o.checkedItemsChanged=new wijmo_1.Event;o.formatItem=new wijmo_1.Event((function(){o.invalidate()}));o.applyTemplate("wj-control wj-content wj-listbox",null,null);var n=o.hostElement;wijmo_1.setAttribute(n,"role","listbox",!0);"SELECT"==o._orgTag&&o._initFromSelect(o.hostElement);o.addEventListener(n,"click",o._click.bind(o));o.addEventListener(n,"keydown",o._keydown.bind(o));o.addEventListener(n,"keypress",o._keypress.bind(o));o.addEventListener(n,"wheel",(function(e){if(n.scrollHeight>n.offsetHeight&&(e.deltaY<0&&0==n.scrollTop||e.deltaY>0&&n.scrollTop+n.offsetHeight>=n.scrollHeight)){e.preventDefault();e.stopPropagation();e.stopImmediatePropagation()}}));[o._eSizer,o._ePadTop,o._ePadBot].forEach((function(e){e.tabIndex=-1;wijmo_1.setAttribute(e,"aria-hidden",!0);wijmo_1.setCss(e,{pointerEvents:"none",opacity:"0"})}));o.initialize(i);o._updateViewRange();o.hostElement.addEventListener("scroll",(function(e){o._updateViewRange()}));return o}Object.defineProperty(ListBox.prototype,"itemsSource",{get:function(){return this._items},set:function(e){if(this._items!=e){if(this._cv){this._cv.currentChanged.removeHandler(this._cvCurrentChanged,this);this._cv.collectionChanged.removeHandler(this._cvCollectionChanged,this);this._cv=null}this._items=e;this._cv=wijmo_1.asCollectionView(e);if(null!=this._cv){this._cv.currentChanged.addHandler(this._cvCurrentChanged,this);this._cv.collectionChanged.addHandler(this._cvCollectionChanged,this)}this._populateList();this.onItemsChanged();this.onSelectedIndexChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"virtualizationThreshold",{get:function(){return this._vThreshold},set:function(e){if(e!=this._vThreshold){var t=this._getVirtual();this._vThreshold=wijmo_1.asNumber(e,!1,!0);t!=this._getVirtual()&&this._populateList()}},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"showGroups",{get:function(){return this._shGroups},set:function(e){if(e!=this._shGroups){this._shGroups=wijmo_1.asBoolean(e);this._populateList()}},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"isContentHtml",{get:function(){return this._html},set:function(e){if(e!=this._html){this._html=wijmo_1.asBoolean(e);this._populateList()}},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(e){if(e!=this._itemFormatter){this._itemFormatter=wijmo_1.asFunction(e);this._populateList()}},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"displayMemberPath",{get:function(){return this._pathDisplay.path},set:function(e){if(e!=this.displayMemberPath){this._pathDisplay.path=wijmo_1.asString(e);this._populateList()}},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"selectedValuePath",{get:function(){return this._pathValue.path},set:function(e){this._pathValue.path=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"checkedMemberPath",{get:function(){return this._pathChecked.path},set:function(e){if(e!=this.checkedMemberPath){this._pathChecked.path=wijmo_1.asString(e);this._populateList()}},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"caseSensitiveSearch",{get:function(){return this._caseSensitive},set:function(e){this._caseSensitive=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"itemRole",{get:function(){return this._itemRole},set:function(e){if(e!=this.itemRole){this._itemRole=wijmo_1.asString(e);this._populateList()}},enumerable:!0,configurable:!0});ListBox.prototype.getDisplayValue=function(e){var t=null;if(e>-1&&wijmo_1.hasItems(this._cv)){t=this._cv.items[e];this.displayMemberPath&&(t=this._pathDisplay.getValue(t))}var i=null!=t?t.toString():"";this._itemFormatter&&(i=this._itemFormatter(e,i));return i};ListBox.prototype.getDisplayText=function(e){var t=this._getChild(e);return null!=t?t.textContent:""};ListBox.prototype.isItemEnabled=function(e){var t=this._getChild(e);return null!=t&&!t.hasAttribute("disabled")&&!wijmo_1.hasClass(t,"wj-state-disabled")&&!wijmo_1.hasClass(t,"wj-separator")};Object.defineProperty(ListBox.prototype,"selectedIndex",{get:function(){return this._cv?this._cv.currentPosition:-1},set:function(e){this._cv&&this._cv.moveCurrentToPosition(wijmo_1.asNumber(e))},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"selectedItem",{get:function(){return this._cv?this._cv.currentItem:null},set:function(e){this._cv&&this._cv.moveCurrentTo(e)},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"selectedValue",{get:function(){var e=this.selectedItem;e&&this.selectedValuePath&&(e=this._pathValue.getValue(e));return e},set:function(e){var t=this._cv,i=t?t.items:null,o=this.selectedValuePath,n=-1;if(i){for(var s=0;s<i.length;s++){var r=i[s],a=o?this._pathValue.getValue(r):r;if(a===e||wijmo_1.DateTime.equals(a,e)){n=s;break}if(this.isContentHtml&&wijmo_1.isString(a)&&a.indexOf("<")>-1&&wijmo_1.toPlainText(a)===e){n=s;break}}this.selectedIndex=n}},enumerable:!0,configurable:!0});Object.defineProperty(ListBox.prototype,"maxHeight",{get:function(){var e=this.hostElement,t=e?parseFloat(e.style.maxHeight):null;return isNaN(t)?null:t},set:function(e){var t=this.hostElement;if(t){e=wijmo_1.asNumber(e,!0);t.style.maxHeight=null==e?"":e+"px"}},enumerable:!0,configurable:!0});ListBox.prototype.showSelection=function(e){void 0===e&&(e=this.containsFocus());var t=this.hostElement,i=this._children,o=this._getSelectedElement(!1),n=new wijmo_1.Rect(0,0,0,0);if(o!=this._oldSel){this._updateItemAttributes(o,!0);this._updateItemAttributes(this._oldSel,!1);this._oldSel=o}o instanceof HTMLElement?n=this._getBoundingClientRect(o):this._children.length>0&&(n=this._getBoundingClientRect(this._getChild(0)));var s=this._getBoundingClientRect(t),r=0;if(this._shGroups){r=this._itemHeight;if(!this._isVirtual){var a=i[0];a.offsetHeight&&wijmo_1.hasClass(a,"wj-header")&&(r=a.offsetHeight)}}n.bottom>s.bottom?t.scrollTop+=n.bottom-s.bottom:n.top<s.top+r&&(t.scrollTop-=s.top+r-n.top);this._updateViewRange();o=this._getSelectedElement(!0);if(e){(o&&!wijmo_1.contains(o,wijmo_1.getActiveElement())?o:t).focus()}t.tabIndex=o?-1:this._orgTabIndex};ListBox.prototype.loadList=function(){this._populateList()};ListBox.prototype.getItemChecked=function(e){var t=this._cv.items[e],i=this._pathChecked;if(wijmo_1.isObject(t)&&i.path)return i.getValue(t);var o=this._getCheckbox(e);return!!o&&o.checked};ListBox.prototype.setItemChecked=function(e,t){this._setItemChecked(e,t,!0)};ListBox.prototype.toggleItemChecked=function(e){this.setItemChecked(e,!this.getItemChecked(e))};Object.defineProperty(ListBox.prototype,"checkedItems",{get:function(){return this._checkedItems},set:function(e){var t=wijmo_1.asArray(e,!1);if(!this._arrayEquals(t,this._checkedItems)){this._updateCheckedList(t);if(!this._arrayEquals(t,this._checkedItems)){this._checkedItems=t;this.onCheckedItemsChanged()}}},enumerable:!0,configurable:!0});ListBox.prototype.indexOf=function(e){return(e=wijmo_1.closest(e,".wj-listbox-item"))?e[ListBox._DIDX_KEY]:-1};ListBox.prototype.onSelectedIndexChanged=function(e){this.selectedIndexChanged.raise(this,e)};ListBox.prototype.onItemsChanged=function(e){this.itemsChanged.raise(this,e)};ListBox.prototype.onLoadingItems=function(e){this.loadingItems.raise(this,e)};ListBox.prototype.onLoadedItems=function(e){this.loadedItems.raise(this,e)};ListBox.prototype.onItemChecked=function(e){this.itemChecked.raise(this,e)};ListBox.prototype.onCheckedItemsChanged=function(e){this.checkedItemsChanged.raise(this,e)};ListBox.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)};ListBox.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);if(this.hostElement){var i=this._cv?this._cv.items.length:0,o=this.formatItem.handlerCount;if(i!=this._itemCount||o!=this._fmtItemHandlers){this._fmtItemHandlers=o;this._populateList()}else this._updateViewRange()}};ListBox.prototype._updateCheckedList=function(e){var t=this,i=this._cv,o=this._pathChecked,n=new Map;if(o&&i){var s=i.sourceCollection;if(s&&s.length){wijmo_1.isObject(s[0])||(o=null);e.forEach((function(e){return n.set(e,!0)}));this._checking=!0;var r=[];s.forEach((function(e){var t=n.has(e);t&&r.push(e);o&&o.setValue(e,t)}));this._checking=!1;e=r}i.items.forEach((function(e,i){t._setItemChecked(i,n.has(e),!1)}))}};ListBox.prototype._getBoundingClientRect=function(e){if(!e.offsetHeight){var t=this.indexOf(e),i=this.hostElement;if(t>-1&&i){t=this._getElementIndex(t);var o=i.getBoundingClientRect();return new wijmo_1.Rect(0,o.top-i.scrollTop+t*this._itemHeight,o.width,this._itemHeight)}}return wijmo_1.Rect.fromBoundingRect(e.getBoundingClientRect())};ListBox.prototype._updateItemAttributes=function(e,t){if(e){var i=this.checkedMemberPath?this._getCheckbox(this.indexOf(e)):null,o=i?i.checked:null;wijmo_1.toggleClass(e,"wj-state-selected",t);wijmo_1.setAttribute(e,"aria-selected",this._getAriaSelected(t,o));e.tabIndex=t?this._orgTabIndex:-1}};ListBox.prototype._getCheckedItems=function(){var e=this,t=this._cv,i=this._pathChecked,o=[];t&&i&&i.path&&(o=t.sourceCollection.filter((function(o,n){if(t.filter&&!t.filter(o))return!1;if(wijmo_1.isObject(o))return i.getValue(o);var s=t.items[n]==o?n:t.items.indexOf(o);return e.getItemChecked(s)})));return o};ListBox.prototype._arrayEquals=function(e,t){if(e==t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0};ListBox.prototype._getChild=function(e){e=this._getElementIndex(e);return this._children[e]};ListBox.prototype._getElementIndex=function(e){if(this._shGroups)for(var t=this._children,i=0;i<=e&&i<t.length;i++){var o=t[i];wijmo_1.hasClass(o,"wj-header")&&e++}return e};ListBox.prototype._setItemChecked=function(e,t,i){void 0===i&&(i=!0);var o=this._cv.items[e],n=this._pathChecked,s=!1,r=this.selectedIndex,a=this._checking;if(wijmo_1.isObject(o)&&n.path){if(!!n.getValue(o)!=t){var l=wijmo_1.tryCast(this._cv,"IEditableCollectionView");s=!0;this._checking=!0;if(l){l.editItem(o);n.setValue(o,t);l.commitEdit()}else{n.setValue(o,t);l.refresh()}this._checking=a}}else if(i){var h=this._checkedItems.indexOf(o);(t&&h<0||!t&&h>=0)&&(s=!0)}var u=this._getCheckbox(e);if(u){u.checked=t;var c=wijmo_1.closest(u,".wj-listbox-item");if(c){wijmo_1.toggleClass(c,"wj-state-checked",t);wijmo_1.setAttribute(c,"aria-selected",!!t||null)}}if(i){if(s){this._checkedItems=this._checkedItemsUpdate(o,t);this.onItemChecked();this.onCheckedItemsChanged()}r!=this.selectedIndex&&this.onSelectedIndexChanged()}return s};ListBox.prototype._checkedItemsUpdate=function(e,t){var i=this._cv.sourceCollection,o=this._checkedItems,n=0;if(t){for(var s=0;s<i.length;s++){var r=i[s];if(r===o[n]&&n<o.length)n++;else if(r===e)return o.slice(0,n).concat([e]).concat(o.slice(n))}return o}var a=o.indexOf(e);return o.slice(0,a).concat(o.slice(a+1))};ListBox.prototype._cvCollectionChanged=function(){if(!this._checking){this._populateList();this.onItemsChanged()}};ListBox.prototype._cvCurrentChanged=function(){if(!this._checking){this.showSelection();this._ignoredItemChangedEvents||this.onSelectedIndexChanged()}};ListBox.prototype._populateList=function(){var e=this.hostElement,t=this._cv;this._itemCount=t?t.items.length:0;this._isVirtual=this._getVirtual();this._oldSel=null;this._itemsAbove=-1;this._itemsBelow=-1;if(e){var i=this.containsFocus(),o=void 0;this.onLoadingItems();var n=this._children=[];e.textContent="";if(t){var s=0,r=void 0,a=[];if(this._shGroups&&t.groups&&t.groups.length){o={};for(var l=0;l<t.groups.length;l++){var h=t.groups[l];o[s]=h;r=this._createHeaderItem(h);a.push(r);for(var u=0;u<h.items.length;u++,s++){r=this._createItem(s);a.push(r)}}}else for(u=0;u<t.items.length;u++,s++){r=this._createItem(s);a.push(r)}var c=this._isVirtual?document.createElement("div"):e,p=0;c.innerHTML=a.join("");for(u=0;u<c.children.length;u++){var d=c.children[u];p==t.currentPosition&&(this._oldSel=d);d[ListBox._DIDX_KEY]=d.className.indexOf("wj-header")<0?p++:-1;n.push(d)}}if(this.formatItem.hasHandlers&&t){s=0;var _=t.items;for(d=new FormatItemEventArgs(0,null,null),u=0;u<n.length;u++){d._item=n[u];if(this._shGroups&&wijmo_1.hasClass(d._item,"wj-header")){d._index=-1;d._data=o[s]}else{d._index=s;d._data=_[s++]}this.onFormatItem(d)}}if(this._isVirtual){var m=this._getCanvasContext(),f=null,g=0;for(u=0;u<n.length;u++){r=n[u];var w=m.measureText(r.textContent);if(w.width>g){f=r;g=w.width}}if(f){var b=!1,v=e.style.display,y=e.style.position;if(!e.parentElement){b=!0;(this._container||document.body).appendChild(e);wijmo_1.setCss(e,{display:"",position:"absolute"})}e.appendChild(f);var j=f.style.whiteSpace;f.style.whiteSpace="nowrap";this._ePadTop.style.width=f.offsetWidth+"px";this._itemHeight=f.offsetHeight||this._itemHeight;f.style.whiteSpace=j;this._eSizer.style.height=n.length*this._itemHeight+"px";e.appendChild(this._eSizer);this._clientHeight=e.clientHeight;wijmo_1.removeChild(this._eSizer);if(b){wijmo_1.removeChild(e);wijmo_1.setCss(e,{display:v,position:y})}wijmo_1.removeChild(f)}else this._ePadTop.style.width="";this._updateViewRange()}this.checkedItems=this._getCheckedItems();var x=this._getSelectedElement(!0);if(i){(x||e).focus()}else x&&this.showSelection();e.tabIndex=x?-1:this._orgTabIndex;this.onLoadedItems()}};ListBox.prototype._getCanvasContext=function(){var e=document.createElement("canvas").getContext("2d"),t=getComputedStyle(this.hostElement);t.fontSize&&t.fontFamily&&(e.font=t.fontSize+" "+t.fontFamily.split(",")[0]);return e};ListBox.prototype._getVirtual=function(){if(this._itemCount<=this._vThreshold)return!1;var e=this.hostElement;if(e){var t=getComputedStyle(e);if(parseInt(t.columnCount)>1||t.display.indexOf("flex")>-1||t.display.indexOf("grid")>-1)return!1}return!0};ListBox.prototype._getMaxSupportedCssHeight=function(){var e=265e5;wijmo_1.isIE()?e=15e5:wijmo_1.isFirefox()&&(e=175e5);return e};ListBox.prototype._updateViewRange=function(){var e=this.hostElement,t=this._itemHeight,i=this._children;if(!(e&&e.parentElement&&this._isVirtual&&i))return!1;var o=e.scrollTop;wijmo_1.assert(t*i.length<this._getMaxSupportedCssHeight(),"The number of items ("+i.length+") exceeds the maximum number of items ("+Math.floor(this._getMaxSupportedCssHeight()/t)+") allowed for this browser.");var n=Math.max(e.clientHeight,this._clientHeight),s=Math.floor(o/t),r=Math.min(i.length,Math.ceil((o+n)/t)-s),a=Math.max(0,i.length-s-r);if(s==this._itemsAbove&&a==this._itemsBelow)return!1;this._itemsAbove=s;this._itemsBelow=a;var l=document.createDocumentFragment(),h=this.containsFocus();this._ePadTop.style.height=s*t+"px";l.appendChild(this._ePadTop);if(this.showGroups&&!wijmo_1.hasClass(i[s],"wj-header"))for(var u=s;u>=0;u--)if(wijmo_1.hasClass(i[u],"wj-header")){l.appendChild(i[u]);break}for(u=s;u<=s+r&&u<i.length;u++)l.appendChild(i[u]);this._ePadBot.style.height=a*t+"px";l.appendChild(this._ePadBot);e.textContent="";e.appendChild(l);var c=(s+r+a)*t-e.scrollHeight;this._ePadBot.style.height=this._ePadBot.offsetHeight-c+"px";var p=this._getSelectedElement(!0);if(h){(p||e).focus({preventScroll:!0})}e.tabIndex=p?-1:this._orgTabIndex;return!0};ListBox.prototype._getSelectedElement=function(e){var t=this.selectedIndex,i=this._getElementIndex(t),o=i>-1?this._children[i]:null;e&&o&&!o.offsetHeight&&(o=null);return o};ListBox.prototype._handleResize=function(){this._updateViewRange()};ListBox.prototype._createItem=function(e){var t=this._cv.items[e],i=e==this._cv.currentPosition,o=this.getDisplayValue(e);1!=this._html&&(o=wijmo_1.escapeHtml(o));var n=null;if(this.checkedMemberPath){n=!1;wijmo_1.isObject(t)?n=!!this._pathChecked.getValue(t):this._checkedItems&&(n=this._checkedItems.indexOf(t)>-1);o='<label><input type="checkbox" tabindex="-1"'+(n?" checked":"")+"><span></span> "+o+"</label>"}var s="wj-listbox-item";i&&(s+=" wj-state-selected");n&&(s+=" wj-state-checked");if(this._html){var r=["wj-separator","wj-state-disabled"];if(o.indexOf(r[0])>-1||o.indexOf(r[1])>-1){var a=wijmo_1.createElement(o);r.forEach((function(e){wijmo_1.hasClass(a,e)&&(s+=" "+e)}))}}return'<div class="'+s+'" role="'+this.itemRole+'" '+(this._getAriaSelected(i,n)?'aria-selected="true" ':"")+'tabindex="'+(i&&!this.isDisabled?this._orgTabIndex:-1)+'">'+o+"</div>"};ListBox.prototype._getAriaSelected=function(e,t){return!!(null!=t?t:e)||null};ListBox.prototype._createHeaderItem=function(e){return'<div class="wj-listbox-item wj-header wj-state-disabled" role="presentation" tabindex="-1">'+wijmo_1.escapeHtml(e.name)+"</div>"};ListBox.prototype._click=function(e){if(0==e.button&&!e.defaultPrevented){var t=this.indexOf(e.target);if(t>-1){this.selectedIndex=t;if(this.checkedMemberPath){var i=this._getCheckbox(t),o=wijmo_1.closest(i,".wj-listbox-item");if(e.target==i||e.target==o){o.focus({preventScroll:!0});this.setItemChecked(t,i.checked)}}else{(o=wijmo_1.closest(e.target,".wj-listbox-item")).focus({preventScroll:!0})}}}};ListBox.prototype._keydown=function(e){var t=this.selectedIndex;if(!e.defaultPrevented){if(65==e.keyCode&&(e.ctrlKey||e.metaKey)){var i=this.collectionView;if(this.checkedMemberPath&&wijmo_1.hasItems(i)){this.checkedItems=this.checkedItems.length!=i.items.length?i.items:[];e.preventDefault();return}}if(!(e.ctrlKey||e.shiftKey||e.altKey||e.metaKey))switch(e.keyCode){case wijmo_1.Key.Down:e.preventDefault();this._selectNext();break;case wijmo_1.Key.Up:e.preventDefault();this._selectPrev();break;case wijmo_1.Key.Home:e.preventDefault();this._selectFirst();break;case wijmo_1.Key.End:e.preventDefault();this._selectLast();break;case wijmo_1.Key.PageDown:e.preventDefault();this._selectNextPage();break;case wijmo_1.Key.PageUp:e.preventDefault();this._selectPrevPage();break;case wijmo_1.Key.Space:if(this.checkedMemberPath&&t>-1){var o=this._getCheckbox(t);if(o&&this.isItemEnabled(t)){this.setItemChecked(t,!o.checked);e.preventDefault()}}}}};ListBox.prototype._keypress=function(e){var t=this;if(!e.defaultPrevented&&!(e.target instanceof HTMLInputElement)&&(e.charCode>32||32==e.charCode&&this._search)){e.preventDefault();this._search+=String.fromCharCode(e.charCode);this._toSearch&&clearTimeout(this._toSearch);this._toSearch=setTimeout((function(){t._toSearch=null;t._search=""}),wijmo_1.Control._SEARCH_DELAY);var i=this._findNext();if(i<0&&this._search.length>1){this._search=this._search[this._search.length-1];i=this._findNext()}i>-1&&(this.selectedIndex=i)}};ListBox.prototype._selectNext=function(){for(var e=this.selectedIndex+1;e<this._children.length;e++)if(this.isItemEnabled(e)){this.selectedIndex=e;return!0}return!1};ListBox.prototype._selectPrev=function(){for(var e=this.selectedIndex-1;e>=0;e--)if(this.isItemEnabled(e)){this.selectedIndex=e;return!0}return!1};ListBox.prototype._selectFirst=function(){for(var e=0;e<this._children.length;e++)if(this.isItemEnabled(e)){this.selectedIndex=e;return!0}return!1};ListBox.prototype._selectLast=function(){for(var e=this._children.length-1;e>=0;e--)if(this.isItemEnabled(e)){this.selectedIndex=e;return!0}return!1};ListBox.prototype._selectNextPage=function(){var e=this.hostElement.offsetHeight,t=this._children,i=this._cv?this._cv.items.length:0,o=0;if(e>0)for(var n=this.selectedIndex+1;n<i;n++){var s=t[n].scrollHeight||this._itemHeight;if(o+s>e&&this.isItemEnabled(n)){this.selectedIndex=n;return!0}o+=s}return this._selectLast()};ListBox.prototype._selectPrevPage=function(){var e=this.hostElement.offsetHeight,t=this._children,i=0;if(e>0)for(var o=this.selectedIndex-1;o>0;o--){var n=t[o].scrollHeight||this._itemHeight;if(i+n>e&&this.isItemEnabled(o)){this.selectedIndex=o;return!0}i+=n}return this._selectFirst()};ListBox.prototype._findNext=function(){if(this.hostElement){var e=this._children.length,t=this.selectedIndex;(t<0||1==this._search.length)&&t++;var i=this._search,o=this.caseSensitiveSearch;o||(i=i.toLowerCase());for(var n=0;n<e;n++){var s=(t+n)%e;if(this.isItemEnabled(s)){var r=this.getDisplayText(s).trim();o||(r=r.toLowerCase());if(0==r.indexOf(i))return s}}}return-1};ListBox.prototype._getCheckbox=function(e){var t=this._children;e=this._getElementIndex(e);return this.hostElement&&e>-1&&e<t.length?t[e].querySelector("input[type=checkbox]"):null};ListBox.prototype._initFromSelect=function(e){for(var t=e.children,i=[],o=-1,n=0;n<t.length;n++){var s=t[n];if("OPTION"==s.tagName){s.hasAttribute("selected")&&(o=i.length);s.innerHTML?i.push({hdr:s.innerHTML,val:s.getAttribute("value"),cmdParam:s.getAttribute("cmd-param")}):i.push({hdr:'<div class="wj-separator"></div>'});e.removeChild(s);n--}}if(i){this.displayMemberPath="hdr";this.selectedValuePath="val";this.itemsSource=i;this.selectedIndex=o}};ListBox.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t);this._updateTabIndex()};ListBox.prototype._setTabOrder=function(t){e.prototype._setTabOrder.call(this,t);this.isDisabled||this._updateTabIndex()};ListBox.prototype._updateTabIndex=function(){var e=this.hostElement,t=this._getSelectedElement(!0);if(t){t.tabIndex=this.isDisabled?-1:this._orgTabIndex;e.tabIndex=-1}else e.tabIndex=this.isDisabled?-1:this._orgTabIndex};ListBox._DIDX_KEY="$WJ-DIDX";ListBox._VTHRESH=Number.MAX_VALUE/2;return ListBox}(wijmo_1.Control);exports.ListBox=ListBox;var FormatItemEventArgs=function(e){__extends(FormatItemEventArgs,e);function FormatItemEventArgs(t,i,o){var n=e.call(this)||this;n._index=wijmo_1.asNumber(t);n._data=i;n._item=wijmo_1.asType(o,HTMLElement,!0);return n}Object.defineProperty(FormatItemEventArgs.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0});Object.defineProperty(FormatItemEventArgs.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});Object.defineProperty(FormatItemEventArgs.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0});return FormatItemEventArgs}(wijmo_1.EventArgs);exports.FormatItemEventArgs=FormatItemEventArgs;wijmo_1._addCultureInfo("MultiSelectListBox",{filterPlaceholder:"Filter",selectAll:"Select All"});var DateSelectionMode,ShowMonthPicker,MultiSelectListBox=function(e){__extends(MultiSelectListBox,e);function MultiSelectListBox(t,i){var o=e.call(this,t)||this;o._selectAllLabel=null;o._filterPlaceholder=null;o._filterText="";o._checkOnFilter=!0;o._delay=wijmo_1.Control._SEARCH_DELAY;o.checkedItemsChanged=new wijmo_1.Event;o.selectedIndexChanged=new wijmo_1.Event;var n=o.getTemplate();o.applyTemplate("wj-control wj-content wj-multiselectlistbox",n,{_selectAll:"select-all",_filter:"filter",_lbHost:"list-box"});o._selectAll.style.display="none";o._filter.style.display="none";o._lbx=new ListBox(o._lbHost,{checkedMemberPath:MultiSelectListBox._DEF_CHECKED_PATH,loadedItems:function(){return o._updateCheckAllCheckbox()},checkedItemsChanged:function(e){return o.onCheckedItemsChanged(e)},selectedIndexChanged:function(){return o.onSelectedIndexChanged()}});o._cbSelectAll=o._selectAll.querySelector("input[type=checkbox]");o._spSelectAll=o._selectAll.querySelector("label>span");var s=wijmo_1.culture.MultiSelectListBox;wijmo_1.setText(o._spSelectAll,s.selectAll);o._filter.placeholder=s.filterPlaceholder;o.initialize(i);o.addEventListener(o._filter,"input",(function(){if(o._filter.value!=o._filterText){o._filterText=o._filter.value;o._toSearch&&clearTimeout(o._toSearch);o._toSearch=setTimeout((function(){o._toSearch=null;o._applyFilter()}),o.delay)}}));o.addEventListener(o._cbSelectAll,"click",(function(e){var t=o._lbx.collectionView;wijmo_1.hasItems(t)&&(o.checkedItems=e.target.checked?t.items:[])}));o.addEventListener(o.hostElement,"keydown",(function(e){var t=o.showFilterInput?o._filter:null,i=o._lbx;if(t&&e.keyCode==wijmo_1.Key.F3){wijmo_1.setSelectionRange(t,0,t.value.length);e.preventDefault()}if(wijmo_1.getActiveElement()==t){var n=!e.altKey;switch(e.keyCode){case wijmo_1.Key.Escape:case wijmo_1.Key.F4:n=!1}n&&e.stopPropagation()}if(!i.containsFocus())switch(e.keyCode){case wijmo_1.Key.Up:case wijmo_1.Key.Down:o._lbx.focus();var s=i.selectedIndex+(e.keyCode==wijmo_1.Key.Up?-1:1);i.selectedIndex=Math.max(0,s);e.preventDefault()}}),!0);o.hostElement.tabIndex=-1;o._lbx.tabOrder=o._orgTabIndex;return o}Object.defineProperty(MultiSelectListBox.prototype,"itemsSource",{get:function(){return this._lbx.itemsSource},set:function(e){this._lbx.itemsSource=e},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"collectionView",{get:function(){return this._lbx.collectionView},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"virtualizationThreshold",{get:function(){return this._lbx.virtualizationThreshold},set:function(e){this._lbx.virtualizationThreshold=e},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"displayMemberPath",{get:function(){return this._lbx.displayMemberPath},set:function(e){this._lbx.displayMemberPath=e},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"isContentHtml",{get:function(){return this._lbx.isContentHtml},set:function(e){this._lbx.isContentHtml=e},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"caseSensitiveSearch",{get:function(){return this._lbx.caseSensitiveSearch},set:function(e){this._lbx.caseSensitiveSearch=e},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"delay",{get:function(){return this._delay},set:function(e){this._delay=wijmo_1.asNumber(e,!1,!0)},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"showGroups",{get:function(){return this._lbx.showGroups},set:function(e){this._lbx.showGroups=e},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"checkOnFilter",{get:function(){return this._checkOnFilter},set:function(e){if(e!=this.checkOnFilter){this._checkOnFilter=wijmo_1.asBoolean(e);this.checkedItems=[]}},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"selectedIndex",{get:function(){return this._lbx.selectedIndex},set:function(e){this._lbx.selectedIndex=e},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"listBox",{get:function(){return this._lbx},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"showFilterInput",{get:function(){return""==this._filter.style.display},set:function(e){if(e!=this.showFilterInput){this._filter.style.display=wijmo_1.asBoolean(e)?"":"none";if(!this.showFilterInput){this._filter.value="";this._applyFilter()}}},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"filterInputPlaceholder",{get:function(){return this._filterPlaceholder},set:function(e){if(e!=this._filterPlaceholder){this._filterPlaceholder=wijmo_1.asString(e);this.refresh()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"showSelectAllCheckbox",{get:function(){return""==this._selectAll.style.display},set:function(e){this._selectAll.style.display=wijmo_1.asBoolean(e)?"":"none"},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"selectAllLabel",{get:function(){return this._selectAllLabel},set:function(e){if(e!=this._selectAllLabel){this._selectAllLabel=wijmo_1.asString(e);this.refresh()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"checkedMemberPath",{get:function(){var e=this.listBox.checkedMemberPath;return e!=MultiSelectListBox._DEF_CHECKED_PATH?e:null},set:function(e){e=wijmo_1.asString(e);this.listBox.checkedMemberPath=e||MultiSelectListBox._DEF_CHECKED_PATH},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelectListBox.prototype,"checkedItems",{get:function(){return this.listBox.checkedItems},set:function(e){this.listBox.checkedItems=wijmo_1.asArray(e)},enumerable:!0,configurable:!0});MultiSelectListBox.prototype.onCheckedItemsChanged=function(e){var t=this;this._updateCheckAllCheckbox();this.checkedItemsChanged.raise(this,e);"object"==typeof e._items[0]&&(this.checkedMemberPath||MultiSelectListBox._DEF_CHECKED_PATH)in e._items[0]&&setTimeout((function(){t._lbx._updateCheckedList(t.checkedItems)}),0)};MultiSelectListBox.prototype.onSelectedIndexChanged=function(e){this.selectedIndexChanged.raise(this,e)};MultiSelectListBox.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);if(this.hostElement){var i=wijmo_1.culture.MultiSelectListBox;this._filter.placeholder=null!=this._filterPlaceholder?this._filterPlaceholder:i.filterPlaceholder;this._spSelectAll&&wijmo_1.setText(this._spSelectAll,null!=this._selectAllLabel?this._selectAllLabel:i.selectAll);this._updateCheckAllCheckbox()}};MultiSelectListBox.prototype.dispose=function(){this.listBox.dispose();e.prototype.dispose.call(this)};MultiSelectListBox.prototype._applyFilter=function(){var e=this,t=this._lbx,i=t.collectionView,o=this._filter.value,n=o?new RegExp(wijmo_1.escapeRegExp(o),t.caseSensitiveSearch?"":"i"):null,s=this.displayMemberPath,r=s?new wijmo_1.Binding(s):null,a=this.checkOnFilter?null:this.checkedItems;i.filter=function(t){if(null!=n){if(a&&a.indexOf(t)>-1)return!0;r&&(t=r.getValue(t));e.isContentHtml&&(t=wijmo_1.toPlainText(t));return null!=t&&n.test(t.toString())}return!0};t.selectedIndex=Math.max(0,t.selectedIndex);this._checkOnFilter&&(this.checkedItems=n?i.items:[])};MultiSelectListBox.prototype._updateCheckAllCheckbox=function(){var e=this._lbx.collectionView,t=this._cbSelectAll;if(wijmo_1.hasItems(e)){var i=e.items.length,o=this.checkedItems.length;wijmo_1.setChecked(t,o==i||0!=o&&null);t.disabled=!1}else{wijmo_1.setChecked(t,!1);t.checked=!1;t.disabled=!0}};MultiSelectListBox.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t);this.hostElement.tabIndex=-1;this.isDisabled?this._lbx.tabOrder=-1:this._lbx.tabOrder=this._orgTabIndex};MultiSelectListBox.prototype._setTabOrder=function(e){this._orgTabIndex=e;this._lbx.tabOrder=e};MultiSelectListBox._DEF_CHECKED_PATH="$checked";MultiSelectListBox.controlTemplate='<div class="wj-template wj-listbox"><input wj-part="filter" class="wj-form-control" tabindex="-1"><div wj-part="select-all" class="wj-header wj-select-all wj-listbox-item"><label><input type="checkbox" tabindex="-1"> <span></span></label></div><div wj-part="list-box"/></div>';return MultiSelectListBox}(wijmo_1.Control);exports.MultiSelectListBox=MultiSelectListBox;wijmo_1._addCultureInfo("Calendar",{ariaLabels:{calendar:"Calendar",monthView:"Month View",yearView:"Year View",prvMo:"Previous Month",today:"Today",nxtMo:"Next Month",prvYr:"Previous Year",currMo:"Current Month",nxtYr:"Next Year"}});!function(e){e[e.None=0]="None";e[e.Day=1]="Day";e[e.Month=2]="Month";e[e.Range=3]="Range"}(DateSelectionMode=exports.DateSelectionMode||(exports.DateSelectionMode={}));!function(e){e[e.None=0]="None";e[e.FirstMonth=1]="FirstMonth";e[e.LastMonth=2]="LastMonth";e[e.FirstAndLastMonths=3]="FirstAndLastMonths";e[e.AllMonths=4]="AllMonths";e[e.Outside=5]="Outside"}(ShowMonthPicker=exports.ShowMonthPicker||(exports.ShowMonthPicker={}));var ClickAction,Calendar=function(e){__extends(Calendar,e);function Calendar(t,i){var o=e.call(this,t)||this;o._yrPicker=!0;o._mtPicker=ShowMonthPicker.FirstMonth;o._wksBefore=0;o._wksAfter=0;o._rngMin=0;o._rngMax=0;o._min=null;o._max=null;o._readOnly=!1;o._handleWheel=!0;o._fdw=null;o._selMode=DateSelectionMode.Day;o._tmYrHidden=0;o._fmtYrMo="y";o._fmtYr="yyyy";o._fmtDayHdr="ddd";o._fmtDay="d ";o._fmtMonths="MMM";o.valueChanged=new wijmo_1.Event;o.rangeEndChanged=new wijmo_1.Event;o.rangeChanged=new wijmo_1.Event;o.displayMonthChanged=new wijmo_1.Event;o.formatItem=new wijmo_1.Event((function(){o.invalidate()}));o._value=o._rngEnd=wijmo_1.DateTime.newDate();o._month=o._getMonth(o._value);o._cals=[o];o._createChildren();o._createYearPicker();var n=o.hostElement,s=o.addEventListener.bind(o);s(n,"keydown",o._keydown.bind(o));s(n,"click",o._click.bind(o));o._rptUp=new wijmo_1._ClickRepeater(o._btnPrv);o._rptDn=new wijmo_1._ClickRepeater(o._btnNxt);o.addEventListener(n,"wheel",(function(e){if(o.handleWheel&&!e.defaultPrevented&&!o.isReadOnly&&o.containsFocus()){e.deltaY<0?o._btnPrv.click():o._btnNxt.click();e.preventDefault()}}));o.initialize(i);o.refresh(!0);return o}Object.defineProperty(Calendar.prototype,"value",{get:function(){return this._value},set:function(e){if(e!==this._value){this._clearingRangeEnd=!wijmo_1.DateTime.equals(this._value,e);this.rangeEnd=null;this._clearingRangeEnd=!1;e=wijmo_1.asDate(e,!0);e=this._clamp(e);if(this._valid(e)||null==e){this.ensureVisible(e||new Date);if(!wijmo_1.DateTime.equals(this._value,e)){this._value=e;this.invalidate(!1);this.onValueChanged()}}if(!this.value){var t=this.min,i=this.max,o=this.displayMonth;i&&i<o?this.ensureVisible(i):t&&t>o&&this.ensureVisible(t)}}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"rangeEnd",{get:function(){return this._rngEnd},set:function(e){e=wijmo_1.asDate(e,!0);if((e=this._clamp(e))&&this._value&&this._rngMode()){e<this._value&&(e=this._value);var t=this._rngMin,i=this._rngMax;if(t&&t>0||i&&i>0){var o=this._value,n=Math.ceil((e.getTime()-o.getTime())/864e5)+1;t&&t>0&&n<t&&(e=wijmo_1.DateTime.addDays(o,t-1));i&&i>0&&n>i&&(e=wijmo_1.DateTime.addDays(o,i-1))}}if((this._valid(e)||null==e)&&!wijmo_1.DateTime.equals(this._rngEnd,e)){this._rngEnd=e;this.ensureVisible(e);this.invalidate(!1);this.onRangeEndChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"rangeMin",{get:function(){return this._rngMin},set:function(e){if((e=wijmo_1.asNumber(e,!0,!0))!=this._rngMin){this._rngMin=e;this._syncProp(this,"rangeMin");this._rngMode()&&this._rngEnd&&(this.rangeEnd=this._rngEnd)}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"rangeMax",{get:function(){return this._rngMax},set:function(e){if((e=wijmo_1.asNumber(e,!0,!0))!=this._rngMax){this._rngMax=e;this._syncProp(this,"rangeMax");this._rngMode()&&this._rngEnd&&(this.rangeEnd=this._rngEnd)}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"min",{get:function(){return this._min},set:function(e){if((e=wijmo_1.asDate(e,!0))!=this.min){this._min=e;this._syncProp(this,"min");this.refresh();!this.value&&e&&e>this.displayMonth&&this.ensureVisible(e)}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"max",{get:function(){return this._max},set:function(e){if((e=wijmo_1.asDate(e,!0))!=this.max){this._max=e;this._syncProp(this,"max");this.refresh();!this.value&&e&&e<this.displayMonth&&this.ensureVisible(e)}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"selectionMode",{get:function(){return this._selMode},set:function(e){var t=DateSelectionMode;if((e=wijmo_1.asEnum(e,t))!=this._selMode){this._selMode=e;this._mthMode()&&(this.monthView=!1);this._rngEnd=e==t.Range?this._value:null;this.refresh();this._syncProp(this,"selectionMode")}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(e){this._readOnly=wijmo_1.asBoolean(e);wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly);this._syncProp(this,"isReadOnly")},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"handleWheel",{get:function(){return this._handleWheel},set:function(e){this._handleWheel=wijmo_1.asBoolean(e);this._syncProp(this,"handleWheel")},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"repeatButtons",{get:function(){return!this._rptUp.disabled},set:function(e){this._rptUp.disabled=this._rptDn.disabled=!wijmo_1.asBoolean(e);this._syncProp(this,"repeatButtons")},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"showYearPicker",{get:function(){return this._yrPicker},set:function(e){if(e!=this._yrPicker){this._yrPicker=wijmo_1.asBoolean(e);this._syncProp(this,"showYearPicker")}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"showMonthPicker",{get:function(){return this._mtPicker},set:function(e){if(e!=this._mtPicker){var t=ShowMonthPicker;wijmo_1.isBoolean(e)&&(e=e?t.FirstMonth:t.None);this._mtPicker=wijmo_1.asEnum(e,t);wijmo_1.toggleClass(this.hostElement,"wj-btns-outside",this._getShowMonthPicker()==t.Outside);this.refresh();this._syncProp(this,"showMonthPicker")}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"firstDayOfWeek",{get:function(){return this._fdw},set:function(e){if(e!=this._fdw){if((e=wijmo_1.asNumber(e,!0))&&(e>6||e<0))throw"firstDayOfWeek must be between 0 and 6 (Sunday to Saturday).";this._fdw=e;this.refresh();this._syncProp(this,"firstDayOfWeek")}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"displayMonth",{get:function(){return this._month},set:function(e){e=wijmo_1.asDate(e);e=this._getMonth(e);var t=this._getDisplayMonthRange();t.to&&e>t.to&&(e=t.to);t.from&&e<t.from&&(e=t.from);if(!wijmo_1.DateTime.equals(this.displayMonth,e)){this._month=e;this.invalidate(!0);this.onDisplayMonthChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"monthCount",{get:function(){var e=this.hostElement;return e?e.querySelectorAll(".wj-calendar").length+1:0},set:function(e){var t=this,i=this.hostElement;if(e!=this.monthCount&&i){var o=i.querySelectorAll(".wj-calendar");e=wijmo_1.asInt(e,!1);wijmo_1.assert(e>0,"monthCount must be >= 1.");wijmo_1.assert(1==e||!wijmo_1.closest(i.parentElement,".wj-calendar"),"Only top-level calendars can set monthCount.");for(var n=0;n<o.length;n++){var s=o[n];wijmo_1.removeChild(s);this._getCalendar(s).dispose()}this._cals=[this];for(n=1;n<e;n++){(s=new Calendar(document.createElement("div"),{itemFormatter:this.itemFormatter,itemValidator:this.itemValidator,formatItem:function(e,i){return t.onFormatItem(i)}}))._selMode=this._selMode;s._value=this._value;s._rngEnd=this._rngEnd;for(var r in this)if(!/^(_.*|constructor|displayMonth|monthCount|hostElement|rightToLeft|isUpdating|isTouching)$/.test(r)){var a=this[r];wijmo_1.isFunction(a)||a instanceof wijmo_1.Event||(s[r]=a)}this._cals.push(s);i.appendChild(s.hostElement)}wijmo_1.toggleClass(i,"wj-calendar-multimonth",e>1);this._syncProp(this,"displayMonth")}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"formatYearMonth",{get:function(){return this._fmtYrMo},set:function(e){if(e!=this._fmtYrMo){this._fmtYrMo=wijmo_1.asString(e);this._syncProp(this,"formatYearMonth");this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"formatDayHeaders",{get:function(){return this._fmtDayHdr},set:function(e){if(e!=this._fmtDayHdr){this._fmtDayHdr=wijmo_1.asString(e);this._syncProp(this,"formatDayHeaders");this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"formatDays",{get:function(){return this._fmtDay},set:function(e){if(e!=this._fmtDay){this._fmtDay=wijmo_1.asString(e);this._syncProp(this,"formatDays");this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"formatYear",{get:function(){return this._fmtYr},set:function(e){if(e!=this._fmtYr){this._fmtYr=wijmo_1.asString(e);this._syncProp(this,"formatYear");this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"formatMonths",{get:function(){return this._fmtMonths},set:function(e){if(e!=this._fmtMonths){this._fmtMonths=wijmo_1.asString(e);this._syncProp(this,"formatMonths");this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"showHeader",{get:function(){return"none"!=this._tbHdr.style.display},set:function(e){if(e!=this.showHeader){this._tbHdr.style.display=wijmo_1.asBoolean(e)?"":"none";this._syncProp(this,"showHeader")}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"monthView",{get:function(){return"none"!=this._tbMth.style.display},set:function(e){if(e!=this.monthView){this._tbMth.style.display=e?"":"none";this._tbYr.style.display=e?"none":"";this.refresh();var t=wijmo_1.culture.Calendar.ariaLabels;wijmo_1.setAriaLabel(this._btnPrv,e?t.prvMo:t.prvYr);wijmo_1.setAriaLabel(this._btnTdy,e?t.today:t.currMo);wijmo_1.setAriaLabel(this._btnNxt,e?t.nxtMo:t.nxtYr);wijmo_1.setAriaLabel(this._btnMth,e?t.monthView:t.yearView);this._syncProp(this,"monthView")}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"weeksBefore",{get:function(){return this._wksBefore},set:function(e){if(e!=this._wksBefore){this._wksBefore=Math.floor(wijmo_1.asNumber(e,!1,!0));this._syncProp(this,"weeksBefore");this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"weeksAfter",{get:function(){return this._wksAfter},set:function(e){if(e!=this._wksAfter){this._wksAfter=Math.floor(wijmo_1.asNumber(e,!1,!0));this._syncProp(this,"weeksAfter");this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(e){if(e!=this._itemFormatter){this._itemFormatter=wijmo_1.asFunction(e);this._syncProp(this,"itemFormatter");this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(Calendar.prototype,"itemValidator",{get:function(){return this._itemValidator},set:function(e){if(e!=this._itemValidator){this._itemValidator=wijmo_1.asFunction(e);this._syncProp(this,"itemValidator");this.invalidate()}},enumerable:!0,configurable:!0});Calendar.prototype.hitTest=function(e){var t=e instanceof MouseEvent?e.target:e instanceof Element?e:null;wijmo_1.assert(null!=t,"MouseEvent or Element expected");return t?t[Calendar._DATE_KEY]:null};Calendar.prototype.ensureVisible=function(e){if(null!=e){var t=this._getCalendars(),i=t.indexOf(this),o=t[0],n=t[t.length-1];e<o.displayMonth?this.displayMonth=wijmo_1.DateTime.addMonths(this._getMonth(e),i):e>n.displayMonth&&(this.displayMonth=wijmo_1.DateTime.addMonths(this._getMonth(e),i-t.length+1))}};Calendar.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e);this._syncProp(this,"value")};Calendar.prototype.onRangeEndChanged=function(e){this.rangeEndChanged.raise(this,e);this._syncProp(this,"rangeEnd");this._value&&this._rngEnd&&this.onRangeChanged(e)};Calendar.prototype.onRangeChanged=function(e){this.rangeChanged.raise(this,e)};Calendar.prototype.onDisplayMonthChanged=function(e){this.displayMonthChanged.raise(this,e);this._syncProp(this,"displayMonth")};Calendar.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)};Calendar.prototype._containsFocusImpl=function(t){return e.prototype._containsFocusImpl.call(this,t)||this._lbYears._containsFocusImpl(t)};Calendar.prototype.dispose=function(){this._rptUp.element=null;this._rptDn.element=null;this._lbYears.dispose();e.prototype.dispose.call(this)};Calendar.prototype.refresh=function(t){void 0===t&&(t=!0);var i=this.hostElement,o=this.containsFocus();if(i){e.prototype.refresh.call(this,t);t&&this._updateContent();this._updateSelection();var n=this._getDisplayMonthRange(),s=this.displayMonth;wijmo_1.enable(this._btnPrv,null==n.from||s>n.from);wijmo_1.enable(this._btnNxt,null==n.to||s<n.to);if(o){var r=(this.monthView?this._tbMth:this._tbYr).querySelector("td.wj-state-selected")||i;r&&r.focus()}var a=this._getCalendars();a.length>1&&this==a[0]&&a.forEach((function(e,i){i>0&&e.refresh(t)}))}};Calendar.prototype._getShowMonthPicker=function(){var e=ShowMonthPicker,t=this._getCalendars(),i=t.indexOf(this),o=this.showMonthPicker;switch(o){case e.FirstMonth:case e.Outside:return 0==i?o:0;case e.LastMonth:return i==t.length-1?o:0;case e.FirstAndLastMonths:return 0==i||i==t.length-1?o:0;case e.AllMonths:return o}return 0};Calendar.prototype._getDisplayMonthRange=function(){var e={from:null,to:null};if(this.min||this.max){var t=this._getCalendars(),i=t.indexOf(this),o=this._mthMode()?wijmo_1.DateTime.addYears:wijmo_1.DateTime.addMonths;this.min&&(e.from=o(this._getMonth(this.min),i));this.max&&(e.to=o(this._getMonth(this.max),i-t.length+1))}return e};Calendar.prototype._getCalendar=function(e){return wijmo_1.Control.getControl(e)};Calendar.prototype._getCalendars=function(){var e=wijmo_1.closest(this.hostElement,".wj-calendar-multimonth");return(e?this._getCalendar(e):this)._cals};Calendar.prototype._syncProp=function(e,t){var i=this;if(!this._syncing){var o=this._getCalendars();if(o&&o.length>1){var n=e[t],s=this._mthMode()?wijmo_1.DateTime.addYears:wijmo_1.DateTime.addMonths;"displayMonth"==t&&(n=s(n,-o.indexOf(e)));o[0].deferUpdate((function(){i._syncing=!0;o.forEach((function(o,r){if(o!=e){var a=o.displayMonth;o[t]="displayMonth"==t?s(n,r):n;if("value"==t){o.displayMonth=a;i._rngMode()&&(o.rangeEnd=null)}}}));i._syncing=!1}))}}};Calendar.prototype._updateContent=function(){var e=this.displayMonth,t=wijmo_1.Globalize.format,i=wijmo_1.DateTime,o=this._getShowMonthPicker();wijmo_1.setText(this._spMth,t(e,this._fmtYrMo));var n=this._btnMth.querySelector(".wj-glyph-down");n&&(n.style.display=this._mthMode()||!o?"none":"");var s=wijmo_1.closest(this._btnTdy,".wj-btn-group");s&&(s.style.display=o?"":"none");for(var r=null!=this._fdw?this._fdw:wijmo_1.Globalize.getFirstDayOfWeek(),a=i.addDays(e,-(e.getDay()-r+7)%7),l=i.monthLast(e),h=this._tbMth.querySelectorAll("td"),u=0;u<7&&u<h.length;u++){var c=i.addDays(a,u);wijmo_1.setText(h[u],t(c,this._fmtDayHdr))}var p=this._tbMth.querySelectorAll("tr");for(u=1;u<p.length;u++)wijmo_1.removeChild(p[u]);var d=i.addDays(a,-7*this._wksBefore);for(u=0;u<this._wksBefore;u++)d=this._addWeek(d,"wj-week-before");for(;d<=l;)d=this._addWeek(d);for(u=0;u<this._wksAfter;u++)d=this._addWeek(d,"wj-week-after");(h=this._tbYr.querySelectorAll("td")).length&&wijmo_1.setText(h[0],t(e,this._fmtYr));for(u=1;u<h.length;u++){d=i.newDate(e.getFullYear(),u-1,1);var _=h[u],m=!this._monthInValidRange(d);_[Calendar._DATE_KEY]=d;wijmo_1.setText(_,t(d,this._fmtMonths));wijmo_1.toggleClass(_,"wj-state-disabled",m);wijmo_1.setAriaLabel(_,wijmo_1.Globalize.format(d,"MMMM yyyy"))}};Calendar.prototype._updateSelection=function(){for(var e=Calendar._DATE_KEY,t=wijmo_1.DateTime,i=this._tbMth.querySelectorAll("td"),o=7;o<i.length;o++){var n=(u=i[o])[e],s=this.value,r=this.rangeEnd,a=this._selMode&&null!=s&&t.sameDate(n,s),l=this._selMode&&null!=s&&t.sameDate(n,r),h=this._selMode&&null!=s&&n>s&&null!=r&&n<=r;wijmo_1.toggleClass(u,"wj-state-selected",a);wijmo_1.toggleClass(u,"wj-state-multi-selected",h);wijmo_1.toggleClass(u,"wj-state-last-selected",l);wijmo_1.setAttribute(u,"aria-selected",!!a||null);this._customizeCell(o,n,u)}i=this._tbYr.querySelectorAll("td");for(o=0;o<i.length;o++){var u;n=(u=i[o])[e],a=this._sameMonth(n,this.value);wijmo_1.toggleClass(u,"wj-state-selected",a);wijmo_1.setAttribute(u,"aria-selected",!!a||null)}};Calendar.prototype._addWeek=function(e,t){for(var i=this._createElement("tr",this._tbMth,t),o=wijmo_1.DateTime,n=0;n<7;n++){var s=this._createElement("td",i),r=o.addDays(e,n);s[Calendar._DATE_KEY]=r;wijmo_1.setText(s,wijmo_1.Globalize.format(r,this._fmtDay));wijmo_1.setAriaLabel(s,wijmo_1.Globalize.format(r,"D"));var a=!this._valid(r),l=r.getDay(),h=r.getMonth()!=this.displayMonth.getMonth();wijmo_1.toggleClass(s,"wj-day-today",o.sameDate(r,o.newDate()));wijmo_1.toggleClass(s,"wj-day-weekend",0==l||6==l);wijmo_1.toggleClass(s,"wj-day-othermonth",h||!this._inValidRange(r)||a);wijmo_1.toggleClass(s,"wj-state-invalid",a)}return o.addDays(e,7)};Calendar.prototype._customizeCell=function(e,t,i){wijmo_1.isFunction(this.itemFormatter)&&this.itemFormatter(t,i);if(this.formatItem.hasHandlers){var o=new FormatItemEventArgs(e,t,i);this.onFormatItem(o)}};Calendar.prototype._canChangeValue=function(){return!this._readOnly&&this._selMode!=DateSelectionMode.None};Calendar.prototype._valid=function(e){return!(!wijmo_1.isDate(e)||!wijmo_1.DateTime.sameDate(e,this._clamp(e)))&&(!wijmo_1.isFunction(this.itemValidator)||this.itemValidator(e))};Calendar.prototype._inValidRange=function(e){var t=wijmo_1.DateTime.fromDateTime;return!(this.min&&e<t(this.min,e))&&!(this.max&&e>t(this.max,e))};Calendar.prototype._monthInValidRange=function(e){if(this.min||this.max){var t=e.getFullYear(),i=e.getMonth(),o=wijmo_1.DateTime,n=o.newDate(t,i,1),s=o.newDate(t,i+1,0);if(this.min&&this.min>s)return!1;if(this.max&&this.max<n)return!1}return!0};Calendar.prototype._sameMonth=function(e,t){return wijmo_1.isDate(e)&&wijmo_1.isDate(t)&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()};Calendar.prototype._getValidDate=function(e,t){if(wijmo_1.isDate(e))for(var i=e.getFullYear(),o=e.getMonth()+(t?0:1),n=t?1:0,s=wijmo_1.DateTime,r=s.newDate(i,o,n),a=t?1:-1,l=0;l<31;l++){if(this._valid(r))return r;r=s.addDays(r,a)}return null};Calendar.prototype._clamp=function(e){if(e){var t=wijmo_1.DateTime.fromDateTime;if(this.min){var i=t(this.min,e);e<i&&(e=i)}if(this.max){var o=t(this.max,e);e>o&&(e=o)}}return e};Calendar.prototype._createChildren=function(){var e=this.getTemplate();this.applyTemplate("wj-control wj-calendar",e,{_tbHdr:"tbl-header",_btnMth:"btn-month",_spMth:"span-month",_btnPrv:"btn-prev",_btnTdy:"btn-today",_btnNxt:"btn-next",_tbMth:"tbl-month",_tbYr:"tbl-year"});this._tbYr.style.display="none";var t=wijmo_1.culture.Calendar.ariaLabels;wijmo_1.setAriaLabel(this._tbMth,t.calendar);wijmo_1.setAriaLabel(this._tbYr,t.calendar);wijmo_1.setAriaLabel(this._btnPrv,t.calendar);wijmo_1.setAriaLabel(this._btnMth,t.monthView);wijmo_1.setAriaLabel(this._btnPrv,t.prvMo);wijmo_1.setAriaLabel(this._btnTdy,t.today);wijmo_1.setAriaLabel(this._btnNxt,t.nxtMo);for(var i=this._createElement("tr",this._tbMth,"wj-header"),o=0;o<7;o++)this._createElement("td",i);i=this._createElement("tr",this._tbYr,"wj-header");this._createElement("td",i).setAttribute("colspan","4");for(var n=0;n<3;n++){i=this._createElement("tr",this._tbYr);for(var s=0;s<4;s++)this._createElement("td",i)}};Calendar.prototype._createYearPicker=function(){var e=this,t=this.hostElement,i=this._createElement("div",null,"wj-dropdown-panel wj-yearpicker");i.tabIndex=this._orgTabIndex;this._lbYears=new ListBox(i,{lostFocus:function(t){wijmo_1.hidePopup(i);e._tmYrHidden=Date.now();e.removeEventListener(window,"touchstart");if(t.selectedIndex>-1){var o=wijmo_1.DateTime.clone(e.displayMonth);o.setFullYear(t.selectedIndex+t.itemsSource[0]);e.displayMonth=o}}});this.addEventListener(i,"keydown",(function(i){switch(i.keyCode){case wijmo_1.Key.Enter:t.focus();break;case wijmo_1.Key.Escape:e._lbYears.selectedIndex=-1;t.focus()}i.defaultPrevented&&i.stopPropagation()}));this.addEventListener(i,"click",(function(e){t.focus()}))};Calendar.prototype._createElement=function(e,t,i){var o=document.createElement(e);i&&wijmo_1.addClass(o,i);t&&t.appendChild(o);return o};Calendar.prototype._click=function(e){var t=this;if(!e.defaultPrevented&&0==e.button){var i=!1,o=e.target;if(wijmo_1.contains(this._btnMth,o)&&!this._mthMode()&&this._getShowMonthPicker()){this.monthView=!this.monthView;i=!0}else if(wijmo_1.contains(this._btnPrv,o)){this._navigate(-1);i=!0}else if(wijmo_1.contains(this._btnNxt,o)){this._navigate(1);i=!0}else if(wijmo_1.contains(this._btnTdy,o)){this._navigate(0);i=!0}if(o&&!i&&this._yrPicker&&wijmo_1.contains(this._tbYr,o)&&wijmo_1.closest(o,".wj-header")){if(Date.now()-this._tmYrHidden<600){e.preventDefault();return}for(var n=this.displayMonth.getFullYear(),s=this.min?this.min.getFullYear():n-100,r=this.max?this.max.getFullYear():n+100,a=[],l=s;l<=r;l++)a.push(l);var h=this._lbYears,u=h.hostElement,c=wijmo_1.closest(o,".wj-header"),p=this.hostElement,d=wijmo_1.closest(p,".wj-inputdate-dropdown")||p;h.itemsSource=a;h.selectedIndex=n-a[0];wijmo_1.setAttribute(u,"dir",this.rightToLeft?"rtl":null);wijmo_1.setCss(u,{minWidth:"",width:c.offsetWidth});wijmo_1.showPopup(u,c,!1,!1,d);requestAnimationFrame((function(){h.showSelection(!0)}));this.addEventListener(window,"touchstart",(function(e){if(!wijmo_1.contains(u,e.target)){wijmo_1.hidePopup(u);t._tmYrHidden=Date.now();t.removeEventListener(window,"touchstart")}}));e.preventDefault();return}if(o&&!i){var _=wijmo_1.closest(o,"td");if(_){var m=this.hitTest(_),f=wijmo_1.DateTime.fromDateTime;if(this.monthView){if(m&&this._canChangeValue()){var g=f(m,this._value);this._inValidRange(g)&&this._valid(g)&&(this._rngMode()&&this.value&&!this.rangeEnd&&g>=this.value?this.rangeEnd=g:this.value=g);i=!0}}else if(m){this.displayMonth=m;if(this._mthMode()){if(this._canChangeValue()){g=f(this.displayMonth,this.value);this._inValidRange(g)&&(this.value=g)}}else this.monthView=!0;i=!0}}}if(i){e.preventDefault();this.focus()}}};Calendar.prototype._keydown=function(e){if(!e.defaultPrevented){if(e.altKey)switch(e.keyCode){case wijmo_1.Key.Up:case wijmo_1.Key.Down:return;case wijmo_1.Key.End:this._navigate(0);e.preventDefault();return}if(!(e.ctrlKey||e.metaKey||e.shiftKey&&!this._rngMode())){var t=this._getKeyCode(e),i=0,o=0,n=!0;if(this.monthView)switch(t){case wijmo_1.Key.Left:i=-1;break;case wijmo_1.Key.Right:i=1;break;case wijmo_1.Key.Up:i=-7;break;case wijmo_1.Key.Down:i=7;break;case wijmo_1.Key.PageDown:o=e.altKey?12:1;break;case wijmo_1.Key.PageUp:o=e.altKey?-12:-1;break;case wijmo_1.Key.Home:case wijmo_1.Key.End:if(this._canChangeValue()&&!e.shiftKey){var s=this.value||this.displayMonth;if(a=this._getValidDate(s,t==wijmo_1.Key.Home)){this.value=wijmo_1.DateTime.fromDateTime(a,this.value);this._rngEnd=null}}break;default:n=!1}else switch(t){case wijmo_1.Key.Left:o=-1;break;case wijmo_1.Key.Right:o=1;break;case wijmo_1.Key.Up:o=-4;break;case wijmo_1.Key.Down:o=4;break;case wijmo_1.Key.PageDown:o=e.altKey?120:12;break;case wijmo_1.Key.PageUp:o=e.altKey?-120:-12;break;case wijmo_1.Key.Home:o=this.value?-this.value.getMonth():0;break;case wijmo_1.Key.End:o=this.value?11-this.value.getMonth():0;break;case wijmo_1.Key.Enter:this._mthMode()?n=!1:this.monthView=!0;break;default:n=!1}if(this._canChangeValue()&&(i||o)){var r=e.shiftKey&&null!=this.rangeEnd?this.rangeEnd:this.value,a=wijmo_1.DateTime;if(r){r=a.addDays(r,i);r=a.addMonths(r,o)}else r=this._getValidDate(new Date,!0);if(o&&!this._valid(r)){s=r.getMonth();for(var l=1;l<31&&!this._valid(r);l++){var h=a.addDays(r,+l),u=a.addDays(r,-l);this._valid(h)&&h.getMonth()==s?r=h:this._valid(u)&&u.getMonth()==s&&(r=u)}}for(l=0;l<31&&!this._valid(r);l++)r=a.addDays(r,i>0||o>0?1:-1);e.shiftKey&&r>this.value?this.rangeEnd=r:this.value=r}n&&e.preventDefault()}}};Calendar.prototype._getMonth=function(e){var t=wijmo_1.DateTime;e=e||t.newDate();return t.newDate(e.getFullYear(),e.getMonth(),1)};Calendar.prototype._mthMode=function(){return this.selectionMode==DateSelectionMode.Month};Calendar.prototype._rngMode=function(){return this.selectionMode==DateSelectionMode.Range};Calendar.prototype._navigate=function(e){var t=this.monthView,i=this.displayMonth,o=wijmo_1.DateTime;switch(e){case 0:var n=o.newDate();this._canChangeValue()&&(this.value=t?o.fromDateTime(n,this.value):this._getMonth(n));i=this._getMonth(n);break;case 1:i=o.addMonths(i,t?1:12);break;case-1:i=o.addMonths(i,t?-1:-12)}this.displayMonth=i};Calendar.prototype._setTabOrder=function(t){e.prototype._setTabOrder.call(this,t);this._lbYears.tabOrder=this._orgTabIndex};Calendar._DATE_KEY="$WJ-DATE";Calendar.controlTemplate='<div class="wj-content wj-calendar-outer"><div wj-part="tbl-header" class="wj-calendar-header"><div wj-part="btn-month" class="wj-month-select" role="button"><span wj-part="span-month"></span> <span class="wj-glyph-down"></span></div><div class="wj-btn-group"><button wj-part="btn-prev" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-left"></span></button><button wj-part="btn-today" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-circle"></span></button><button wj-part="btn-next" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-right"></span></button></div></div><table wj-part="tbl-month" class="wj-calendar-month" role="grid"></table><table wj-part="tbl-year" class="wj-calendar-year" role="grid"></table></div>';return Calendar}(wijmo_1.Control);exports.Calendar=Calendar;wijmo_1._addCultureInfo("DropDown",{ariaLabels:{tgl:"Toggle Dropdown"}});!function(e){e[e.Select=0]="Select";e[e.Open=1]="Open";e[e.Toggle=2]="Toggle"}(ClickAction=exports.ClickAction||(exports.ClickAction={}));var PopupTrigger,_Edges,DropDown=function(e){__extends(DropDown,e);function DropDown(t,i){var o=e.call(this,t)||this;o._clickAction=ClickAction.Select;o._showBtn=!0;o._autoExpand=!0;o._animate=!1;o._internalSettingText=!1;o._oldText="";o.textChanged=new wijmo_1.Event;o.isDroppedDownChanging=new wijmo_1.Event;o.isDroppedDownChanged=new wijmo_1.Event;var n=o.getTemplate();o.applyTemplate("wj-control wj-content wj-dropdown",n,{_tbx:"input",_btn:"btn",_dropDown:"dropdown"},"input");o._dropDown.style.display="none";var s=wijmo_1.culture.DropDown.ariaLabels;wijmo_1.setAriaLabel(o._btn.querySelector("button"),s.tgl);var r=o._elRef=o._tbx;wijmo_1.disableAutoComplete(r);o._createDropDown();o._updateBtn();var a=o.hostElement;wijmo_1.addClass(a,"wj-state-collapsed");o.addEventListener(window,"resize",(function(){o.isDroppedDown&&o.invalidate()}));var l=o.dropDown,h=o.addEventListener.bind(o),u=o._updateFocusState.bind(o);h(l,"blur",u,!0);h(l,"focus",u);var c=o._keydown.bind(o);h(a,"keydown",c);h(l,"keydown",c);var p=o._keypress.bind(o);h(a,"keypress",p,!0);h(l,"keypress",p,!0);h(r,"input",(function(){o._setText(o.text,!1)}));h(r,"blur",(function(){o._commitText(!0)}),!0);h(r,"click",(function(){o._autoExpand&&o._expandSelection()}));h(r,"mousedown",(function(e){switch(o._clickAction){case ClickAction.Open:if(!o.isDroppedDown){e.preventDefault();o.focus();o.isDroppedDown=!0}break;case ClickAction.Toggle:e.preventDefault();o.focus();o.isDroppedDown=!o.isDroppedDown}}));h(o._btn,"mousedown",(function(e){o._btnclick(e)}));wijmo_1.removeChild(l);wijmo_1.isIE()&&o._elRef==o._tbx&&h(a,"mouseup",(function(e){if(!e.defaultPrevented&&0==e.button&&wijmo_1.hasClass(e.target,"wj-btn")){var t=wijmo_1.getActiveElement();t&&t!=e.target&&setTimeout((function(){t.focus()}))}}));wijmo_1.isIE9()&&h(r,"keyup",(function(){o._setText(o.text,!1)}));h(l,"click",o._dropDownClick.bind(o));return o}Object.defineProperty(DropDown.prototype,"text",{get:function(){return this._tbx.value},set:function(e){if(e!=this.text){this._setText(e,!0);this._commitText()}},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"isReadOnly",{get:function(){return this._tbx.readOnly},set:function(e){this._tbx.readOnly=wijmo_1.asBoolean(e);wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"isRequired",{get:function(){return this._tbx.required},set:function(e){this._tbx.required=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"placeholder",{get:function(){return this._tbx.placeholder},set:function(e){this._tbx.placeholder=e},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"clickAction",{get:function(){return this._clickAction},set:function(e){this._clickAction=wijmo_1.asEnum(e,ClickAction)},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"isDroppedDown",{get:function(){var e=this._dropDown;return e&&"none"!=e.style.display},set:function(e){var t=this,i=this.hostElement,o=this._dropDown,n=this.containsFocus();if(i&&o&&(e=wijmo_1.asBoolean(e)&&!this.isDisabled&&!this.isReadOnly&&i.offsetWidth>0)!=this.isDroppedDown&&this.onIsDroppedDownChanging(new wijmo_1.CancelEventArgs)){if(e){this._minWidthDropdown=o.style.minWidth;o.style.display="";this._updateDropDown();this.addEventListener(window,"touchstart",(function(e){for(var o=e.target;o;){if(o==i)return;o=o[wijmo_1.Control._OWNR_KEY]||o.parentNode}wijmo_1.Control._touching=!0;t.isDroppedDown=!1;wijmo_1.Control._touching=!1}))}else{this.removeEventListener(window,"touchstart");wijmo_1.hidePopup(o);o.style.minWidth=this._minWidthDropdown}n&&(this.isTouching&&this.showDropDownButton?i.focus():this.selectAll());this._updateFocusState();wijmo_1.toggleClass(i,"wj-state-collapsed",!this.isDroppedDown);this.onIsDroppedDownChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"dropDown",{get:function(){return this._dropDown},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"dropDownCssClass",{get:function(){return this._cssClass},set:function(e){if(e!=this._cssClass){wijmo_1.removeClass(this._dropDown,this._cssClass);this._cssClass=wijmo_1.asString(e);wijmo_1.addClass(this._dropDown,this._cssClass)}},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"showDropDownButton",{get:function(){return this._showBtn},set:function(e){this._showBtn=wijmo_1.asBoolean(e);this._updateBtn()},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"autoExpandSelection",{get:function(){return this._autoExpand},set:function(e){this._autoExpand=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(DropDown.prototype,"isAnimated",{get:function(){return this._animate},set:function(e){this._animate=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});DropDown.prototype.selectAll=function(){var e=this._tbx;this._elRef==e&&wijmo_1.setSelectionRange(e,0,this.text.length);this.containsFocus()||this.focus()};DropDown.prototype.onTextChanged=function(e){this.textChanged.raise(this,e);this._updateState()};DropDown.prototype.onIsDroppedDownChanging=function(e){this.isDroppedDownChanging.raise(this,e);return!e.cancel};DropDown.prototype.onIsDroppedDownChanged=function(e){this.isDroppedDownChanged.raise(this,e)};DropDown.prototype.onGotFocus=function(t){this.isTouching||wijmo_1.contains(this._dropDown,wijmo_1.getActiveElement())||this.selectAll();e.prototype.onGotFocus.call(this,t)};DropDown.prototype.onLostFocus=function(t){this._commitText();this.isDroppedDown=!1;e.prototype.onLostFocus.call(this,t)};DropDown.prototype._containsFocusImpl=function(t){return e.prototype._containsFocusImpl.call(this,t)||this.isDroppedDown&&wijmo_1.contains(this._dropDown,t)};DropDown.prototype.dispose=function(){this.isDroppedDown=!1;var t=this._dropDown;if(t){this._dropDown=null;wijmo_1.removeChild(t);var i=wijmo_1.Control.getControl(t);i&&i.dispose()}e.prototype.dispose.call(this)};DropDown.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);var i=this.hostElement;if(i&&i.offsetHeight&&this.isDroppedDown){var o=wijmo_1.getActiveElement();this.isAnimated&&""!=this._dropDown.style.opacity||wijmo_1.showPopup(this._dropDown,i,!1,!1,null==this.dropDownCssClass);o instanceof HTMLElement&&o!=wijmo_1.getActiveElement()&&o.focus()}};DropDown.prototype._handleResize=function(){this.isDroppedDown&&this.refresh()};DropDown.prototype._dropDownClick=function(e){e.stopPropagation()};DropDown.prototype._expandSelection=function(){var e=this._tbx,t=e.value,i=e.selectionStart,o=e.selectionEnd;if(t&&i==o){var n=this._getCharType(t,i);if(n>-1){for(;o<t.length&&this._getCharType(t,o)==n;o++);for(;i>0&&this._getCharType(t,i-1)==n;i--);i!=o&&wijmo_1.setSelectionRange(e,i,o)}}};DropDown.prototype._getCharType=function(e,t){var i=e[t];return i>="0"&&i<="9"?0:i>="a"&&i<="z"||i>="A"&&i<="Z"?1:-1};DropDown.prototype._keydown=function(e){if(!e.defaultPrevented&&!this._isHiddenEditor()){switch(e.keyCode){case wijmo_1.Key.Tab:case wijmo_1.Key.Escape:case wijmo_1.Key.Enter:if(this.isDroppedDown){this.isDroppedDown=!1;e.keyCode==wijmo_1.Key.Tab||this.containsFocus()||this.focus();e.preventDefault()}break;case wijmo_1.Key.F4:case wijmo_1.Key.Up:case wijmo_1.Key.Down:if(e.keyCode==wijmo_1.Key.F4||e.altKey){var t=this.hostElement;if(t&&t.offsetHeight){this.isDroppedDown=!this.isDroppedDown;e.preventDefault()}}}if(!e.defaultPrevented&&e.keyCode==wijmo_1.Key.Escape&&wijmo_1.isIE()){var i=this._tbx;if(e.target==i){var o=i.value;i.value=o+" ";i.value=o}}}};DropDown.prototype._isHiddenEditor=function(){return wijmo_1.hasClass(this._tbx,"wj-grid-ime")};DropDown.prototype._keypress=function(e){"AltLeft"!=e.code&&"AltRight"!=e.code||e.preventDefault()};DropDown.prototype._btnclick=function(e){if(!e.defaultPrevented&&0==e.button){e.preventDefault();this.isTouching?this._containsFocus()||this.hostElement.focus():this.focus();this.isDroppedDown=!this.isDroppedDown}};DropDown.prototype._setText=function(e,t){(e=(e||"").toString())!=this._tbx.value&&(this._tbx.value=e);if(e!=this._oldText){this._oldText=e;this._internalSettingText||this.onTextChanged()}this._updateState()};DropDown.prototype._updateBtn=function(){this._btn.style.display=this._showBtn?"":"none"};DropDown.prototype._createDropDown=function(){};DropDown.prototype._commitText=function(e){};DropDown.prototype._updateDropDown=function(){if(this.isDroppedDown){this._commitText();var e=this.dropDown;wijmo_1.setAttribute(e,"dir",this.rightToLeft?"rtl":null);wijmo_1.showPopup(e,this.hostElement,!1,this._animate,null==this.dropDownCssClass)}};DropDown.controlTemplate='<div class="wj-template"><div class="wj-input"><div class="wj-input-group wj-input-btn-visible"><input wj-part="input" type="text" class="wj-form-control"><span wj-part="btn" class="wj-input-group-btn"><button class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-down"></span></button></span></div></div><div wj-part="dropdown" class="wj-content wj-dropdown-panel"></div></div>';return DropDown}(wijmo_1.Control);exports.DropDown=DropDown;!function(e){e[e.None=0]="None";e[e.ClickOwner=1]="ClickOwner";e[e.ClickPopup=2]="ClickPopup";e[e.Click=3]="Click";e[e.BlurOwner=4]="BlurOwner";e[e.BlurPopup=8]="BlurPopup";e[e.Blur=12]="Blur";e[e.ClickOrBlur=15]="ClickOrBlur";e[e.DownOwner=16]="DownOwner";e[e.DownPopup=32]="DownPopup";e[e.Down=48]="Down";e[e.EnterOwner=64]="EnterOwner";e[e.EnterPopup=128]="EnterPopup";e[e.Enter=192]="Enter";e[e.LeaveOwner=256]="LeaveOwner";e[e.LeavePopup=512]="LeavePopup";e[e.Leave=768]="Leave"}(PopupTrigger=exports.PopupTrigger||(exports.PopupTrigger={}));!function(e){e[e.None=0]="None";e[e.Left=1]="Left";e[e.Top=2]="Top";e[e.Right=4]="Right";e[e.Bottom=8]="Bottom";e[e.LeftTop=3]="LeftTop";e[e.RightTop=6]="RightTop";e[e.RightBottom=12]="RightBottom";e[e.LeftBottom=9]="LeftBottom"}(_Edges||(_Edges={}));var Popup=function(e){__extends(Popup,e);function Popup(t,i){var o=e.call(this,t)||this;o._owner=null;o._modal=!1;o._position=wijmo_1.PopupPosition.BelowLeft;o._showTrigger=PopupTrigger.ClickOwner;o._hideTrigger=PopupTrigger.Blur;o._hideAnim=[];o._fadeIn=!0;o._fadeOut=!0;o._removeOnHide=!0;o._draggable=!1;o._resizable=!1;o._result=null;o._resultEnter=null;o._resultSubmit=null;o._callback=null;o._visible=!1;o._ownerClickBnd=o._ownerClick.bind(o);o._ownerDownBnd=o._ownerDown.bind(o);o._ownerBlurBnd=o._ownerBlur.bind(o);o._ownerEnterBnd=o._ownerEnter.bind(o);o._ownerLeaveBnd=o._ownerLeave.bind(o);o._mousedownBnd=o._mousedown.bind(o);o._mousemoveBnd=o._mousemove.bind(o);o._mousedragBnd=o._mousedrag.bind(o);o._mouseupBnd=o._mouseup.bind(o);o._hideBnd=o.hide.bind(o);o._lastShow=0;o.showing=new wijmo_1.Event;o.shown=new wijmo_1.Event;o.hiding=new wijmo_1.Event;o.hidden=new wijmo_1.Event;o.resizing=new wijmo_1.Event;o.resized=new wijmo_1.Event;o.dragging=new wijmo_1.Event;o.dragged=new wijmo_1.Event;o.sizeChanging=new wijmo_1.Event;o.sizeChanged=new wijmo_1.Event;o.positionChanging=new wijmo_1.Event;o.positionChanged=new wijmo_1.Event;var n=o.hostElement;wijmo_1.addClass(n,"wj-control wj-content wj-popup");n.getAttribute("tabindex")||(n.tabIndex=0);wijmo_1.hidePopup(n,!1);var s=o.addEventListener.bind(o);s(n,"compositionstart",(function(){o._composing=!0}));s(n,"compositionend",(function(){o._composing=!1}));s(window,"resize",(function(){!o.isVisible||o._dragged||o.isTouching||o.invalidate()}));s(n,"keydown",(function(e){if(!e.defaultPrevented){if(e.keyCode==wijmo_1.Key.Escape&&!o._composing){e.preventDefault();o.hide()}if(e.keyCode==wijmo_1.Key.Enter&&!o._composing){var t=o.dialogResultEnter;if(t){e.preventDefault();o._validateAndHide(t)}}if(e.keyCode==wijmo_1.Key.Tab&&o.modal){e.preventDefault();wijmo_1.moveFocus(n,e.shiftKey?-1:1)}}}));s(n,"click",(function(e){var t=e.target;if(t instanceof HTMLElement){if(t instanceof HTMLButtonElement&&"submit"==t.type){var i=o.hostElement,n=o.dialogResultSubmit;if(i instanceof HTMLFormElement&&n&&i.reportValidity()){e.preventDefault();o.hide(n)}}var s=t.className.match(/\bwj-hide[\S]*\b/);if(s&&s.length>0){e.preventDefault();e.stopPropagation();o.hide(s[0])}}}));var r=o._toggle.bind(o),a=PopupTrigger;o.addEventListener(n,"click",(function(e){o._ignoreClick||r(e,a.ClickPopup)}),!0);o.addEventListener(n,"mousedown",(function(e){o._ignoreClick=!1;r(e,a.DownPopup)}),!0);o.addEventListener(n,"mouseenter",(function(e){e.target==n&&r(e,a.EnterPopup)}),!0);o.addEventListener(n,"mouseleave",(function(e){e.target==n&&r(e,a.LeavePopup)}),!0);o.addEventListener(n,"blur",(function(e){o.containsFocus()||r(e,a.BlurPopup)}),!0);s(document,"wheel",(function(e){if(o.isVisible&&o._modal){for(var t=e.target;t&&t!=document.body;t=t.parentElement)if(t.scrollHeight>t.clientHeight)return;e.preventDefault()}}));o.initialize(i);return o}Object.defineProperty(Popup.prototype,"owner",{get:function(){return this._owner},set:function(e){var t=this._owner;if(t){this.removeEventListener(t,"click");this.removeEventListener(t,"mousedown");this.removeEventListener(t,"mouseenter");this.removeEventListener(t,"mouseleave");this.removeEventListener(t,"blur")}if(t=this._owner=null!=e?wijmo_1.getElement(e):null){this.addEventListener(t,"click",this._ownerClickBnd,!0);this.addEventListener(t,"mousedown",this._ownerDownBnd,!0);this.addEventListener(t,"mouseenter",this._ownerEnterBnd,!0);this.addEventListener(t,"mouseleave",this._ownerLeaveBnd,!0);this.addEventListener(t,"blur",this._ownerBlurBnd,!0)}},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"position",{get:function(){return this._position},set:function(e){this._position=wijmo_1.asEnum(e,wijmo_1.PopupPosition)},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"content",{get:function(){return this.hostElement.firstElementChild},set:function(e){if(e!=this.content){this.hostElement.innerHTML="";e instanceof HTMLElement&&this.hostElement.appendChild(e)}},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"showTrigger",{get:function(){return this._showTrigger},set:function(e){this._showTrigger=wijmo_1.asEnum(e,PopupTrigger)},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"hideTrigger",{get:function(){return this._hideTrigger},set:function(e){this._hideTrigger=wijmo_1.asEnum(e,PopupTrigger)},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"fadeIn",{get:function(){return this._fadeIn},set:function(e){this._fadeIn=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"fadeOut",{get:function(){return this._fadeOut},set:function(e){this._fadeOut=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"removeOnHide",{get:function(){return this._removeOnHide},set:function(e){if((e=wijmo_1.asBoolean(e))!=this.removeOnHide){this._removeOnHide=e;if(!this.isVisible){var t=this.hostElement;if(e)wijmo_1.removeChild(t);else if(t&&document.body){t.style.display="none";document.body.appendChild(t)}}}},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"modal",{get:function(){return this._modal},set:function(e){this._modal=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"isDraggable",{get:function(){return this._draggable},set:function(e){this._draggable=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"isResizable",{get:function(){return this._resizable},set:function(e){this._resizable=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"dialogResult",{get:function(){return this._result},set:function(e){this._result=e},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"dialogResultEnter",{get:function(){return this._resultEnter},set:function(e){this._resultEnter=e},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"dialogResultSubmit",{get:function(){return this._resultSubmit},set:function(e){this._resultSubmit=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(Popup.prototype,"isVisible",{get:function(){var e=this.hostElement;return this._visible&&null!=e&&e.offsetHeight>0},enumerable:!0,configurable:!0});Popup.prototype.show=function(e,t){var i=this;this._lastShow=Date.now();if(!this.isVisible){var o=this.hostElement;this.dialogResult=null;this._callback=null;this._oldFocus=null;this._myFocus=null;this._hideAnim.forEach((function(e){clearInterval(e)}));if(this._hideAnim.length>0){this._hideAnim.length=0;if(this._bkDrop){wijmo_1.hidePopup(this._bkDrop,this.removeOnHide);this._bkDrop.style.opacity=""}wijmo_1.hidePopup(o,this.removeOnHide);o.style.opacity=""}var n=new wijmo_1.CancelEventArgs;if(this.onShowing(n)){null!=e&&(this.modal=wijmo_1.asBoolean(e));null!=t&&(this._callback=wijmo_1.asFunction(t));this._oldFocus=wijmo_1.getActiveElement();wijmo_1.showPopup(o,this._owner,this._position,this._fadeIn,!1,this._hideBnd);this._modal&&this._showBackdrop();this._composing=!1;this._visible=!0;this.onShown(n);this._clearTimeouts();if(this.modal){this.addEventListener(window,"focus",(function(){if(!i.containsFocus()){var e=i._myFocus;e&&e.offsetHeight?e.focus():wijmo_1.moveFocus(o,0)}}));this.addEventListener(o,"focusin",(function(){var e=wijmo_1.getActiveElement();e&&wijmo_1.contains(o,e)&&(e.tabIndex>-1||!i._myFocus)&&(i._myFocus=e)}))}this._resized=this._dragged=this._ignoreClick=!1;this._handleDragResize(!0);this.addEventListener(window,"touchstart",(function(e){i._hideTrigger&PopupTrigger.Blur&&!wijmo_1.contains(o,e.target,!0)&&i.hide()}));setTimeout((function(){i.addEventListener(window,"click",(function(e){i._hideTrigger&PopupTrigger.BlurPopup&&i.isDisabled&&!wijmo_1.contains(o,e.target,!0)&&i.hide()}))}));setTimeout((function(){if(!i.isDisabled&&!i.containsFocus()&&!i.isTouching){var e=o.querySelector("[autofocus]");if(e&&e.clientHeight>0&&!e.disabled&&e.tabIndex>-1&&!wijmo_1.closest(e,"[disabled],.wj-state-disabled")){e.focus();wijmo_1.isFunction(e.select)&&e.select()}else wijmo_1.moveFocus(o,0)}if(!i.isDisabled&&!i.containsFocus()){o.tabIndex=0;o.focus()}}),100)}}};Popup.prototype.hide=function(e){var t=this;this._handleDragResize(!1);this.removeEventListener(window,"touchstart");this.removeEventListener(window,"click");if(this.isVisible){wijmo_1.isUndefined(e)||(this.dialogResult=e);var i=new wijmo_1.CancelEventArgs,o=this.hostElement;if(this.onHiding(i)){for(var n=this.containsFocus()?this._oldFocus:null,s=o.querySelectorAll(".wj-control.wj-dropdown"),r=0;r<s.length;r++){var a=wijmo_1.Control.getControl(s[r]);a instanceof DropDown&&(a.isDroppedDown=!1)}var l=this.removeOnHide,h=this.fadeOut;setTimeout((function(){t._updateState();t.onHidden(i);t._callback&&t._callback(t);if(t.hideTrigger&PopupTrigger.LeavePopup){var e=wijmo_1.Control.getControl(wijmo_1.closest(t.owner,".wj-popup"));if(e instanceof Popup&&0!=(e.hideTrigger&PopupTrigger.Leave)){var o=Popup._evtHover,n=o?document.elementFromPoint(o.clientX,o.clientY):null,s=wijmo_1.Control.getControl(wijmo_1.closest(n,".wj-popup"));s instanceof Popup&&!s.isVisible&&(n=null);n&&wijmo_1.contains(e.hostElement,n,!0)||e.hide()}}}),wijmo_1.Control._FOCUS_INTERVAL+50);this._bkDrop&&this._hideAnim.push(wijmo_1.hidePopup(this._bkDrop,l,h));this._hideAnim.push(wijmo_1.hidePopup(o,l,h));this._visible=!1;this._oldFocus=null;this._myFocus=null;this.removeEventListener(window,"focus");this.removeEventListener(o,"focusin");this.containsFocus()&&wijmo_1.getActiveElement().blur();this._clearTimeouts();!this.isVisible&&n&&n.offsetHeight&&n.focus()}}};Popup.prototype.onShowing=function(e){this.showing.raise(this,e);return!e.cancel};Popup.prototype.onShown=function(e){this.shown.raise(this,e)};Popup.prototype.onHiding=function(e){this.hiding.raise(this,e);return!e.cancel};Popup.prototype.onHidden=function(e){this._wasVisible=!1;this.hidden.raise(this,e)};Popup.prototype.onResizing=function(e){this.resizing.raise(this,e);return!e.cancel};Popup.prototype.onResized=function(e){this.resized.raise(this,e)};Popup.prototype.onDragging=function(e){this.dragging.raise(this,e);return!e.cancel};Popup.prototype.onDragged=function(e){this.dragged.raise(this,e)};Popup.prototype.onSizeChanging=function(e){this.sizeChanging.raise(this,e);return!e.cancel};Popup.prototype.onSizeChanged=function(e){this.sizeChanged.raise(this,e)};Popup.prototype.onPositionChanging=function(e){this.positionChanging.raise(this,e);return!e.cancel};Popup.prototype.onPositionChanged=function(e){this.positionChanged.raise(this,e)};Popup.prototype.onLostFocus=function(t){e.prototype.onLostFocus.call(this,t);if(this._hideTrigger&PopupTrigger.BlurPopup&&!this.containsFocus()){var i=document.createEvent("Event");i.initEvent("blur",!0,!0);this._toggle(i,PopupTrigger.BlurPopup)}};Popup.prototype.dispose=function(){this.owner=null;e.prototype.dispose.call(this)};Popup.prototype.refresh=function(t){void 0===t&&(t=!0);var i=this.hostElement;e.prototype.refresh.call(this,t);if(this.isVisible&&!this._refreshing&&i){this._refreshing=!0;for(var o=wijmo_1.getActiveElement(),n=this._owner?this._owner.getBoundingClientRect():null,s=[],r=i.querySelectorAll(".wj-dropdown"),a=0;a<r.length;a++){var l=wijmo_1.Control.getControl(r[a]);if(l instanceof DropDown&&l.isDroppedDown){s.push(l);l.dropDown.style.display="none"}}wijmo_1.showPopup(i,n,this._position);s.forEach((function(e){e.dropDown.style.display="";e._updateDropDown()}));this._modal&&o instanceof HTMLElement&&o!=wijmo_1.getActiveElement()&&o.focus();this._refreshing=!1}};Popup.prototype._clearTimeouts=function(){if(this._toShow){clearTimeout(this._toShow);this._toShow=null}if(this._toHideLeave){clearTimeout(this._toHideLeave);this._toHideLeave=null}if(this._toHideBlur){clearTimeout(this._toHideBlur);this._toHideBlur=null}};Popup.prototype._handleDragResize=function(e){var t=this.hostElement,i=this._draggable?this._getHeaderElement():null,o=this.addEventListener.bind(this),n=this.removeEventListener.bind(this),s=this._mousemoveBnd,r=this._mousedownBnd;if(e){o(t,"mousemove",s);o(t,"mousedown",r);o(t,"touchstart",r);i&&(i.style.touchAction="none")}else{this._mousedownEvt=null;this._rcBounds=null;n(t,"mousemove",s);n(t,"mousedown",r);n(t,"touchstart",r);n(document,"mousemove",this._mousedragBnd);n(document,"mouseup",this._mouseupBnd);i&&(i.style.touchAction="")}};Popup.prototype._mousemove=function(e){if(!this._mousedownEvt){var t=this.hostElement,i=this._getEdges(t,e),o="",n=_Edges;this._edges=i;this._resizable&&(i==n.LeftTop||i==n.RightBottom?o="nwse-resize":i==n.LeftBottom||i==n.RightTop?o="nesw-resize":i==n.Left||i==n.Right?o="ew-resize":i!=n.Top&&i!=n.Bottom||(o="ns-resize"));this._draggable&&!o&&this._getClosestHeader(e.target)&&(o="move");t.style.cursor=o}};Popup.prototype._mousedown=function(e){if(!e.defaultPrevented){var t=e.touches&&e.touches.length>0?e.touches[0]:e;this._edges=this._getEdges(this.hostElement,t);if(this._edges||this._draggable&&this._getClosestHeader(e.target)){var i=new wijmo_1.CancelEventArgs;if(this._edges?this.onResizing(i):this.onDragging(i)){this._mousedownEvt=t;this._rcBounds=this.hostElement.getBoundingClientRect();var o=this.addEventListener.bind(this),n=document,s=this._mousedragBnd,r=this._mouseupBnd;o(n,"mousemove",s);o(n,"touchmove",s);o(n,"mouseup",r);o(n,"touchend",r)}}this._ignoreClick=!1}};Popup.prototype._mouseup=function(){this._mousedownEvt=null;this._rcBounds=null;var e=this.removeEventListener.bind(this),t=document,i=this._mousedragBnd,o=this._mouseupBnd;e(t,"mousemove",i);e(t,"touchmove",i);e(t,"mouseup",o);e(t,"touchend",o);this._resized?this.onResized():this._dragged&&this.onDragged();this._resized=this._dragged=this._ignoreClick=!1};Popup.prototype._mousedrag=function(e){if(!e.defaultPrevented){var t=this.hostElement,i=this._mousedownEvt,o=e.touches&&e.touches.length>0?e.touches[0]:e,n=o.clientX-i.clientX,s=o.clientY-i.clientY,r=this._rcBounds,a=this._edges,l=Popup._SZ_MIN,h=wijmo_1.Rect.fromBoundingRect(r);if(a){if(a&_Edges.Left){h.left=r.left+n+(o.pageX-o.clientX);h.width=Math.max(r.width-n,l)}else if(a&_Edges.Right){h.left=r.left;h.width=Math.max(r.width+n,l)}if(a&_Edges.Top){h.top=r.top+s+(o.pageY-o.clientY);h.height=Math.max(r.height-s,l)}else if(a&_Edges.Bottom){h.top=r.top;h.height=Math.max(r.height+s,l)}if(this.onSizeChanging(new PopupBoundsChangingEventArgs(h))){wijmo_1.setCss(t,{left:h.left,top:h.top,width:h.width,height:h.height});this._resized=this._dragged=this._ignoreClick=!0;this.onSizeChanged()}if(!window.ResizeObserver)for(var u=this.hostElement.children,c=0;c<u.length;c++)wijmo_1.Control.invalidateAll(u[c])}else if(this._draggable&&(this._dragged||Math.abs(n)+Math.abs(s)>Popup._DRAG_THRESHOLD)){h.left=Math.max(r.left+n+(o.pageX-o.clientX),50-r.width);h.top=Math.max(r.top+s+(o.pageY-o.clientY),0);if(this.onPositionChanging(new PopupBoundsChangingEventArgs(h))){wijmo_1.setCss(t,{left:h.left,top:h.top});this._dragged=this._ignoreClick=!0;this.onPositionChanged()}}}};Popup.prototype._getEdges=function(e,t){var i=0;if(this._resizable){var o=e.getBoundingClientRect(),n=Popup._SZ_EDGE;t.clientX-o.left<n&&(i|=_Edges.Left);t.clientY-o.top<n&&(i|=_Edges.Top);o.right-t.clientX<n&&(i|=_Edges.Right);o.bottom-t.clientY<n&&(i|=_Edges.Bottom)}return i};Popup.prototype._ownerClick=function(e){this._toggle(e,PopupTrigger.ClickOwner)};Popup.prototype._ownerDown=function(e){this._wasVisible=this.isVisible;this._toggle(e,PopupTrigger.DownOwner)};Popup.prototype._ownerBlur=function(e){wijmo_1.contains(this._owner,wijmo_1.getActiveElement())||this._toggle(e,PopupTrigger.BlurOwner)};Popup.prototype._ownerEnter=function(e){e.target==this._owner&&this._toggle(e,PopupTrigger.EnterOwner)};Popup.prototype._ownerLeave=function(e){e.target==this._owner&&this._toggle(e,PopupTrigger.LeaveOwner)};Popup.prototype._toggle=function(e,t){var i=this;e instanceof MouseEvent&&(Popup._evtHover=e);if(!("mouseenter"==e.type&&Date.now()-this._lastShow<300||e.defaultPrevented)){var o=0!=(this._hideTrigger&t),n=0!=(this._showTrigger&t),s=PopupTrigger;(o||n)&&this._clearTimeouts();o&&this.isVisible&&(t&s.Leave?this._toHideLeave=setTimeout((function(){var e=Popup._evtHover,t=e?document.elementFromPoint(e.clientX,e.clientY):null;t&&wijmo_1.contains(i.hostElement,t,!0)||i.hide()}),wijmo_1.Control._LEAVE_DELAY):t&s.Blur?this._toHideBlur=setTimeout((function(){i.containsFocus()||wijmo_1.contains(i._owner,wijmo_1.getActiveElement())||i.hide()}),wijmo_1.Control._FOCUS_INTERVAL+50):this.hide());n&&t!=s.ClickPopup&&(this._wasVisible||(t&s.Enter?this._toShow=setTimeout((function(){i.show()}),wijmo_1.Control._HOVER_DELAY):this.show()))}};Popup.prototype._getHeaderElement=function(){var e=this.hostElement;return e.querySelector(".wj-dialog-header")||e.querySelector(".modal-header")};Popup.prototype._getClosestHeader=function(e){return wijmo_1.closest(e,".wj-dialog-header")||wijmo_1.closest(e,".modal-header")};Popup.prototype._showBackdrop=function(){var e=this;if(!this._bkDrop){this._bkDrop=document.createElement("div");this._bkDrop.tabIndex=-1;wijmo_1.addClass(this._bkDrop,"wj-popup-backdrop");this.addEventListener(this._bkDrop,"mousedown",(function(t){t.preventDefault();t.stopPropagation();e.hostElement.focus();e.hideTrigger&PopupTrigger.Blur&&e.hide()}))}wijmo_1.setCss(this._bkDrop,{zIndex:wijmo_1.Control._POPUP_ZINDEX,display:""});var t=this.hostElement;t.parentElement.insertBefore(this._bkDrop,t)};Popup.prototype._validateAndHide=function(e){var t=this.hostElement;if(t instanceof HTMLFormElement)t.reportValidity()&&this.hide(e);else{var i=this.hostElement.querySelector(":invalid");i?i.focus():this.hide(e)}};Popup._DRAG_THRESHOLD=6;Popup._SZ_EDGE=10;Popup._SZ_MIN=40;return Popup}(wijmo_1.Control);exports.Popup=Popup;var PopupBoundsChangingEventArgs=function(e){__extends(PopupBoundsChangingEventArgs,e);function PopupBoundsChangingEventArgs(t){var i=e.call(this)||this;i._rc=t;return i}Object.defineProperty(PopupBoundsChangingEventArgs.prototype,"bounds",{get:function(){return this._rc},enumerable:!0,configurable:!0});return PopupBoundsChangingEventArgs}(wijmo_1.CancelEventArgs);exports.PopupBoundsChangingEventArgs=PopupBoundsChangingEventArgs;var InputDate=function(e){__extends(InputDate,e);function InputDate(t,i){var o=e.call(this,t)||this;o._fmt="d";o._sep=" - ";o._rngs=null;o._showCal=!1;o._clsOnSel=!0;o._handleWheel=!0;o._clicked=!1;o._rangeChanged=!1;o._textInitialized=!1;o.valueChanged=new wijmo_1.Event;o.rangeEndChanged=new wijmo_1.Event;o.rangeChanged=new wijmo_1.Event;wijmo_1.addClass(o.hostElement,"wj-inputdate");o._msk=new wijmo_1._MaskProvider(o._tbx);wijmo_1.isIE9()||(o.inputType="tel");o._tbx.type.match(/^(tel|text|)$/i)||(o.inputType="text");o.addEventListener(o.hostElement,"wheel",(function(e){if(o.handleWheel&&!e.defaultPrevented&&!o.isDroppedDown&&o.containsFocus()&&null!=o.value&&o._canChangeValue()){var t=wijmo_1.clamp(-e.deltaY,-1,1),i=o.value;o.value=o.selectionMode==DateSelectionMode.Month?wijmo_1.DateTime.addMonths(i,t):wijmo_1.DateTime.addDays(i,t);o.selectAll();e.preventDefault()}}));var n=o._lbx=new ListBox(document.createElement("div"),{displayMemberPath:"name",selectedIndexChanged:function(e){var t=e.selectedItem,i=wijmo_1.DateTime.fromDateTime;if(t&&t.from&&t.to){var n=o.value;o.value=i(t.from,n);o.rangeEnd=i(t.to,n);o._selectAll()}else o._cal.hostElement.style.display=""}}),s=o._cal=new Calendar(document.createElement("div")),r=o._dropDown;wijmo_1.addClass(r,"wj-inputdate-dropdown");r.appendChild(n.hostElement);r.appendChild(s.hostElement);o.addEventListener(r,"click",(function(){o._clicked=!0;setTimeout((function(){o._clicked=!1}),50)}),!0);if("INPUT"==o._orgTag){var a=o._tbx.getAttribute("value");a&&(s.value=s.rangeEnd=wijmo_1.Globalize.parseDate(a,"yyyy-MM-dd"))}o.isRequired=!0;o._tbx.value=o._oldText=o._getText();o.initialize(i);if(o._textInitialized&&o._tbx.value!==o._oldText){o._oldText=o._tbx.value;o._commitText()}o._updateState();s.valueChanged.addHandler((function(e,t){o._refreshText();o.onValueChanged(t);o._closeOnChange()}));s.rangeEndChanged.addHandler((function(e,t){if(s._rngMode()){o.onRangeEndChanged(t);o._closeOnChange();s._clearingRangeEnd||o._refreshText()}}));s.hostElement.addEventListener("click",(function(e){if(s.selectionMode&&!s._rngMode()){var t=e.target,i=s.hitTest(t);if(wijmo_1.DateTime.sameDate(o.value,i)||wijmo_1.closest(t,"[wj-part=btn-today]")){o._closeOnChange();o._refreshText()}}}));return o}Object.defineProperty(InputDate.prototype,"value",{get:function(){return this._cal.value},set:function(e){this._cal.value=e;this._refreshText()},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"rangeEnd",{get:function(){return this._cal.rangeEnd},set:function(e){this._cal.rangeEnd=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"rangeMin",{get:function(){return this._cal.rangeMin},set:function(e){this._cal.rangeMin=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"rangeMax",{get:function(){return this._cal.rangeMax},set:function(e){this._cal.rangeMax=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"text",{get:function(){return this._tbx.value},set:function(e){var t=(e||"").toString();if(t!=this.text){t!=this._tbx.value&&(this._tbx.value=t);t!=this._oldText&&(this._oldText=t);this._commitText();this.onTextChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"format",{get:function(){return this._fmt},set:function(e){if(e!=this.format){this._fmt=wijmo_1.asString(e);this._refreshText()}},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"separator",{get:function(){return this._sep},set:function(e){if(e!=this._sep){this._sep=wijmo_1.asString(e,!1);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"mask",{get:function(){return this._msk.mask},set:function(e){this._msk.mask=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"closeOnSelection",{get:function(){return this._clsOnSel},set:function(e){this._clsOnSel=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"handleWheel",{get:function(){return this._handleWheel},set:function(e){e=wijmo_1.asBoolean(e);this._handleWheel=e;e||(this.calendar.handleWheel=e)},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"predefinedRanges",{get:function(){return this._rngs},set:function(e){if(this._rngs!=e){wijmo_1.assert(null==e||wijmo_1.isObject(e),"Object expected");this._rngs=e;this._lbx.itemsSource=this._getRanges(e);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"alwaysShowCalendar",{get:function(){return this._showCal},set:function(e){this._showCal=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"min",{get:function(){return this._cal.min},set:function(e){this._cal.min=wijmo_1.asDate(e,!0)},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"max",{get:function(){return this._cal.max},set:function(e){this._cal.max=wijmo_1.asDate(e,!0)},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"repeatButtons",{get:function(){return this._cal.repeatButtons},set:function(e){this._cal.repeatButtons=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"showYearPicker",{get:function(){return this._cal.showYearPicker},set:function(e){this._cal.showYearPicker=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"showMonthPicker",{get:function(){return this._cal.showMonthPicker},set:function(e){this._cal.showMonthPicker=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"showHeader",{get:function(){return this._cal.showHeader},set:function(e){this._cal.showHeader=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"weeksBefore",{get:function(){return this._cal.weeksBefore},set:function(e){this._cal.weeksBefore=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"weeksAfter",{get:function(){return this._cal.weeksAfter},set:function(e){this._cal.weeksAfter=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"selectionMode",{get:function(){return this._cal.selectionMode},set:function(e){if(e!=this.selectionMode){this._cal.selectionMode=e;this._refreshText();this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"monthCount",{get:function(){return this._cal.monthCount},set:function(e){this._cal.monthCount=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"calendar",{get:function(){return this._cal},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"itemValidator",{get:function(){return this._cal.itemValidator},set:function(e){if(e!=this.itemValidator){this._cal.itemValidator=wijmo_1.asFunction(e);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(InputDate.prototype,"itemFormatter",{get:function(){return this._cal.itemFormatter},set:function(e){this._cal.itemFormatter=wijmo_1.asFunction(e)},enumerable:!0,configurable:!0});InputDate.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e)};InputDate.prototype.onRangeEndChanged=function(e){this.rangeEndChanged.raise(this,e);this.rangeEnd&&(this.isDroppedDown?this._rangeChanged=!0:this.onRangeChanged(e))};InputDate.prototype.onRangeChanged=function(e){this._rangeChanged=!1;this.rangeChanged.raise(this,e)};InputDate.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);if(this.hostElement){this._msk&&this._msk.refresh();this._cal&&this._cal.refresh();this._refreshText()}};InputDate.prototype.onIsDroppedDownChanging=function(t){if(this.isDroppedDown){(o=this._cal)._rngMode()&&o.value&&!o.rangeEnd&&(o.rangeEnd=o.value)}else{var i=this._lbx,o=this._cal,n=i.collectionView,s=i.hostElement.style,r=o.hostElement.style;if(o._rngMode()&&wijmo_1.hasItems(n)){var a=this._updateRangeSelection();s.display="";r.display=!this._showCal&&a&&a.from&&n.items.some((function(e){return!e.to}))?"none":""}else{s.display="none";r.display=""}o._mthMode()||(o.monthView=!0)}return e.prototype.onIsDroppedDownChanging.call(this,t)};InputDate.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t);var i=this.containsFocus();if(this.isDroppedDown){i&&(this._tryFocus(this._cal)||this._tryFocus(this._lbx)||this.dropDown.focus());this._lbx.showSelection();this._cal.refresh()}else{this._commitText();this._rangeChanged&&this.onRangeChanged()}};InputDate.prototype._updateDropDown=function(){this._commitText();var t=getComputedStyle(this.hostElement);this._dropDown.style.minWidth=18*parseFloat(t.fontSize)+"px";this._cal.refresh();e.prototype._updateDropDown.call(this)};InputDate.prototype._keydown=function(t){if(!(t.defaultPrevented||t.altKey||t.ctrlKey||t.metaKey)){if(this._isHiddenEditor())return;switch(t.keyCode){case wijmo_1.Key.Enter:this.isDroppedDown?this._refreshText():this._commitText();break;case wijmo_1.Key.Escape:this.text=this._getText();this.selectAll();break;case wijmo_1.Key.Tab:if(this._cal._rngMode()){var i=this._tbx,o=this._sep,n=i.value,s=n.indexOf(o);if(s>-1){var r=n.length,a=i.selectionStart,l=i.selectionEnd,h=null;i.selectionEnd<=s&&!t.shiftKey?h=0==a&&0==l:t.shiftKey&&i.selectionStart>=s+o.length&&(h=a<r||l<r);if(null!=h){h?wijmo_1.setSelectionRange(i,0,s):wijmo_1.setSelectionRange(i,s+o.length,r);t.preventDefault()}}}break;case wijmo_1.Key.Up:case wijmo_1.Key.Down:if(!this.isDroppedDown&&this.value&&this._canChangeValue()){var u=t.keyCode==wijmo_1.Key.Up?1:-1,c=this.selectionMode==DateSelectionMode.Month?wijmo_1.DateTime.addMonths(this.value,u):wijmo_1.DateTime.addDays(this.value,u);this.value=this._fromDateTime(c);this.selectAll();t.preventDefault()}}}e.prototype._keydown.call(this,t)};InputDate.prototype._expandSelection=function(){if(this._cal._rngMode()){var t=this._tbx,i=t.value,o=t.selectionStart,n=t.selectionEnd,s=this._sep,r=i.indexOf(s);r>-1&&o==n&&(n<=r?wijmo_1.setSelectionRange(t,0,r):o>=r+s.length&&wijmo_1.setSelectionRange(t,r+s.length,t.value.length))}else e.prototype._expandSelection.call(this)};InputDate.prototype._refreshText=function(){var e=this._getText();if(e!=this.text){this._tbx.value=this._oldText=e;this.onTextChanged()}};InputDate.prototype._selectAll=function(){this.isDroppedDown||!this.containsFocus()||this.isTouching||this.selectAll()};InputDate.prototype._closeOnChange=function(){var e=this;if(this._clsOnSel&&this._clicked){var t=this._cal;(!t._rngMode()||t.value&&t.rangeEnd)&&setTimeout((function(){e.isDroppedDown=!1}))}};InputDate.prototype._tryFocus=function(e){var t=e.hostElement;if(t&&t.offsetHeight){t.focus();return!0}return!1};InputDate.prototype._clamp=function(e){return this._cal._clamp(e)};InputDate.prototype._getText=function(){var e=wijmo_1.Globalize.format,t=this._fmt,i=e(this.value,t);this._cal._rngMode()&&i&&(i+=this._sep+e(this.rangeEnd,t));return i};InputDate.prototype._commitText=function(e){var t=this._tbx.value;if(t!=this._getText()){var i=!1,o=this._fmt,n=this._cal,s=wijmo_1.Globalize.parseDate;if(t||this.isRequired)if(n._rngMode()){var r=t.split(this._sep);if(2==r.length&&r[0]){if(l=s(r[0],o,this.value)){var a=s(r[1],o,this.value);n.value=this._fromDateTime(l);n.rangeEnd=a&&a>=l?this._fromDateTime(a):l;i=!0}}}else{var l;if(l=s(t,o,this.value)){this.value=this._fromDateTime(l);i=!0}}else{this.value=this.rangeEnd=null;i=!0}(i||!this._containsFocus()&&this.onInvalidInput(new wijmo_1.CancelEventArgs))&&(this.text=this._getText())}e||this._selectAll()};InputDate.prototype._fromDateTime=function(e){return wijmo_1.DateTime.fromDateTime(e,this.value)};InputDate.prototype._canChangeValue=function(){return!this.isReadOnly&&!this.isDisabled&&this.selectionMode!=DateSelectionMode.None};InputDate.prototype._isValidDate=function(e){if(e){if(this._clamp(e)!=e)return!1;if(this.itemValidator&&!this.itemValidator(e))return!1}return!0};InputDate.prototype._getRanges=function(e){var t=[];if(wijmo_1.isObject(e))for(var i in e){var o=e[i];t.push({name:i,from:o?o[0]:null,to:o?o[1]:null})}return new wijmo_1.CollectionView(t,{currentItem:null})};InputDate.prototype._updateRangeSelection=function(){var e=this._lbx,t=-1;if(wijmo_1.hasItems(e.collectionView))for(var i=this._lbx.collectionView.items,o=wijmo_1.DateTime.sameDate,n=0;n<i.length;n++){var s=i[n];if(s.from){if(o(s.from,this.value)&&o(s.to,this.rangeEnd)){t=n;break}}else t=n}e.selectedIndex=t;return e.selectedItem};InputDate.prototype._copy=function(e,t){if("text"===e){var i=(t||"").toString();if(i!==this.text){this._tbx.value=i;this._textInitialized=!0}return!0}return!1};return InputDate}(DropDown);exports.InputDate=InputDate;var InputDateRange=function(e){__extends(InputDateRange,e);function InputDateRange(t,i){var o=e.call(this,t,{selectionMode:DateSelectionMode.Range,showMonthPicker:"Outside",monthCount:2})||this;wijmo_1.addClass(o.hostElement,"wj-inputdaterange");o._tbx.value=o._oldText=o._getText();o.initialize(i);if(o._tbx.value!==o._oldText){o._oldText=o._tbx.value;o._commitText()}return o}Object.defineProperty(InputDateRange.prototype,"selectionMode",{get:function(){return this.calendar.selectionMode},set:function(e){e=wijmo_1.asEnum(e,DateSelectionMode);wijmo_1.assert(e==DateSelectionMode.Range,'InputDateRange.selectionMode must be "Range"');this.calendar.selectionMode=e},enumerable:!0,configurable:!0});return InputDateRange}(InputDate);exports.InputDateRange=InputDateRange;var InputColor=function(e){__extends(InputColor,e);function InputColor(t,i){var o=e.call(this,t)||this;o.valueChanged=new wijmo_1.Event;wijmo_1.addClass(o.hostElement,"wj-inputcolor");o._ePreview=wijmo_1.createElement('<div class="wj-inputcolorbox"></div>',o.hostElement.firstElementChild);if("INPUT"==o._orgTag){o._tbx.type="";o._commitText()}o.value="#ffffff";o.isRequired=!0;o.initialize(i);o._commitText();o.addEventListener(o._colorPicker.hostElement,"click",(function(e){var t=e.target;if(t&&"DIV"==t.tagName&&(wijmo_1.closest(t,'[wj-part="div-pal"]')||wijmo_1.closest(t,'[wj-part="div-pv"]'))){t.style.backgroundColor&&(o.isDroppedDown=!1)}}));return o}Object.defineProperty(InputColor.prototype,"value",{get:function(){return this._value},set:function(e){this.text=e},enumerable:!0,configurable:!0});Object.defineProperty(InputColor.prototype,"text",{get:function(){return this._tbx.value},set:function(e){if((e=wijmo_1.asString(e))!=this.text&&(e||!this.isRequired)&&(!e||wijmo_1.Color.fromString(e))){this._setText(e,!0);this._commitText()}},enumerable:!0,configurable:!0});Object.defineProperty(InputColor.prototype,"showAlphaChannel",{get:function(){return this._colorPicker.showAlphaChannel},set:function(e){this._colorPicker.showAlphaChannel=e},enumerable:!0,configurable:!0});Object.defineProperty(InputColor.prototype,"showColorString",{get:function(){return this._colorPicker.showColorString},set:function(e){this._colorPicker.showColorString=e},enumerable:!0,configurable:!0});Object.defineProperty(InputColor.prototype,"palette",{get:function(){return this._colorPicker.palette},set:function(e){this._colorPicker.palette=e},enumerable:!0,configurable:!0});Object.defineProperty(InputColor.prototype,"colorPicker",{get:function(){return this._colorPicker},enumerable:!0,configurable:!0});InputColor.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e)};InputColor.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t);this.isDroppedDown&&!this.isTouching&&this.selectAll()};InputColor.prototype._createDropDown=function(){var e=this;this._colorPicker=new ColorPicker(this._dropDown);wijmo_1.setCss(this._dropDown,{minWidth:420,minHeight:200});this._colorPicker.valueChanged.addHandler((function(){e.value=e._colorPicker.value}))};InputColor.prototype._keydown=function(t){if(!t.defaultPrevented)switch(t.keyCode){case wijmo_1.Key.Enter:this._commitText();this.selectAll();break;case wijmo_1.Key.Escape:this.text=this.value;this.selectAll()}e.prototype._keydown.call(this,t)};InputColor.prototype._commitText=function(){if(this._value!=this.text){if(!this.isRequired&&!this.text){this._value=this.text;this._ePreview.style.backgroundColor="";this.onValueChanged();return}if(wijmo_1.Color.fromString(this.text)){var e=this._colorPicker;e.value=this.text;this._value=e.value;this._ePreview.style.backgroundColor=this.value;this.onValueChanged()}else this.onInvalidInput(new wijmo_1.CancelEventArgs)&&(this.text=this._value?this._value:"")}};InputColor.prototype._copy=function(e,t){if("text"===e){var i=(t||"").toString();i!==this.text&&(this._tbx.value=i);return!0}return!1};return InputColor}(DropDown);exports.InputColor=InputColor;var ComboBox=function(e){__extends(ComboBox,e);function ComboBox(t,i){var o=e.call(this,t)||this;o._editable=!1;o._trimText=!0;o._handleWheel=!0;o._delKey=0;o._pathHdr=new wijmo_1.Binding(null);o._bsCollapse=!0;o._fmtItemHandlers=0;o.itemsSourceChanged=new wijmo_1.Event;o.selectedIndexChanged=new wijmo_1.Event;var n=o.hostElement;wijmo_1.addClass(n,"wj-combobox");o.dropDown.id=wijmo_1.getUniqueId(n.id+"_dropdown");o.autoExpandSelection=!1;var s=o._tbx;o.addEventListener(s,"compositionstart",(function(){o._composing=!0}));o.addEventListener(s,"compositionend",(function(){o._composing=!1;o._setText(o.text,!0)}));o.addEventListener(n,"wheel",o._wheel.bind(o));"SELECT"==o._orgTag&&o._lbx._initFromSelect(n);var r=o._lbx;r.loadedItems.addHandler((function(e){o.selectedIndex>-1&&(o.selectedIndex=r.selectedIndex)}));o.isRequired=!0;o.initialize(i);return o}Object.defineProperty(ComboBox.prototype,"itemsSource",{get:function(){return this._lbx.itemsSource},set:function(e){if(this._lbx.itemsSource!=e){this._lbx.itemsSource=e;this.onItemsSourceChanged()}this._updateBtn()},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"collectionView",{get:function(){return this._lbx.collectionView},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"virtualizationThreshold",{get:function(){return this._lbx.virtualizationThreshold},set:function(e){this._lbx.virtualizationThreshold=e},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"showGroups",{get:function(){return this._lbx.showGroups},set:function(e){this._lbx.showGroups=e},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"displayMemberPath",{get:function(){return this._lbx.displayMemberPath},set:function(e){this._lbx.displayMemberPath=e;var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"headerPath",{get:function(){return this._pathHdr.path},set:function(e){this._pathHdr.path=wijmo_1.asString(e);var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"selectedValuePath",{get:function(){return this._lbx.selectedValuePath},set:function(e){this._lbx.selectedValuePath=e},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"isContentHtml",{get:function(){return this._lbx.isContentHtml},set:function(e){if(e!=this.isContentHtml){this._lbx.isContentHtml=wijmo_1.asBoolean(e);var t=this.getDisplayText();this.text!=t&&this._setText(t,!0)}},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"caseSensitiveSearch",{get:function(){return this._lbx.caseSensitiveSearch},set:function(e){this._lbx.caseSensitiveSearch=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"trimText",{get:function(){return this._trimText},set:function(e){if(e!=this._trimText){this._trimText=wijmo_1.asBoolean(e);this.invalidate()}},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"itemFormatter",{get:function(){return this._lbx.itemFormatter},set:function(e){this._lbx.itemFormatter=wijmo_1.asFunction(e);this.selectedIndex=this._lbx.selectedIndex},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"formatItem",{get:function(){return this._lbx.formatItem},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"selectedIndex",{get:function(){return this._lbx.selectedIndex},set:function(e){e!=this.selectedIndex&&wijmo_1.isNumber(e)&&(this._lbx.selectedIndex=e);e=this.selectedIndex;var t=this.getDisplayText(e);if(this.text!=t){var i=this._internalSettingText;this._internalSettingText=this._lbx._ignoredItemChangedEvents;this._setText(t,!0);this._internalSettingText=i}},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"selectedItem",{get:function(){return this._lbx.selectedItem},set:function(e){this._lbx.selectedItem=e},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"selectedValue",{get:function(){return this.collectionView?this._lbx.selectedValue:this.text},set:function(e){this.collectionView?this._lbx.selectedValue=e:null!=e&&(this.text=e.toString())},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"isEditable",{get:function(){return this._editable},set:function(e){this._editable=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"handleWheel",{get:function(){return this._handleWheel},set:function(e){this._handleWheel=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"maxDropDownHeight",{get:function(){return this._lbx.maxHeight},set:function(e){this._lbx.maxHeight=e},enumerable:!0,configurable:!0});Object.defineProperty(ComboBox.prototype,"maxDropDownWidth",{get:function(){var e=this._dropDown,t=e?parseInt(e.style.maxWidth):null;return isNaN(t)?null:t},set:function(e){var t=this._dropDown.style;e=wijmo_1.asNumber(e,!0);t.maxWidth=null==e?"":e+"px";t.minWidth=""},enumerable:!0,configurable:!0});ComboBox.prototype.getDisplayText=function(e,t){void 0===e&&(e=this.selectedIndex);void 0===t&&(t=this._trimText);var i,o=this.collectionView;if(this.headerPath&&e>-1&&wijmo_1.hasItems(o)){var n=o.items[e];i=null!=(i=n?this._pathHdr.getValue(n):null)?i.toString():"";this.isContentHtml&&(i=wijmo_1.toPlainText(i))}else i=this._lbx.getDisplayText(e);return t?i.trim():i};ComboBox.prototype.indexOf=function(e,t){var i=this.collectionView,o=this.caseSensitiveSearch;if(wijmo_1.hasItems(i)&&null!=e){e=e.toString();o||(e=e.toLowerCase());this._trimText&&(e=e.trim());var n=this.selectedIndex,s=this.getDisplayText(n);if(t){o||(s=s.toLowerCase());if(e==s)return n}else if(!e&&""==s)return n;for(var r=0;r<i.items.length;r++)if(this._lbx.isItemEnabled(r)){s=this.getDisplayText(r);o||(s=s.toLowerCase());if(t){if(s==e)return r}else if(e&&0==s.indexOf(e)||!e&&""==s)return r}}return-1};Object.defineProperty(ComboBox.prototype,"listBox",{get:function(){return this._lbx},enumerable:!0,configurable:!0});ComboBox.prototype.onItemsSourceChanged=function(e){this.itemsSourceChanged.raise(this,e)};ComboBox.prototype.onSelectedIndexChanged=function(e){this._updateBtn();this.selectedIndexChanged.raise(this,e)};ComboBox.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);if(this.hostElement&&wijmo_1.hasItems(this.collectionView)){this._lbx.refresh();this.selectedIndex>-1&&(this.selectedIndex=this._lbx.selectedIndex)}};ComboBox.prototype.onLostFocus=function(t){if(this._composing){this._composing=!1;this._setText(this.text,!0)}this.isEditable&&this.isRequired&&!this.text&&wijmo_1.hasItems(this.collectionView)&&(this.selectedIndex=0);e.prototype.onLostFocus.call(this,t)};ComboBox.prototype.onIsDroppedDownChanging=function(t){if(!this.isDroppedDown&&!this._hasItems()){t.cancel=!0;return!1}return e.prototype.onIsDroppedDownChanging.call(this,t)};ComboBox.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t);if(this.isDroppedDown){this._fmtItemHandlers=this.formatItem.handlerCount;this._lbx.showSelection()}this._updateAria()};ComboBox.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t);this._updateBtn()};ComboBox.prototype._updateBtn=function(){var t=this.collectionView,i=this._tbx,o=this._hasItems();e.prototype._updateBtn.call(this);this._btn.style.display=this._showBtn&&null!=t?"":"none";wijmo_1.enable(this._btn,o&&!this.isDisabled);wijmo_1.setAttribute(i,"role",o?"combobox":null);wijmo_1.setAttribute(i,"aria-autocomplete",o?"both":null);this._updateAria()};ComboBox.prototype._hasItems=function(){return wijmo_1.hasItems(this.collectionView)};ComboBox.prototype._updateAria=function(){var e=this._tbx,t=this.isDroppedDown,i=this.dropDown?this.dropDown.id:null,o=i&&wijmo_1.hasItems(this.collectionView);wijmo_1.setAttribute(e,"aria-owns",o&&t?i:null);wijmo_1.setAttribute(e,"aria-expanded",o?t:null)};ComboBox.prototype._createDropDown=function(){var e=this;if(!this._lbx){this._lbx=new ListBox(this._dropDown);this._lbx._container=this.hostElement}this._lbx.maxHeight=200;this._lbx.selectedIndexChanged.addHandler((function(){e._updateBtn();var t=e._lbx.selectedIndex,i=e._lbx.hostElement.children,o=t>-1&&t<i.length?i[t].id:null;wijmo_1.setAttribute(e._tbx,"aria-activedescendant",o&&o.length?o:null);e.selectedIndex=t;e.onSelectedIndexChanged()}));this._lbx.itemsChanged.addHandler((function(){e._updateBtn()}))};ComboBox.prototype._wheel=function(e){if(this.handleWheel&&!e.defaultPrevented&&!this.isDroppedDown&&!this.isReadOnly&&this.containsFocus()&&this.selectedIndex>-1){var t=this._findNext("",e.deltaY>0?1:-1);t>-1&&(this.selectedIndex=t);e.preventDefault()}};ComboBox.prototype._dropDownClick=function(t){t.defaultPrevented||t.target!=this._dropDown&&(this.isDroppedDown=!1);e.prototype._dropDownClick.call(this,t)};ComboBox.prototype._setText=function(t,i){if(!this._composing&&!this._settingText){this._settingText=!0;if(this.containsFocus()){var o=this.formatItem.handlerCount;if(this._fmtItemHandlers!=o){this._fmtItemHandlers=o;this._lbx.loadList()}}null==t&&(t="");t=t.toString();var n=this.selectedIndex,s=this.collectionView,r=this._getSelStart(),a=-1,l=!0;if(this.isEditable&&(this._delKey||this._getSelEnd()<t.length||!this.containsFocus())){i=!0;l=!1}n=this.indexOf(t,i);if(l){n<0&&i&&(n=this.indexOf(t,!1));n<0&&r>0&&(n=this.indexOf(t.substr(0,r),!1))}if(n<0&&!this.isEditable&&wijmo_1.hasItems(s)&&(this.isRequired||t)){var h=this._oldText||"";n=Math.max(0,this.indexOf(h,!1));r=0;for(var u=0;u<t.length&&u<h.length;u++)if(t[u]!=h[u]){r=u;break}}if(n>-1){a=r;t=this.getDisplayText(n)}var c=this._tbx;t!=c.value&&(c.value=t);a>-1&&this.containsFocus()&&!this.isTouching&&this._updateInputSelection(a);s&&s.moveCurrentToPosition(n);this._delKey=0;this._settingText=!1;e.prototype._setText.call(this,t,i)}};ComboBox.prototype._findNext=function(e,t,i){void 0===i&&(i=this.selectedIndex);var o=this.collectionView,n=o?o.items.length:0,s=this._lbx,r=this.caseSensitiveSearch;if(o&&n&&t){r||(e=e.toLowerCase());for(var a=i+t;a>-1&&a<n;a+=t){var l=this.getDisplayText(a);r||(l=l.toLowerCase());if(0==l.indexOf(e)){if(!this.dropDown.children[a]||s.isItemEnabled(a))return a}}}return i};ComboBox.prototype._keydown=function(t){e.prototype._keydown.call(this,t);if(!t.defaultPrevented&&!this.isReadOnly&&!t.altKey&&wijmo_1.hasItems(this.collectionView)&&this._elRef==this._tbx&&!this._isHiddenEditor()){this._delKey=0;var i=this._getSelStart();switch(t.keyCode){case wijmo_1.Key.Back:if(this._bsCollapse&&!this.isEditable){var o=this._getSelEnd();i>0&&o==this._tbx.value.length&&wijmo_1.hasItems(this.collectionView)&&this._setSelRange(i-1,o)}this._delKey=t.keyCode;break;case wijmo_1.Key.Delete:this._delKey=t.keyCode;break;case wijmo_1.Key.Up:case wijmo_1.Key.Down:i==this.text.length&&(i=0);this.selectedIndex=this._findNext(this.text.substr(0,i),t.keyCode==wijmo_1.Key.Up?-1:1);this._setSelRange(i,this.text.length);t.preventDefault();break;case wijmo_1.Key.PageUp:this._lbx._selectPrevPage();this.selectAll();t.preventDefault();break;case wijmo_1.Key.PageDown:this._lbx._selectNextPage();this.selectAll();t.preventDefault()}}};ComboBox.prototype._updateInputSelection=function(e){var t=this._tbx;this._elRef==t&&this._setSelRange(e,t.value.length)};ComboBox.prototype._getSelStart=function(){var e=this._tbx;return e&&e.value?e.selectionStart:0};ComboBox.prototype._getSelEnd=function(){var e=this._tbx;return e&&e.value?e.selectionEnd:0};ComboBox.prototype._setSelRange=function(e,t){var i=this._tbx;this._elRef!=i||i.readOnly||wijmo_1.setSelectionRange(i,e,t)};return ComboBox}(DropDown);exports.ComboBox=ComboBox;wijmo_1._addCultureInfo("MultiSelect",{itemsSelected:"{count:n0} items selected",selectAll:"Select All"});var MultiSelect=function(e){__extends(MultiSelect,e);function MultiSelect(t,i){var o=e.call(this,t)||this;o._maxHdrItems=2;o._readOnly=!1;o._hdrFmt=null;o.checkedItemsChanged=new wijmo_1.Event;wijmo_1.addClass(o.hostElement,"wj-multiselect");o._tbx.readOnly=!0;o.checkedMemberPath=null;o.removeEventListener(o.dropDown,"click");o._lbx.itemsChanged.addHandler((function(){o._updateHeader(!1)}));o._lbx.checkedItemsChanged.addHandler((function(){o._updateHeader(!1);o.onCheckedItemsChanged()}));o.clickAction=ClickAction.Toggle;o.initialize(i);return o}Object.defineProperty(MultiSelect.prototype,"showSelectAllCheckbox",{get:function(){return this._msLbx.showSelectAllCheckbox},set:function(e){this._msLbx.showSelectAllCheckbox=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"showFilterInput",{get:function(){return this._msLbx.showFilterInput},set:function(e){this._msLbx.showFilterInput=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"delay",{get:function(){return this._msLbx.delay},set:function(e){this._msLbx.delay=e},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"caseSensitiveSearch",{get:function(){return this._msLbx.caseSensitiveSearch},set:function(e){this._msLbx.caseSensitiveSearch=e},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"filterInputPlaceholder",{get:function(){return this._msLbx.filterInputPlaceholder},set:function(e){this._msLbx.filterInputPlaceholder=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"checkOnFilter",{get:function(){return this._msLbx.checkOnFilter},set:function(e){if(e!=this.checkOnFilter){this._msLbx.checkOnFilter=wijmo_1.asBoolean(e);this.checkedItems=[]}},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"selectAllLabel",{get:function(){return this._msLbx.selectAllLabel},set:function(e){this._msLbx.selectAllLabel=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"checkedMemberPath",{get:function(){return this._msLbx.checkedMemberPath},set:function(e){this._msLbx.checkedMemberPath=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"maxHeaderItems",{get:function(){return this._maxHdrItems},set:function(e){if(this._maxHdrItems!=e){this._maxHdrItems=wijmo_1.asNumber(e);this._updateHeader()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"headerFormat",{get:function(){return this._hdrFmt},set:function(e){if(e!=this._hdrFmt){this._hdrFmt=wijmo_1.asString(e);this._updateHeader()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"headerFormatter",{get:function(){return this._hdrFormatter},set:function(e){if(e!=this._hdrFormatter){this._hdrFormatter=wijmo_1.asFunction(e);this._updateHeader()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiSelect.prototype,"checkedItems",{get:function(){return this._msLbx.checkedItems},set:function(e){this._msLbx.checkedItems=null==e?[]:wijmo_1.asArray(e);this._updateHeader()},enumerable:!0,configurable:!0});MultiSelect.prototype.onCheckedItemsChanged=function(e){this.checkedItemsChanged.raise(this,e)};MultiSelect.prototype.dispose=function(){this._lbx.dispose();e.prototype.dispose.call(this)};MultiSelect.prototype.onIsDroppedDownChanged=function(t){var i=this;e.prototype.onIsDroppedDownChanged.call(this,t);setTimeout((function(){if(i.isDroppedDown&&i.containsFocus())if(i.showFilterInput&&!i.isTouching)i._msLbx._filter.focus();else{var e=i.listBox;if(e.selectedIndex<0){var t=0,o=e.checkedItems;o.length&&(t=e.collectionView.items.indexOf(o[0]));e.selectedIndex=Math.max(0,t)}e.showSelection(!0);e.focus()}}))};MultiSelect.prototype._createDropDown=function(){var t=wijmo_1.createElement("<div></div>",this._dropDown);this._msLbx=new MultiSelectListBox(t);this._lbx=this._msLbx.listBox;e.prototype._createDropDown.call(this)};Object.defineProperty(MultiSelect.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(e){this._readOnly=wijmo_1.asBoolean(e);wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0});MultiSelect.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);this.hostElement&&this._updateHeader()};MultiSelect.prototype._setText=function(e,t){};MultiSelect.prototype._keydown=function(t){e.prototype._keydown.call(this,t);wijmo_1.hasClass(this._tbx,"wj-grid-ime")||!t.defaultPrevented&&wijmo_1.hasItems(this.collectionView)&&t.keyCode>32&&(this.isDroppedDown=!0)};MultiSelect.prototype._hasItems=function(){var e=this.collectionView,t=e?e.sourceCollection:null;return wijmo_1.hasItems(e)||t&&t.length&&this.showFilterInput};MultiSelect.prototype._updateHeader=function(e){void 0===e&&(e=!0);var t="";if(wijmo_1.isFunction(this._hdrFormatter))t=this._hdrFormatter(this);else{var i=this.checkedItems;if(i.length>0)if(i.length<=this._maxHdrItems){if(this.headerPath){var o=new wijmo_1.Binding(this.headerPath);i=i.map((function(e){return o.getValue(e)}))}else if(this.displayMemberPath){var n=new wijmo_1.Binding(this.displayMemberPath);i=i.map((function(e){return n.getValue(e)}))}this.isContentHtml&&(i=i.map((function(e){return wijmo_1.toPlainText(e)})));this.trimText&&(i=i.map((function(e){return e?e.toString().trim():""})));t=i.join(", ")}else t=wijmo_1.format(this.headerFormat||wijmo_1.culture.MultiSelect.itemsSelected,{count:i.length})}var s=this.inputElement;if(t!=s.value){s.value=t;this.onTextChanged()}e&&this._lbx._updateCheckedList(this.checkedItems);this._updateState()};MultiSelect._DEF_CHECKED_PATH="$checked";return MultiSelect}(ComboBox);exports.MultiSelect=MultiSelect;var Menu=function(e){__extends(Menu,e);function Menu(t,i){var o=e.call(this,t)||this;o._closing=!1;o._cmd=null;o._cmdPath=null;o._cmdParamPath=null;o._subPath=null;o._owner=null;o._isButton=!1;o._openOnHover=!1;o._closeOnLeave=!0;o._subMenu=null;o._hoverEnterBnd=o._hoverEnter.bind(o);o._hoverLeaveBnd=o._hoverLeave.bind(o);o._hoverOverBnd=o._hoverOver.bind(o);o.itemClicked=new wijmo_1.Event;var n=o.hostElement,s=o._tbx,r=o._lbx,a=o.dropDown;wijmo_1.addClass(n,"wj-menu");s.style.display="none";o._hdr=o._elRef=wijmo_1.createElement('<div wj-part="header" class="wj-form-control"/>');s.parentElement.insertBefore(o._hdr,o._tbx);n.tabIndex=o.isDisabled?-1:o._orgTabIndex;o.isRequired=!1;wijmo_1.setAttribute(n,"role","menubar",!0);wijmo_1.setAttribute(s,"role",null);wijmo_1.setAttribute(s,"aria-autocomplete",null);wijmo_1.setAttribute(s,"aria-owns",null);wijmo_1.setAttribute(a,"role","menu");r.itemRole="menuitem";if("SELECT"==o._orgTag){o.header=n.getAttribute("header");o._lbx.itemsSource&&(o.commandParameterPath="cmdParam")}o.isContentHtml=!0;o.maxDropDownHeight=500;o.addEventListener(o._hdr,"click",(function(e){if(!e.defaultPrevented){o._clearHover(e);if(o._isButton){o.isDroppedDown=!1;o._raiseCommand()}else o.isDroppedDown=!o.isDroppedDown}}));r.lostFocus.addHandler((function(){o.containsFocus()||(o.isDroppedDown=!1)}));wijmo_1.addClass(a,"wj-menu-items");r.formatItem.addHandler(o._formatMenuItem.bind(o));o.initialize(i);return o}Object.defineProperty(Menu.prototype,"header",{get:function(){return this._hdr.innerHTML},set:function(e){this._hdr.innerHTML=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(Menu.prototype,"command",{get:function(){return this._cmd},set:function(e){this._cmd=e},enumerable:!0,configurable:!0});Object.defineProperty(Menu.prototype,"commandPath",{get:function(){return this._cmdPath},set:function(e){this._cmdPath=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(Menu.prototype,"commandParameterPath",{get:function(){return this._cmdParamPath},set:function(e){this._cmdParamPath=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(Menu.prototype,"subItemsPath",{get:function(){return this._subPath},set:function(e){if(e!=this._subPath){this._subPath=e;this.refresh(!0)}},enumerable:!0,configurable:!0});Object.defineProperty(Menu.prototype,"openOnHover",{get:function(){return this._openOnHover},set:function(e){this._openOnHover=wijmo_1.asBoolean(e);this._updateHoverEvents()},enumerable:!0,configurable:!0});Object.defineProperty(Menu.prototype,"closeOnLeave",{get:function(){return this._closeOnLeave},set:function(e){this._closeOnLeave=wijmo_1.asBoolean(e);this._updateHoverEvents()},enumerable:!0,configurable:!0});Object.defineProperty(Menu.prototype,"isButton",{get:function(){return this._isButton},set:function(e){this._isButton=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(Menu.prototype,"owner",{get:function(){return this._owner},set:function(e){this._owner=wijmo_1.asType(e,HTMLElement,!0);this._enableDisableItems()},enumerable:!0,configurable:!0});Menu.prototype.show=function(e){if(!this.isDroppedDown){this.selectedIndex=-1;if(this.onIsDroppedDownChanging(new wijmo_1.CancelEventArgs)){var t=this.dropDown,i=this.owner;!i&&e instanceof MouseEvent&&(i=e.target);i instanceof HTMLElement&&(t[wijmo_1.Control._OWNR_KEY]=i);if(e instanceof MouseEvent&&this.openOnHover&&this.closeOnLeave){e=new wijmo_1.Point(e.pageX-pageXOffset-2,e.pageY-pageYOffset-2)}wijmo_1.showPopup(t,e,!1,this.isAnimated);this.onIsDroppedDownChanged();t.focus()}}};Menu.prototype.hide=function(){if(this.isDroppedDown&&this.onIsDroppedDownChanging(new wijmo_1.CancelEventArgs)){wijmo_1.hidePopup(this.dropDown);this.onIsDroppedDownChanged()}};Menu.prototype.onItemClicked=function(e){this.itemClicked.raise(this,e)};Menu.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);this.hostElement&&this._enableDisableItems()};Menu.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t);if(this.isDroppedDown){this._closing=!0;var i=this._lbx._ignoredItemChangedEvents;this._lbx._ignoredItemChangedEvents=!0;this._defaultItem=this.selectedItem;this.isRequired=!1;this.selectedIndex=-1;this._enableDisableItems();this._closing=!1;this._lbx._ignoredItemChangedEvents=i;this.dropDown.focus()}else{if(!this.selectedItem){var o=this._lbx._checking;this._lbx._checking=!0;this.selectedItem=this._defaultItem;this._lbx._checking=o}var n=this._subMenu;n&&(n.isDroppedDown=!1)}};Menu.prototype._updateHoverEvents=function(){var e=this.hostElement,t=this.dropDown,i=this.addEventListener.bind(this),o=this.removeEventListener.bind(this),n="mouseleave";o(e,"mouseenter",this._hoverEnterBnd);o(e,n,this._hoverLeaveBnd);o(t,"mouseover",this._hoverOverBnd);o(t,n,this._hoverLeaveBnd);if(this._openOnHover){i(e,"mouseenter",this._hoverEnterBnd);i(t,"mouseover",this._hoverOverBnd);if(this._closeOnLeave){i(e,n,this._hoverLeaveBnd);i(t,n,this._hoverLeaveBnd)}}};Menu.prototype._getSubItems=function(e){var t=this.subItemsPath,i=e&&t?e[t]:null;return wijmo_1.isArray(i)&&i.length?i:null};Menu.prototype._formatMenuItem=function(e,t){var i=t.item;if(this._getSubItems(t.data))wijmo_1.addClass(i,"wj-subitems");else if("-"==i.innerHTML){i.innerHTML="";wijmo_1.addClass(i,"wj-separator")}};Menu.prototype._keydown=function(t){if(!t.defaultPrevented){var i=this._getKeyCode(t);if(this.isDroppedDown)switch(i){case wijmo_1.Key.Enter:case wijmo_1.Key.Right:if(this._showSubMenu()){t.preventDefault();return}break;case wijmo_1.Key.Left:var o=wijmo_1.Control.getControl(this.owner);if(o instanceof Menu){var n=o.dropDown,s=o.selectedIndex;(s>-1?n.children[s]:n).focus();t.preventDefault();return}}if(i==wijmo_1.Key.Enter)if(this.isDroppedDown)this.selectedIndex>-1&&this._raiseCommand();else{this.isDroppedDown=!0;t.preventDefault()}}e.prototype._keydown.call(this,t)};Menu.prototype._dropDownClick=function(t){if(!t.defaultPrevented&&t.target!=this.dropDown){this._clearHover(t);if(this._showSubMenu()){t.preventDefault();return}this.selectedIndex>-1&&this._raiseCommand()}e.prototype._dropDownClick.call(this,t)};Menu.prototype._showSubMenu=function(){var e=this,t=this._getSubItems(this.selectedItem);if(!t)return null;var i=this.dropDown.children[this.selectedIndex].getBoundingClientRect(),o=new wijmo_1.Point(i.right,i.top);if(0==i.height)return null;var n=this.rightToLeft||"rtl"==this.dropDown.getAttribute("dir");n&&(o.x=i.left);var s=this._subMenu;s&&(s.isDroppedDown=!1);s=new Menu(document.createElement("div"),{owner:this.hostElement,itemsSource:t,itemClicked:function(t,i){e.itemClicked.raise(t,i)},formatItem:function(t,i){e.formatItem.raise(t,i)}});var r=this.collectionView,a=s.collectionView;r&&r.filter&&a&&!a.filter&&(a.filter=r.filter);"displayMemberPath,selectedValuePath,isContentHtml,command,commandPath,commandParameterPath,maxDropDownWidth,maxDropDownHeight,dropDownCssClass,isAnimated,subItemsPath,openOnHover,closeOnLeave".split(",").forEach((function(t){s[t]=e[t]}));var l=s.dropDown;wijmo_1.setAttribute(l,"dir",n?"rtl":null);s.show(o);l[wijmo_1.Control._OWNR_KEY]=this.dropDown;l.focus();return s};Menu.prototype._raiseCommand=function(e){var t=this.selectedItem,i=this._getSubItems(t),o=this._getCommand(t);if(o&&!i){var n=this._getCommandParm(t);if(!this._canExecuteCommand(o,n))return;this._executeCommand(o,n)}var s=this.headerPath;if(s){var r=new wijmo_1.Binding(s).getValue(t);r=null==r?"":r.toString();this.header=this.isContentHtml?r:wijmo_1.escapeHtml(r)}this.onItemClicked(e);if(this.containsFocus()){for(var a=this;a&&a.owner;){var l=wijmo_1.Control.getControl(a.owner);if(!(l instanceof Menu))break;a=l}var h=a.owner;!h&&a.dropDown&&(h=a.dropDown[wijmo_1.Control._OWNR_KEY]);a.isDroppedDown=!1;a.focus();if(!a.containsFocus()&&h instanceof HTMLElement&&h.offsetHeight)if(wijmo_1.isIE){var u=document.documentElement,c=u.scrollLeft,p=u.scrollTop;h.focus();u.scrollLeft=c,u.scrollTop=p}else h.focus()}};Menu.prototype._getCommand=function(e){var t=e&&this._cmdPath?e[this._cmdPath]:null;return t||this._cmd};Menu.prototype._getCommandParm=function(e){var t=this._cmdParamPath;return e&&t?e[t]:e};Menu.prototype._executeCommand=function(e,t){e&&!wijmo_1.isFunction(e)&&(e=e.executeCommand);wijmo_1.isFunction(e)&&e(t)};Menu.prototype._canExecuteCommand=function(e,t){if(e){var i=e.canExecuteCommand;if(wijmo_1.isFunction(i))return i(t)}return!0};Menu.prototype._enableDisableItems=function(){if(this.collectionView&&(this._cmd||this._cmdPath))for(var e=this.collectionView.items,t=0;t<e.length;t++){var i=e[t],o=this._getCommand(i);if(o){var n=this._lbx.hostElement.children[t],s=this._getCommandParm(i);wijmo_1.toggleClass(n,"wj-state-disabled",!this._canExecuteCommand(o,s))}}};Menu.prototype._clearHover=function(e){this._toHover&&clearTimeout(this._toHover);this._toHover=null;Menu._evtHover=e};Menu.prototype._isTargetDisabled=function(e){return wijmo_1.hasClass(e.target,"wj-state-disabled")};Menu.prototype._hoverEnter=function(e){var t=this;this._clearHover(e);this._toHover=setTimeout((function(){t._toHover=null;t.isDroppedDown=!0}),wijmo_1.Control._HOVER_DELAY)};Menu.prototype._hoverOver=function(e){var t=this;this._clearHover(e);this._toHover=setTimeout((function(){t._toHover=null;var i=t.listBox.indexOf(e.target);if(i>-1&&!wijmo_1.hasClass(e.target,"wj-state-disabled")){t.selectedIndex=i;t._subMenu=t._showSubMenu()}}),wijmo_1.Control._HOVER_DELAY)};Menu.prototype._hoverLeave=function(e){var t=this;this._clearHover(e);this.isDroppedDown&&(this._toHover=setTimeout((function(){var i=(e=Menu._evtHover)?document.elementFromPoint(e.clientX,e.clientY):null,o=wijmo_1.closest(i,".wj-listbox.wj-menu-items"),n=t._subMenu;if(!o&&!wijmo_1.contains(t.hostElement,i,!0)){t.isDroppedDown=!1;n&&(n.isDroppedDown=!1)}}),wijmo_1.Control._LEAVE_DELAY))};Menu.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t);this.hostElement.tabIndex=this.isDisabled?-1:this._orgTabIndex};Menu.prototype._setTabOrder=function(t){e.prototype._setTabOrder.call(this,t);this.hostElement.tabIndex=this.isDisabled?-1:this._orgTabIndex};return Menu}(ComboBox);exports.Menu=Menu;var InputTime=function(e){__extends(InputTime,e);function InputTime(t,i){var o=e.call(this,t)||this;o._format="t";o.valueChanged=new wijmo_1.Event;wijmo_1.addClass(o.hostElement,"wj-inputtime");o.isEditable=!0;o._value=wijmo_1.DateTime.newDate();o._min=o._max=null;o._msk=new wijmo_1._MaskProvider(o._tbx);wijmo_1.isIE9()||(o._tbx.type="tel");if("INPUT"==o._orgTag){var n=o._tbx.getAttribute("value");n&&(o.value=wijmo_1.Globalize.parseDate(n,"HH:mm:ss"))}o.step=15;o.autoExpandSelection=!0;o.initialize(i);o._commitText();return o}Object.defineProperty(InputTime.prototype,"inputElement",{get:function(){return this._tbx},enumerable:!0,configurable:!0});Object.defineProperty(InputTime.prototype,"inputType",{get:function(){return this._tbx.type},set:function(e){this._tbx.type=wijmo_1.asString(e)},enumerable:!0,configurable:!0});Object.defineProperty(InputTime.prototype,"value",{get:function(){return this._value},set:function(e){(e=wijmo_1.asDate(e,!this.isRequired))&&(e=this._clamp(e));this._setText(e?wijmo_1.Globalize.format(e,this.format):"",!0);this.selectedItem&&this.selectedItem.value&&(e=wijmo_1.DateTime.fromDateTime(e,this.selectedItem.value));if(e!=this._value&&!wijmo_1.DateTime.equals(e,this._value)){this._value=e;this.onValueChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(InputTime.prototype,"text",{get:function(){return this._tbx.value},set:function(e){if(e!=this.text){this._setText(e,!0);this._commitText()}},enumerable:!0,configurable:!0});Object.defineProperty(InputTime.prototype,"min",{get:function(){return this._min},set:function(e){this._min=wijmo_1.asDate(e,!0);this.isDroppedDown=!1;this._updateItems()},enumerable:!0,configurable:!0});Object.defineProperty(InputTime.prototype,"max",{get:function(){return this._max},set:function(e){this._max=wijmo_1.asDate(e,!0);this.isDroppedDown=!1;this._updateItems()},enumerable:!0,configurable:!0});Object.defineProperty(InputTime.prototype,"step",{get:function(){return this._step},set:function(e){if(e!=this.step){this._step=wijmo_1.asNumber(e,!0);this.isDroppedDown=!1;this._updateItems()}},enumerable:!0,configurable:!0});Object.defineProperty(InputTime.prototype,"format",{get:function(){return this._format},set:function(e){if(e!=this.format){this._format=wijmo_1.asString(e);this._tbx.value=wijmo_1.Globalize.format(this.value,this.format);wijmo_1.hasItems(this.collectionView)&&this._updateItems()}},enumerable:!0,configurable:!0});Object.defineProperty(InputTime.prototype,"mask",{get:function(){return this._msk.mask},set:function(e){this._msk.mask=wijmo_1.asString(e)},enumerable:!0,configurable:!0});InputTime.prototype.onValueChanged=function(e){this.valueChanged.raise(this,e)};InputTime.prototype.onItemsSourceChanged=function(t){e.prototype.onItemsSourceChanged.call(this,t);this._hasCustomItems=null!=this.itemsSource};InputTime.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);if(this.hostElement){this._msk.refresh();this._tbx.value=wijmo_1.Globalize.format(this.value,this.format);this._updateItems()}};InputTime.prototype.onSelectedIndexChanged=function(t){if(this.selectedIndex>-1&&!this._settingText){var i=this.value?this.value:wijmo_1.DateTime.newDate(),o=null!=this.selectedItem.value?this.selectedItem.value:wijmo_1.Globalize.parseDate(this.text,this.format,this.value);this.value=wijmo_1.DateTime.fromDateTime(i,o)}e.prototype.onSelectedIndexChanged.call(this,t)};InputTime.prototype._clamp=function(e){null!=this._min&&this._getTime(e)<this._getTime(this._min)&&(e=wijmo_1.DateTime.fromDateTime(e,this._min));null!=this._max&&this._getTime(e)>this._getTime(this._max)&&(e=wijmo_1.DateTime.fromDateTime(e,this._max));return e};InputTime.prototype._wheel=function(t){if(!t.defaultPrevented&&!this.isDroppedDown&&!this.isReadOnly&&this.containsFocus()&&this.selectedIndex<0&&this.value&&wijmo_1.isNumber(this.step)&&this.step>0){var i=wijmo_1.DateTime.addMinutes(this.value,this.step*wijmo_1.clamp(t.deltaY,-1,1));this.value=this._clamp(i);this.selectAll();t.preventDefault()}e.prototype._wheel.call(this,t)};InputTime.prototype._updateInputSelection=function(t){if(this._delKey)e.prototype._updateInputSelection.call(this,t);else{for(var i=this._tbx.value;t<i.length&&!i[t].match(/[a-z0-9]/i);)t++;wijmo_1.setSelectionRange(this._tbx,t,this._tbx.value.length)}};InputTime.prototype._updateItems=function(){if(!this._hasCustomItems){var e=[],t=new Date(2020,0),i=new Date(2020,0,1,23,59,59),o=this.step;this.min&&t.setHours(this.min.getHours(),this.min.getMinutes(),this.min.getSeconds());this.max&&i.setHours(this.max.getHours(),this.max.getMinutes(),this.max.getSeconds());if(wijmo_1.isNumber(o)&&o>=1)for(var n=t;n<=i;n=wijmo_1.DateTime.addMinutes(n,o))e.push({value:n,text:wijmo_1.Globalize.format(n,this.format)});var s=this.value;this._settingText=!0;this.displayMemberPath="text";this.selectedValuePath="text";this.itemsSource=e;this._hasCustomItems=!1;this._settingText=!1;!s&&this.isRequired||(this.value=s)}};InputTime.prototype._getTime=function(e){return 3600*e.getHours()+60*e.getMinutes()+e.getSeconds()};InputTime.prototype._keydown=function(t){e.prototype._keydown.call(this,t);if(!t.defaultPrevented)switch(t.keyCode){case wijmo_1.Key.Enter:if(!this.isDroppedDown){this._commitText();this.selectAll()}break;case wijmo_1.Key.Escape:this.text=wijmo_1.Globalize.format(this.value,this.format);this.selectAll()}};InputTime.prototype._commitText=function(){if(this.text||this.isRequired){var e=this.value?wijmo_1.Globalize.format(this.value,this.format):"";if(this.text!=e){var t=this.selectedItem&&this.selectedItem.value?this.selectedItem.value:wijmo_1.Globalize.parseDate(this.text,this.format,this.value);t?(wijmo_1.DateTime.sameTime(t,this._clamp(t))||this.onInvalidInput(new wijmo_1.CancelEventArgs))&&(this.value=wijmo_1.DateTime.fromDateTime(this.value,t)):this.onInvalidInput(new wijmo_1.CancelEventArgs)&&(this.text=e)}}else this.value=null};InputTime.prototype._copy=function(e,t){if("text"===e){(t||"").toString()!==this.text&&this._setText(t,!0);return!0}return!1};return InputTime}(ComboBox);exports.InputTime=InputTime;wijmo_1._addCultureInfo("InputDateTime",{ariaLabels:{tglDate:"Toggle Calendar",tglTime:"Toggle Time List"}});var InputDateTime=function(e){__extends(InputDateTime,e);function InputDateTime(t,i){var o=e.call(this,t)||this;wijmo_1.addClass(o.hostElement,"wj-inputdatetime");var n=wijmo_1.culture.InputDateTime.ariaLabels;wijmo_1.setAriaLabel(o._btn,n.tglDate);wijmo_1.setAriaLabel(o._btnTm,n.tglTime);o.value=new Date;o.format="g";o._inputTime=new InputTime(document.createElement("div"),{valueChanged:function(e){var t=o.rangeEnd;o.value=wijmo_1.DateTime.fromDateTime(o.value,e.value);o.calendar._rngMode()&&t&&(o.rangeEnd=wijmo_1.DateTime.fromDateTime(t,e.value))},isDroppedDownChanged:function(e){e.listBox.containsFocus()&&o.inputElement.focus();o._selectAll()}});var s=o.addEventListener.bind(o);o._btnTm=o.hostElement.querySelector('[wj-part="btn-tm"]');s(o._btnTm,"mousedown",(function(e){o._btnclick(e)}));o._ddDate=o._dropDown;var r=o._ddTime=o._inputTime.dropDown;s(r,"keydown",o._keydown.bind(o),!0);s(r,"blur",(function(){o._updateFocusState()}),!0);s(r,"click",(function(e){e.defaultPrevented||e.target!=r&&o.hostElement.focus()}),!0);o.initialize(i);o._commitText();return o}Object.defineProperty(InputDateTime.prototype,"timeMin",{get:function(){return this._inputTime.min},set:function(e){this._inputTime.min=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDateTime.prototype,"timeMax",{get:function(){return this._inputTime.max},set:function(e){this._inputTime.max=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDateTime.prototype,"timeFormat",{get:function(){return this._inputTime.format},set:function(e){this._inputTime.format=e},enumerable:!0,configurable:!0});Object.defineProperty(InputDateTime.prototype,"timeStep",{get:function(){return this._inputTime.step},set:function(e){this._inputTime.step=e;this._btnTm.style.display=wijmo_1.isNumber(e)&&e>0?"":"none"},enumerable:!0,configurable:!0});Object.defineProperty(InputDateTime.prototype,"inputTime",{get:function(){return this._inputTime},enumerable:!0,configurable:!0});InputDateTime.prototype._fromDateTime=function(e){return e};InputDateTime.prototype._btnclick=function(t){var i=wijmo_1.closest(t.target,"button")==this._btn?this._ddDate:this._ddTime;this._setDropdown(i);e.prototype._btnclick.call(this,t)};InputDateTime.prototype.dispose=function(){this._setDropdown(this._ddDate);e.prototype.dispose.call(this);this._inputTime.dispose()};InputDateTime.prototype.refresh=function(t){void 0===t&&(t=!0);this._inputTime.refresh();e.prototype.refresh.call(this,t)};InputDateTime.prototype._updateBtn=function(){e.prototype._updateBtn.call(this);if(this._btnTm){this._btnTm.tabIndex=this._btn.tabIndex;this._btnTm.parentElement.style.display=this._btn.style.display}};InputDateTime.prototype._setDropdown=function(e){if(this._dropDown==e)return!1;this.isDroppedDown&&(this.isDroppedDown=!1);var t=this.dropDownCssClass;this.dropDownCssClass="";this._dropDown=e;this.dropDownCssClass=t;return!0};InputDateTime.prototype._updateDropDown=function(){var t=this._inputTime;if(this._dropDown==t.dropDown){this._commitText();e.prototype._updateDropDown.call(this);t.isRequired=this.isRequired&&null!=this.value;t.value=this.value;this.isDroppedDown&&t.listBox.showSelection()}else e.prototype._updateDropDown.call(this)};InputDateTime.controlTemplate='<div class="wj-template"><div class="wj-input"><div class="wj-input-group wj-input-btn-visible"><input wj-part="input" type="text" class="wj-form-control"/><span class="wj-input-group-btn"><button wj-part="btn" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-calendar"></span></button><button wj-part="btn-tm" class="wj-btn wj-btn-default" tabindex="-1"><span class="wj-glyph-clock"></span></button></span></div></div><div wj-part="dropdown" class="wj-content wj-dropdown-panel"></div></div>';return InputDateTime}(InputDate);exports.InputDateTime=InputDateTime;var AutoComplete=function(e){__extends(AutoComplete,e);function AutoComplete(t,i){var o=e.call(this,t)||this;o._cssMatch="wj-state-match";o._minLength=2;o._maxItems=6;o._itemCount=0;o._beginsWith=!1;o._delay=wijmo_1.Control._SEARCH_DELAY;o._query="";o._inCallback=!1;o._srchProps=[];o._oldSelectedIndex=-1;wijmo_1.addClass(o.hostElement,"wj-autocomplete");o._bsCollapse=!1;o.isEditable=!0;o.isRequired=!1;o.listBox.formatItem.addHandler(o._formatListItem,o);o._itemsSourceFnCallbackBnd=o._itemSourceFunctionCallback.bind(o);o.initialize(i);return o}Object.defineProperty(AutoComplete.prototype,"minLength",{get:function(){return this._minLength},set:function(e){this._minLength=wijmo_1.asNumber(e,!1,!0)},enumerable:!0,configurable:!0});Object.defineProperty(AutoComplete.prototype,"beginsWithSearch",{get:function(){return this._beginsWith},set:function(e){this._beginsWith=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(AutoComplete.prototype,"maxItems",{get:function(){return this._maxItems},set:function(e){this._maxItems=wijmo_1.asNumber(e,!1,!0)},enumerable:!0,configurable:!0});Object.defineProperty(AutoComplete.prototype,"delay",{get:function(){return this._delay},set:function(e){this._delay=wijmo_1.asNumber(e,!1,!0)},enumerable:!0,configurable:!0});Object.defineProperty(AutoComplete.prototype,"searchMemberPath",{get:function(){return this._srchProp},set:function(e){this._srchProp=wijmo_1.asString(e);this._srchProps=e?e.trim().split(/\s*,\s*/):[]},enumerable:!0,configurable:!0});Object.defineProperty(AutoComplete.prototype,"itemsSourceFunction",{get:function(){return this._itemsSourceFn},set:function(e){this._itemsSourceFn=wijmo_1.asFunction(e);wijmo_1.isFunction(this._itemsSourceFn)&&this.itemsSourceFunction(this.text,this.maxItems,this._itemsSourceFnCallbackBnd)},enumerable:!0,configurable:!0});Object.defineProperty(AutoComplete.prototype,"cssMatch",{get:function(){return this._cssMatch},set:function(e){this._cssMatch=wijmo_1.asString(e)},enumerable:!0,configurable:!0});AutoComplete.prototype.onSelectedIndexChanged=function(t){this._settingText||e.prototype.onSelectedIndexChanged.call(this,t)};AutoComplete.prototype._keydown=function(t){if(!t.defaultPrevented&&this.isDroppedDown)switch(t.keyCode){case wijmo_1.Key.Up:case wijmo_1.Key.Down:this.selectAll()}e.prototype._keydown.call(this,t)};AutoComplete.prototype._setText=function(e){var t=this;if(this._composing&&e!=this._oldText){this._oldText=e;this.onTextChanged()}if(!(this._inCallback||this._composing||this._settingText)){this._toSearch||(this._oldSelectedIndex=this.selectedIndex);if(this.selectedIndex>-1&&this.getDisplayText()!=e){this._settingText=!0;this.selectedIndex=-1;this._settingText=!1}if(e!=this._oldText){var i=this._tbx;i.value!=e&&(i.value=e);this._oldText=e;this.onTextChanged();var o=this.collectionView;if(!e&&o){(this._query||this.selectedIndex<0)&&(this.isDroppedDown=!1);this._query=this._rxHighlight=null;o.filter=null;var n=this.itemsSourceFunction;if(wijmo_1.isFunction(n)){this.isDroppedDown=!1;n(this._query,this.maxItems,this._itemsSourceFnCallbackBnd)}-1==this.selectedIndex&&-1!=this._oldSelectedIndex&&this.onSelectedIndexChanged();return}}this._toSearch&&clearTimeout(this._toSearch);e!=this.getDisplayText()&&(this._toSearch=setTimeout((function(){t._toSearch=null;var e=t.text.trim();if(e.length>=t._minLength&&e!=t._query){t._query=e;e=wijmo_1.escapeRegExp(e);var i=wijmo_1.escapeHtml(e),o=t.caseSensitiveSearch?"":"i";t._beginsWith||(o+="g");t._rxSrch=t._beginsWith?new RegExp("^"+e+".*",o):new RegExp("(?=.*"+e.replace(/ /g,")(?=.*")+")",o);t._rxHighlight=t._beginsWith?new RegExp("^"+e,o):new RegExp("("+i.replace(/\s+/g,"|")+")",o);var n=t.itemsSourceFunction;wijmo_1.isFunction(n)?n(t._query,t.maxItems,t._itemsSourceFnCallbackBnd):t._updateItems()}-1==t.selectedIndex&&-1!=t._oldSelectedIndex&&t.onSelectedIndexChanged()}),this._delay))}};AutoComplete.prototype._itemSourceFunctionCallback=function(e){this._inCallback=!0;var t=wijmo_1.asCollectionView(e||[]);t.moveCurrentToPosition(-1);this.itemsSource=t;this._inCallback=!1;if(this.containsFocus()){var i=this._tbx,o=i.selectionStart,n=i.selectionEnd,s=this.collectionView;this.isDroppedDown=null!=s&&s.items.length>0;wijmo_1.setSelectionRange(i,o,n);this.refresh()}};AutoComplete.prototype.onIsDroppedDownChanged=function(t){e.prototype.onIsDroppedDownChanged.call(this,t);if(this.containsFocus()&&!this.isTouching){var i=this.collectionView;if(this.selectedIndex<0&&i){var o=i.items,n=this.text;1==o.length&&o[0]==n?this.selectedIndex=0:wijmo_1.setSelectionRange(this._tbx,n.length)}}this._query=""};AutoComplete.prototype._updateItems=function(){var e=this.collectionView;if(e){this._inCallback=!0;e.beginUpdate();this._itemCount=0;e.filter=this._filter.bind(this);e.moveCurrentToPosition(-1);e.endUpdate();this._inCallback=!1;var t=e.items.length,i=this._tbx,o=i.selectionStart,n=i.selectionEnd;this.isDroppedDown=t>0&&this.containsFocus();t||this.isEditable||(this.selectedIndex=-1);if(1==t&&this.selectedIndex<0){var s=this._getItemText(e.items[0],!1),r=i.value;if(!this.caseSensitiveSearch){s=s.toLowerCase();r=r.toLowerCase()}s==r&&(this.selectedIndex=0)}this.isDroppedDown&&wijmo_1.setSelectionRange(i,o,n);this.refresh()}};AutoComplete.prototype._filter=function(e){if(this._itemCount>=this._maxItems)return!1;var t=[this._getItemText(e,!1)];this._srchProps&&this._srchProps.forEach((function(i){var o=e[i];null!=o&&t.push(o)}));this.isContentHtml&&(t=t.map((function(e){return e.replace(/(<[^>]*>|&[^;]*;)/g,"")})));for(var i=0;i<t.length;i++)if(this._rxSrch.test(t[i])){this._itemCount++;return!0}return!1};AutoComplete.prototype._getItemText=function(e,t){var i=e?e.toString():"",o=t&&this.headerPath?this._pathHdr:this._lbx._pathDisplay;o&&(i=null!=(i=o.getValue(e))?i.toString():"");return i};AutoComplete.prototype._formatListItem=function(e,t){var i=this;this._cssMatch&&this._rxHighlight&&(t.item.innerHTML=t.item.innerHTML.replace(this._rxHighlight,(function(e,t,o,n){return i._enclosed(n,o,"<",">")||i._enclosed(n,o,"&",";")?e:'<span class="'+i._cssMatch+'">'+e+"</span>"})))};AutoComplete.prototype._enclosed=function(e,t,i,o){for(var n=t;n>=0&&e[n]!=o;n--)if(e[n]==i)for(var s=t;s<e.length&&e[s]!=i;s++)if(e[s]==o)return!0;return!1};return AutoComplete}(ComboBox);exports.AutoComplete=AutoComplete;var MultiAutoComplete=function(e){__extends(MultiAutoComplete,e);function MultiAutoComplete(t,i){var o=e.call(this,t)||this;o._selItems=[];o._maxSelItems=null;o._lastInputValue="";o._selPath=new wijmo_1.Binding(null);o._notAddItm=!1;o.selectedItemsChanged=new wijmo_1.Event;wijmo_1.addClass(o.hostElement,"wj-multi-autocomplete");o._wjTpl=o.hostElement.querySelector(".wj-template");o._wjInput=o.hostElement.querySelector(".wj-input");o.showDropDownButton=!1;o.initialize(i);o.addEventListener(o.hostElement,"keyup",o._keyup.bind(o),!0);o.addEventListener(window,"resize",o._adjustInputWidth.bind(o));o.addEventListener(o._tbx,"focus",(function(){o._itemOff()}));o._addHelperInput();o._initSeltems();o.listBox.itemsChanged.addHandler((function(){return o.selectedIndex=-1}));o._refreshHeader();o._updateTabIndex();return o}Object.defineProperty(MultiAutoComplete.prototype,"showDropDownButton",{set:function(e){this._showBtn=!1},enumerable:!0,configurable:!0});Object.defineProperty(MultiAutoComplete.prototype,"maxSelectedItems",{get:function(){return this._maxSelItems},set:function(e){if(this._maxSelItems!=e){this._maxSelItems=wijmo_1.asNumber(e,!0);this._updateMaxItems();this._refreshHeader();this._clearSelIndex()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiAutoComplete.prototype,"selectedMemberPath",{get:function(){return this._selPath.path},set:function(e){if((e=wijmo_1.asString(e))!==this.selectedMemberPath){this._selPath.path=e;this._initSeltems();this._refreshHeader();this.onSelectedItemsChanged()}},enumerable:!0,configurable:!0});Object.defineProperty(MultiAutoComplete.prototype,"selectedItems",{get:function(){return this._selItems},set:function(e){var t=this._selItems===e;t||null==this._selItems||null==e||this._selItems.length!==e.length||(t=this._selItems.every((function(t,i){return t===e[i]})));this._selItems=wijmo_1.asArray(e);if(!t){if(this.selectedMemberPath&&""!==this.selectedMemberPath&&this._selItems)for(var i=0;i<this._selItems.length;i++){var o=this._selItems[i];this._setSelItem(o,!1)}this._updateMaxItems();this.onSelectedItemsChanged();this._refreshHeader();this._clearSelIndex()}},enumerable:!0,configurable:!0});MultiAutoComplete.prototype.onSelectedItemsChanged=function(e){this.selectedItemsChanged.raise(this,e)};MultiAutoComplete.prototype.onIsDroppedDownChanged=function(t){!this.isDroppedDown&&this.selectedIndex>-1&&!this._notAddItm&&this._addItem(!0);this._notAddItm=!1;e.prototype.onIsDroppedDownChanged.call(this,t)};MultiAutoComplete.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);if(this.hostElement){this._initSeltems();this.isDroppedDown||this._refreshHeader()}};MultiAutoComplete.prototype._keydown=function(t){if(!this.isReadOnly){if(!t.defaultPrevented)switch(t.keyCode){case wijmo_1.Key.Back:this._lastInputValue=this._tbx.value;break;case wijmo_1.Key.Enter:this._itemOff();this._addItem(!0);wijmo_1.isIE()&&wijmo_1.setSelectionRange(this._tbx,this._tbx.textContent.length,this._tbx.textContent.length);break;case wijmo_1.Key.Tab:if(this.isDroppedDown){this._addItem(!1);this._tbx.value="";this._lbx.selectedIndex=-1;t.preventDefault()}else this._updateFocus();break;case wijmo_1.Key.Space:if(""!==this._tbx.value)return;if(!this.isDroppedDown&&!this._tbx.disabled){this.isDroppedDown=!0;this._clearSelIndex()}break;case wijmo_1.Key.Escape:this.isDroppedDown&&(this._notAddItm=!0);break;case wijmo_1.Key.Left:this._itemOn(!this.rightToLeft);break;case wijmo_1.Key.Right:this._itemOn(!!this.rightToLeft);break;case wijmo_1.Key.Up:case wijmo_1.Key.Down:var i=wijmo_1.getActiveElement();if(t.altKey){if(this._tbx==i){this.isDroppedDown=!this.isDroppedDown;this.isDroppedDown||this._tbx.focus();t.preventDefault();return}}else if(this._tbx!==i)return;default:if(t.keyCode===wijmo_1.Key.Back||t.keyCode===wijmo_1.Key.Delete)return;this._itemOff();null!=this._maxSelItems&&this._selItems.length>=this._maxSelItems&&t.preventDefault()}this._tbx.disabled||e.prototype._keydown.call(this,t)}};MultiAutoComplete.prototype._updateState=function(){e.prototype._updateState.call(this);this._wjTpl&&(wijmo_1.hasClass(this.hostElement,"wj-state-focused")||this._itemOff())};MultiAutoComplete.prototype._keyup=function(e){if(!this.isReadOnly&&!e.defaultPrevented)switch(e.keyCode){case wijmo_1.Key.Back:0===this._tbx.value.length&&0===this._lastInputValue.length&&this._delItem(!1);break;case wijmo_1.Key.Delete:this._delItem(!0)}};MultiAutoComplete.prototype._addHelperInput=function(){var e=document.createElement("input");e.type="text";e.tabIndex=-1;e.className="wj-token-helper";e.readOnly=!0;this._wjTpl.insertBefore(e,this._wjInput);this._helperInput=e};MultiAutoComplete.prototype._refreshHeader=function(){for(var e=this.hostElement.querySelectorAll(".wj-token"),t=0;t<e.length;t++)this._wjTpl.removeChild(e[t]);var i=this.selectedItems;if(i&&0!==i.length){for(t=0;t<i.length;t++)this._insertToken(i[t]);this._wjInput.style.cssFloat=this.rightToLeft?"right":"left";this._adjustInputWidth()}else{this._wjInput.style.cssFloat=this.rightToLeft?"right":"left";this._adjustInputWidth()}};MultiAutoComplete.prototype._insertToken=function(e){var t=this._getItemText(e,!0);this.isContentHtml||(t=wijmo_1.escapeHtml(t));this._wjTpl.insertBefore(this._createItem(t),this._wjInput)};MultiAutoComplete.prototype._updateMaxItems=function(){null!=this._maxSelItems&&this._selItems&&this._selItems.length>this._maxSelItems&&(this._selItems=this._selItems.slice(0,this._maxSelItems))};MultiAutoComplete.prototype._updateFocus=function(){var e=this,t=this._wjTpl.querySelector("."+MultiAutoComplete._clsActive);if(t){wijmo_1.removeClass(t,MultiAutoComplete._clsActive);setTimeout((function(){e._tbx.focus()}))}else this._clearSelIndex()};MultiAutoComplete.prototype._addItem=function(e){if(this.selectedItems.indexOf(this.selectedItem)>-1)this._clearSelIndex();else if(this.selectedIndex>-1){this._updateSelItems(this.selectedItem,!0);this._refreshHeader();e&&this._clearSelIndex();this._disableInput(!0)}};MultiAutoComplete.prototype._delItem=function(e){var t,i,o=this._wjTpl.querySelector("."+MultiAutoComplete._clsActive),n=!1;if(!e||o){if(o){if((i=this._getItemIndex(o))>-1){t=this._selItems[i];n=!0}}else if(this._selItems.length>0){t=this._selItems[this._selItems.length-1];n=!0}if(n){this._updateSelItems(t,!1);this._refreshHeader();this._clearSelIndex();this._disableInput(!1)}this._tbx.focus()}};MultiAutoComplete.prototype._updateSelItems=function(e,t){if(t){this._selItems&&0!==this._selItems.length||(this._selItems=[]);if(null!=this._maxSelItems&&this._selItems.length>=this._maxSelItems)return;this._selItems.push(e)}else{var i=this._selItems.indexOf(e);this._selItems.splice(i,1)}this._hasSelectedMemeberPath()&&this._setSelItem(e,t);this.onSelectedItemsChanged()};MultiAutoComplete.prototype._createItem=function(e){var t=this,i=document.createElement("div"),o=document.createElement("span"),n=document.createElement("a");i.appendChild(o);i.appendChild(n);i.className="wj-token";o.className="wj-token-label";o.innerHTML=e;n.className="wj-token-close";n.href="#";n.tabIndex=-1;n.text="×";i.style.cssFloat=this.rightToLeft?"right":"left";this.addEventListener(i,"click",(function(e){t._helperInput.focus();var o=t._wjTpl.querySelector("."+MultiAutoComplete._clsActive);o&&wijmo_1.removeClass(o,MultiAutoComplete._clsActive);wijmo_1.addClass(i,MultiAutoComplete._clsActive);e.stopPropagation();e.preventDefault()}));this.addEventListener(n,"click",(function(e){if(!t.isReadOnly){var o=t._getItemIndex(i);if(o>-1){var n=t._selItems[o];t._updateSelItems(n,!1)}t._wjTpl.removeChild(i);t._adjustInputWidth();t._disableInput(!1);t._tbx.focus();e.stopPropagation();e.preventDefault()}}));return i};MultiAutoComplete.prototype._itemOn=function(e){var t,i,o,n=wijmo_1.getActiveElement();if((this._tbx!=n||0===this._tbx.value.length)&&0!==(t=this._wjTpl.querySelectorAll(".wj-token")).length){i=this._wjTpl.querySelector("."+MultiAutoComplete._clsActive);o=this._getItemIndex(i);if(e){if(0===o)return;if(-1===o){wijmo_1.addClass(t[t.length-1],MultiAutoComplete._clsActive);this._helperInput.focus()}else{wijmo_1.removeClass(i,MultiAutoComplete._clsActive);wijmo_1.addClass(t[o-1],MultiAutoComplete._clsActive);this._helperInput.focus()}}else if(!e){if(-1===o)return;if(o!==t.length-1){wijmo_1.removeClass(i,MultiAutoComplete._clsActive);wijmo_1.addClass(t[o+1],MultiAutoComplete._clsActive);this._helperInput.focus()}else{wijmo_1.removeClass(i,MultiAutoComplete._clsActive);this._tbx.focus()}}}};MultiAutoComplete.prototype._itemOff=function(){var e=this._wjTpl.querySelector("."+MultiAutoComplete._clsActive);e&&wijmo_1.removeClass(e,MultiAutoComplete._clsActive)};MultiAutoComplete.prototype._initSeltems=function(){if(this.selectedMemberPath){this._selItems.splice(0,this._selItems.length);var e=this.collectionView;if(e)for(var t=0;t<e.sourceCollection.length;t++)this._getSelItem(t)&&this._selItems.push(e.sourceCollection[t])}};MultiAutoComplete.prototype._getSelItem=function(e){var t=this.collectionView,i=t?t.sourceCollection[e]:null;return!(!wijmo_1.isObject(i)||!this.selectedMemberPath)&&this._selPath.getValue(i)};MultiAutoComplete.prototype._setSelItem=function(e,t){this.itemsSource;wijmo_1.isObject(e)&&this._selPath.getValue(e)!=t&&this._selPath.setValue(e,t)};MultiAutoComplete.prototype._clearSelIndex=function(){this.selectedIndex=-1};MultiAutoComplete.prototype._hasSelectedMemeberPath=function(){return this.selectedMemberPath&&""!==this.selectedMemberPath};MultiAutoComplete.prototype._disableInput=function(e){if(null!=this._maxSelItems)if(this._selItems.length<this._maxSelItems){this._tbx.disabled=!1;this._tbx.focus()}else{this._tbx.disabled=!0;this.hostElement.focus()}};MultiAutoComplete.prototype._adjustInputWidth=function(){this._tbx.style.width="60px";var e,t=wijmo_1.getElementRect(this.hostElement),i=wijmo_1.getElementRect(this._tbx),o=getComputedStyle(this._tbx),n=parseInt(o.paddingLeft,10),s=parseInt(o.paddingRight,10);e=this.rightToLeft?i.left+i.width-t.left-n-s-8:t.left+t.width-i.left-n-s-8;this._tbx.style.width=e+"px"};MultiAutoComplete.prototype._getItemIndex=function(e){for(var t=this.hostElement.querySelectorAll(".wj-token"),i=0;i<t.length;i++)if(e===t[i])return i;return-1};MultiAutoComplete.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t);this._updateTabIndex()};MultiAutoComplete.prototype._setTabOrder=function(e){this._orgTabIndex=e;this._updateTabIndex()};MultiAutoComplete.prototype._updateTabIndex=function(){var e=this.hostElement;this._tbx.tabIndex=this.isDisabled?-1:this._orgTabIndex;e.tabIndex=-1};MultiAutoComplete._clsActive="wj-token-active";return MultiAutoComplete}(AutoComplete);exports.MultiAutoComplete=MultiAutoComplete;wijmo_1._registerModule("wijmo.input",selfModule);