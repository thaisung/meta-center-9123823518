/*!
    *
    * Wijmo Library 5.20231.879
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){extendStatics(e,t);function __(){this.constructor=e}e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}}(),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);t.default=e;return t};Object.defineProperty(exports,"__esModule",{value:!0});var wijmo_1=require("wijmo/wijmo"),selfModule=__importStar(require("wijmo/wijmo.nav")),TabPanel=function(e){__extends(TabPanel,e);function TabPanel(t,i,n){var o=e.call(this,t,null,!0)||this;o._tabs=new wijmo_1.ObservableArray;o._selectedIndex=-1;o._animated=!0;o._autoSwitch=!0;o.selectedIndexChanged=new wijmo_1.Event;var r=o.hostElement,s=[];if(!n)for(;r.firstElementChild;){var a=r.firstElementChild;r.removeChild(a);s.push(a)}var d=o.getTemplate();o.applyTemplate("wj-control wj-tabpanel wj-animated",d,{_dRoot:"root",_dTabHeaders:"tabheaders",_dTabPanes:"tabpanes"});r.tabIndex=-1;o._dRoot.tabIndex=o._dTabHeaders.tabIndex=o._dTabPanes.tabIndex=-1;i&&wijmo_1.isBoolean(i.isAnimated)&&(o.isAnimated=i.isAnimated);o.addEventListener(r,"click",o._click.bind(o));o.addEventListener(r,"keydown",o._keydown.bind(o));o._tabs.collectionChanged.addHandler(o._populateControl.bind(o));o.tabs.deferUpdate((function(){s.forEach((function(e){wijmo_1.assert(2==e.childElementCount,"TabPanel children should contain header and pane elements");o.tabs.push(new Tab(e.children[0],e.children[1]))}))}));o.initialize(i);o.selectedIndex<0&&o.tabs.length?o.selectedIndex=0:o.onSelectedIndexChanged();return o}Object.defineProperty(TabPanel.prototype,"tabs",{get:function(){return this._tabs},enumerable:!0,configurable:!0});Object.defineProperty(TabPanel.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){if((e=wijmo_1.asInt(e,!1))!=this._selectedIndex){this._selectedIndex=e;this._updateContent();this.onSelectedIndexChanged()}else this._updateContent()},enumerable:!0,configurable:!0});Object.defineProperty(TabPanel.prototype,"selectedTab",{get:function(){var e=this._selectedIndex;return e>-1?this._tabs[e]:null},set:function(e){for(var t=-1,i=0;i<this._tabs.length&&t<0;i++)this._tabs[i]==e&&(t=i);this.selectedIndex=t},enumerable:!0,configurable:!0});Object.defineProperty(TabPanel.prototype,"isAnimated",{get:function(){return this._animated},set:function(e){this._animated=wijmo_1.asBoolean(e);wijmo_1.toggleClass(this.hostElement,"wj-animated",this._animated)},enumerable:!0,configurable:!0});Object.defineProperty(TabPanel.prototype,"autoSwitch",{get:function(){return this._autoSwitch},set:function(e){if(e!=this._autoSwitch){this._autoSwitch=wijmo_1.asBoolean(e);this._updateContent()}},enumerable:!0,configurable:!0});TabPanel.prototype.getTab=function(e){for(var t=0;t<this._tabs.length;t++){if((i=this._tabs[t]).header.id==e||i.pane.id==e)return i}for(t=0;t<this._tabs.length;t++){var i;if((i=this._tabs[t]).header.textContent==e)return i}return null};TabPanel.prototype.onSelectedIndexChanged=function(e){this.selectedIndexChanged.raise(this,e)};TabPanel.prototype._populateControl=function(){var e=this;this._removeChildren(this._dTabHeaders);this._removeChildren(this._dTabPanes);var t=-1;this._tabs.forEach((function(i,n){wijmo_1.assert(i instanceof Tab,"tabs array must contain Tab objects.");i._setPanel(e);var o=i.header;wijmo_1.addClass(o,"wj-tabheader");wijmo_1.setAttribute(o,"role","tab");e._dTabHeaders.appendChild(o);var r=i.pane;wijmo_1.addClass(r,"wj-tabpane");wijmo_1.setAttribute(r,"role","tabpanel");wijmo_1.setAttribute(r,"aria-labelledby",o.id?o.id:null);e._dTabPanes.appendChild(r);t<0&&(wijmo_1.hasClass(o,"wj-state-active")||"true"==o.getAttribute("aria-selected"))&&(t=n)}));t<0&&this._tabs.length>0&&(t=0);t>-1?this.selectedIndex=t:this.selectedIndex>-1&&this.selectedIndex<this._tabs.length&&this._updateContent();this._validateSelection()};TabPanel.prototype._validateSelection=function(){var e=this.selectedTab;if(e&&(e.isDisabled||!e.isVisible)){var t=this._getNextIndex(this.selectedIndex,1);t<0&&(t=this._getNextIndex(this.selectedIndex,-1));this.selectedIndex=t}};TabPanel.prototype._updateContent=function(){var e=this,t=wijmo_1.contains(this._dTabHeaders,wijmo_1.getActiveElement()),i=this._dTabHeaders.children,n=this._dTabPanes.children,o=this._selectedIndex;if(o>-1&&o<n.length){var r=(l=n[o]).style;if(this.isAnimated){this._eAnim&&(this._eAnim.style.opacity="");this._toAnim&&clearInterval(this._toAnim);r.opacity="0";this._eAnim=l;this._toAnim=wijmo_1.animate((function(t){if(1==t){e._eAnim=null;e._toAnim=null;r.opacity=""}else r.opacity=t.toString()}))}else r.opacity=""}for(var s=0;s<i.length;s++){var a=s==o,d=i[s];wijmo_1.setAttribute(d,"aria-selected",a);wijmo_1.toggleClass(d,"wj-state-active",a);var l=n[s];wijmo_1.toggleClass(l,"wj-state-active",a);d.tabIndex=a||!this._autoSwitch?this._orgTabIndex:-1;if(a){t&&d.focus();this._szObserver||wijmo_1.Control.invalidateAll(l)}}};TabPanel.prototype._removeChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)};TabPanel.prototype._click=function(e){var t=this._getTabIndex(e.target);if(t>-1){var i=this._tabs[t];!i.isDisabled&&i.isVisible&&(this.selectedIndex=t)}};TabPanel.prototype._keydown=function(e){if(!e.defaultPrevented){var t=this._getTabIndex(wijmo_1.getActiveElement());if(t>-1){var i=this._getKeyCode(e);switch(i){case wijmo_1.Key.Left:case wijmo_1.Key.Up:case wijmo_1.Key.Right:case wijmo_1.Key.Down:case wijmo_1.Key.Home:case wijmo_1.Key.PageUp:case wijmo_1.Key.End:case wijmo_1.Key.PageDown:switch(i){case wijmo_1.Key.Left:case wijmo_1.Key.Up:t=this._getNextIndex(t,-1);break;case wijmo_1.Key.Right:case wijmo_1.Key.Down:t=this._getNextIndex(t,1);break;case wijmo_1.Key.Home:case wijmo_1.Key.PageUp:t=this._getNextIndex(-1,1);break;case wijmo_1.Key.End:case wijmo_1.Key.PageDown:t=this._getNextIndex(this._tabs.length,-1)}t>-1&&(this._autoSwitch?this.selectedIndex=t:this._tabs[t].header.focus());e.preventDefault();break;case wijmo_1.Key.Enter:case wijmo_1.Key.Space:if(t>-1){this._tabs[t].header.click()}e.preventDefault()}}}};TabPanel.prototype._getTabIndex=function(e){var t=wijmo_1.closest(e,".wj-tabheader");if(t&&wijmo_1.closest(t,".wj-tabpanel")==this.hostElement)for(var i=0;i<this._tabs.length;i++)if(this._tabs[i].header==t)return i;return-1};TabPanel.prototype._getNextIndex=function(e,t){for(var i=e+t;i>-1&&i<this._tabs.length;i+=t){var n=this._tabs[i];if(!n.isDisabled&&n.isVisible)return i}return-1};TabPanel.prototype._setIsDisabled=function(t){e.prototype._setIsDisabled.call(this,t);this._updateTabIndex()};TabPanel.prototype._setTabOrder=function(t){e.prototype._setTabOrder.call(this,t);this.isDisabled||this._updateTabIndex()};TabPanel.prototype._updateTabIndex=function(){var e=this._dTabHeaders.children,t=this._selectedIndex;if(t>-1&&t<e.length){e[t].tabIndex=this.isDisabled?-1:this._orgTabIndex}this.hostElement.tabIndex=-1};TabPanel.controlTemplate='<div wj-part="root"><div wj-part="tabheaders" class="wj-tabheaders" role="tablist"></div><div wj-part="tabpanes" class="wj-tabpanes"></div></div>';return TabPanel}(wijmo_1.Control);exports.TabPanel=TabPanel;var Tab=function(){function Tab(e,t){this._hdr=wijmo_1.asType(wijmo_1.getElement(e),HTMLElement);this._pane=wijmo_1.asType(wijmo_1.getElement(t),HTMLElement)}Object.defineProperty(Tab.prototype,"tabPanel",{get:function(){return this._p},enumerable:!0,configurable:!0});Object.defineProperty(Tab.prototype,"header",{get:function(){return this._hdr},enumerable:!0,configurable:!0});Object.defineProperty(Tab.prototype,"pane",{get:function(){return this._pane},enumerable:!0,configurable:!0});Object.defineProperty(Tab.prototype,"isDisabled",{get:function(){return wijmo_1.hasClass(this._hdr,"wj-state-disabled")},set:function(e){wijmo_1.toggleClass(this._hdr,"wj-state-disabled",wijmo_1.asBoolean(e));this._p&&this._p._validateSelection()},enumerable:!0,configurable:!0});Object.defineProperty(Tab.prototype,"isVisible",{get:function(){return"none"!=this._hdr.style.display},set:function(e){this._hdr.style.display=wijmo_1.asBoolean(e)?"":"none";this._p&&this._p._validateSelection()},enumerable:!0,configurable:!0});Tab.prototype._setParts=function(e,t){e=wijmo_1.asType(wijmo_1.getElement(e),HTMLElement);t=wijmo_1.asType(wijmo_1.getElement(t),HTMLElement,!1);if(this._hdr!==e||this._pane!==t){var i=this.isDisabled,n=this.isVisible;this._hdr=e;this._pane=t;this.isDisabled=i;this.isVisible=n;var o=this.tabPanel;o&&!o.tabs.isUpdating&&o._populateControl()}};Tab.prototype._setPanel=function(e){this._p=e};return Tab}();exports.Tab=Tab;var _CLS_ACTIVE="wj-state-active",Accordion=function(e){__extends(Accordion,e);function Accordion(t,i,n){var o=e.call(this,t,null,!0)||this;o._panes=new wijmo_1.ObservableArray;o._selectedIndex=-1;o._animated=!0;o._autoSwitch=!0;o._alCollapseAll=!1;o._alExpandMany=!1;o._autoSwitching=!1;o.selectedIndexChanged=new wijmo_1.Event;var r=o.hostElement,s=o._panes,a=[];if(!n)for(;r.firstElementChild;){var d=r.firstElementChild;r.removeChild(d);a.push(d)}wijmo_1.addClass(r,"wj-control wj-accordion wj-show-icons");r.tabIndex=-1;o.addEventListener(r,"click",o._click.bind(o));o.addEventListener(r,"keydown",o._keydown.bind(o));s.collectionChanged.addHandler(o._populateControl.bind(o));s.deferUpdate((function(){a.forEach((function(e){wijmo_1.assert(2==e.childElementCount,"Accordion children should contain header and pane elements");s.push(new AccordionPane(e.children[0],e.children[1]))}))}));o.initialize(i);var l=i?i.selectedIndex:null;o.selectedIndex!=l&&o.selectedIndex<0&&s.length?o.selectedIndex=0:o.onSelectedIndexChanged();return o}Object.defineProperty(Accordion.prototype,"panes",{get:function(){return this._panes},enumerable:!0,configurable:!0});Object.defineProperty(Accordion.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){if((e=wijmo_1.asInt(e,!1))!=this._selectedIndex){this._selectedIndex=e;this._updateContent();this.onSelectedIndexChanged()}else this._updateContent()},enumerable:!0,configurable:!0});Object.defineProperty(Accordion.prototype,"selectedPane",{get:function(){var e=this._selectedIndex;return e>-1?this._panes[e]:null},set:function(e){this.selectedIndex=this._getIndexOfPane(e)},enumerable:!0,configurable:!0});Object.defineProperty(Accordion.prototype,"isAnimated",{get:function(){return this._animated},set:function(e){this._animated=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(Accordion.prototype,"showIcons",{get:function(){return wijmo_1.hasClass(this.hostElement,"wj-show-icons")},set:function(e){wijmo_1.toggleClass(this.hostElement,"wj-show-icons",wijmo_1.asBoolean(e))},enumerable:!0,configurable:!0});Object.defineProperty(Accordion.prototype,"autoSwitch",{get:function(){return this._autoSwitch},set:function(e){if(e!=this._autoSwitch){this._autoSwitch=wijmo_1.asBoolean(e);this._updateContent()}},enumerable:!0,configurable:!0});Object.defineProperty(Accordion.prototype,"allowCollapseAll",{get:function(){return this._alCollapseAll},set:function(e){this._alCollapseAll=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(Accordion.prototype,"allowExpandMany",{get:function(){return this._alExpandMany},set:function(e){var t=this;if(e!=this._alExpandMany){this._alExpandMany=e=wijmo_1.asBoolean(e);e||this.panes.forEach((function(e,i){var n=i==t.selectedIndex;wijmo_1.toggleClass(e.header,"wj-state-active",n);wijmo_1.setAttribute(e.header,"aria-expanded",n)}))}},enumerable:!0,configurable:!0});Accordion.prototype.getPane=function(e){for(var t=0;t<this._panes.length;t++){if((i=this._panes[t]).header.id==e||i.content.id==e)return i}for(t=0;t<this._panes.length;t++){var i;if((i=this._panes[t]).header.textContent==e)return i}return null};Accordion.prototype.onSelectedIndexChanged=function(e){this.selectedIndexChanged.raise(this,e)};Accordion.prototype._populateControl=function(){var e=this,t=-1,i=this.hostElement;this._panes.forEach((function(n,o){wijmo_1.assert(n instanceof AccordionPane,"panes array must contain AccordionPane objects.");n._setAccordion(e);var r=n.header;wijmo_1.addClass(r,"wj-header");wijmo_1.setAttribute(r,"role","button");i.appendChild(r);var s=n.content;wijmo_1.addClass(s,"wj-content");wijmo_1.setAttribute(s,"role","region");wijmo_1.setAttribute(s,"aria-labelledby",r.id?r.id:null);i.appendChild(s);t<0&&(wijmo_1.hasClass(r,_CLS_ACTIVE)||"true"==r.getAttribute("aria-expanded"))&&(t=o)}));t>-1?this.selectedIndex=t:this.selectedIndex>-1&&this.selectedIndex<this._panes.length&&this._updateContent();this._validateSelection()};Accordion.prototype._validateSelection=function(){var e=this.selectedPane;if(e&&(e.isDisabled||!e.isVisible)){var t=this._getNextIndex(this.selectedIndex,1);t<0&&(t=this._getNextIndex(this.selectedIndex,-1));this.selectedIndex=t}};Accordion.prototype._updateContent=function(){var e=this,t=wijmo_1.contains(this.hostElement,wijmo_1.getActiveElement()),i=this._selectedIndex,n=this._panes,o=[];n.forEach((function(n,r){var s=n.header,a=r==i,d=wijmo_1.hasClass(s,_CLS_ACTIVE),l=a||d&&e._alExpandMany&&n!=e._hidePane,h=l&&!d,c=d&&!l;e._animated&&(h||c)&&o.push({show:h,pane:n});wijmo_1.setAttribute(s,"aria-expanded",l);e._animated||wijmo_1.toggleClass(s,_CLS_ACTIVE,l);if(a){t&&s.focus();e._szObserver||wijmo_1.Control.invalidateAll(n.content)}}));this._updatePanesTabIndex();if(this._animated&&o.length){o.forEach((function(e){wijmo_1.toggleClass(e.pane.header,_CLS_ACTIVE,!0);e.height=e.pane.content.offsetHeight;e.show&&(e.pane.content.style.height="0")}));wijmo_1.animate((function(e){e<1?o.forEach((function(t){var i=t.height*(t.show?e:1-e);t.pane.content.style.height=i.toFixed(0)+"px"})):o.forEach((function(e){e.pane.content.style.height="";wijmo_1.toggleClass(e.pane.header,_CLS_ACTIVE,e.show)}))}))}this._hidePane=null};Accordion.prototype._updatePanesTabIndex=function(){var e=this;this._panes.forEach((function(t,i){t.header.tabIndex=e._selectedIndex!==i&&e._autoSwitch?-1:e._orgTabIndex}))};Accordion.prototype._setTabOrder=function(t){e.prototype._setTabOrder.call(this,t);this._updatePanesTabIndex()};Accordion.prototype._click=function(e){var t=this._getPaneIndex(e.target);if(t>-1){var i=this._panes[t];if(!i.isDisabled&&i.isVisible){if(!wijmo_1.hasClass(i.header,_CLS_ACTIVE)||this._autoSwitching)this.selectedIndex=t;else{var n=this._getNextActiveIndex(t);if(n>-1||this._alCollapseAll){this._hidePane=i;this.selectedIndex=n}}}}};Accordion.prototype._keydown=function(e){if(!e.defaultPrevented){var t=this._getPaneIndex(wijmo_1.getActiveElement());if(t>-1){var i=this._getKeyCode(e);switch(i){case wijmo_1.Key.Left:case wijmo_1.Key.Up:case wijmo_1.Key.Right:case wijmo_1.Key.Down:case wijmo_1.Key.Home:case wijmo_1.Key.PageUp:case wijmo_1.Key.End:case wijmo_1.Key.PageDown:switch(i){case wijmo_1.Key.Left:case wijmo_1.Key.Up:t=this._getNextIndex(t,-1);break;case wijmo_1.Key.Right:case wijmo_1.Key.Down:t=this._getNextIndex(t,1);break;case wijmo_1.Key.Home:case wijmo_1.Key.PageUp:t=this._getNextIndex(-1,1);break;case wijmo_1.Key.End:case wijmo_1.Key.PageDown:t=this._getNextIndex(this._panes.length,-1)}if(t>-1){var n=this._panes[t];if(this._autoSwitch){this._autoSwitching=!0;n.header.click();this._autoSwitching=!1}else n.header.focus()}e.preventDefault();break;case wijmo_1.Key.Enter:case wijmo_1.Key.Space:if(t>-1){(n=this._panes[t]).header.click()}e.preventDefault()}}}};Accordion.prototype._getPaneIndex=function(e){var t=wijmo_1.closest(e,".wj-header");if(t&&wijmo_1.closest(t,".wj-accordion")==this.hostElement)for(var i=0;i<this._panes.length;i++)if(this._panes[i].header==t)return i;return-1};Accordion.prototype._getNextIndex=function(e,t){for(var i=e+t;i>-1&&i<this._panes.length;i+=t){var n=this._panes[i];if(!n.isDisabled&&n.isVisible)return i}return-1};Accordion.prototype._getIndexOfPane=function(e){for(var t=-1,i=this._panes,n=0;n<i.length&&t<0;n++)i[n]==e&&(t=n);return t};Accordion.prototype._getNextActiveIndex=function(e){for(var t=-1,i=this.panes,n=1;n<i.length;n++){var o=(e+n)%i.length,r=i[o];if(wijmo_1.hasClass(r.header,_CLS_ACTIVE)){t=o;break}}return t};Accordion.prototype._togglePane=function(e,t){if(e.isCollapsed!==t&&e.isVisible&&!e.isDisabled)if(t){if(this.allowCollapseAll||this.panes.filter((function(e){return!e.isCollapsed})).length>1){this._hidePane=e;var i=this._getIndexOfPane(e);this.selectedIndex=this._getNextActiveIndex(i)}}else this.selectedPane=e};return Accordion}(wijmo_1.Control);exports.Accordion=Accordion;var AccordionPane=function(){function AccordionPane(e,t){this._hdr=wijmo_1.asType(wijmo_1.getElement(e),HTMLElement);this._content=wijmo_1.asType(wijmo_1.getElement(t),HTMLElement)}Object.defineProperty(AccordionPane.prototype,"accordion",{get:function(){return this._acc},enumerable:!0,configurable:!0});Object.defineProperty(AccordionPane.prototype,"header",{get:function(){return this._hdr},enumerable:!0,configurable:!0});Object.defineProperty(AccordionPane.prototype,"content",{get:function(){return this._content},enumerable:!0,configurable:!0});Object.defineProperty(AccordionPane.prototype,"isDisabled",{get:function(){return wijmo_1.hasClass(this._hdr,"wj-state-disabled")},set:function(e){wijmo_1.toggleClass(this._hdr,"wj-state-disabled",wijmo_1.asBoolean(e));this._acc&&this._acc._validateSelection()},enumerable:!0,configurable:!0});Object.defineProperty(AccordionPane.prototype,"isVisible",{get:function(){return"none"!=this._hdr.style.display},set:function(e){this._hdr.style.display=wijmo_1.asBoolean(e)?"":"none";this._acc&&this._acc._validateSelection()},enumerable:!0,configurable:!0});Object.defineProperty(AccordionPane.prototype,"isCollapsed",{get:function(){return!wijmo_1.hasClass(this._hdr,_CLS_ACTIVE)},set:function(e){var t=this._acc;t?t._togglePane(this,e):wijmo_1.toggleClass(this._hdr,_CLS_ACTIVE,!wijmo_1.asBoolean(e))},enumerable:!0,configurable:!0});AccordionPane.prototype._setParts=function(e,t){e=wijmo_1.asType(wijmo_1.getElement(e),HTMLElement);t=wijmo_1.asType(wijmo_1.getElement(t),HTMLElement,!1);if(this._hdr!==e||this._content!==t){var i=this.isDisabled,n=this.isVisible;this._hdr=e;this._content=t;this.isDisabled=i;this.isVisible=n;var o=this.accordion;o&&!o.panes.isUpdating&&o._populateControl()}};AccordionPane.prototype._setAccordion=function(e){this._acc=e};return AccordionPane}();exports.AccordionPane=AccordionPane;var FormatNodeEventArgs=function(e){__extends(FormatNodeEventArgs,e);function FormatNodeEventArgs(t,i,n){var o=e.call(this)||this;o._data=t;o._e=wijmo_1.asType(i,HTMLElement);o._level=n;return o}Object.defineProperty(FormatNodeEventArgs.prototype,"dataItem",{get:function(){return this._data},enumerable:!0,configurable:!0});Object.defineProperty(FormatNodeEventArgs.prototype,"element",{get:function(){return this._e},enumerable:!0,configurable:!0});Object.defineProperty(FormatNodeEventArgs.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0});return FormatNodeEventArgs}(wijmo_1.EventArgs);exports.FormatNodeEventArgs=FormatNodeEventArgs;var TreeNodeEventArgs=function(e){__extends(TreeNodeEventArgs,e);function TreeNodeEventArgs(t){var i=e.call(this)||this;i._node=t;return i}Object.defineProperty(TreeNodeEventArgs.prototype,"node",{get:function(){return this._node},enumerable:!0,configurable:!0});return TreeNodeEventArgs}(wijmo_1.CancelEventArgs);exports.TreeNodeEventArgs=TreeNodeEventArgs;var DropPosition,TreeNodeDragDropEventArgs=function(e){__extends(TreeNodeDragDropEventArgs,e);function TreeNodeDragDropEventArgs(t,i,n){var o=e.call(this)||this;o._src=wijmo_1.asType(t,TreeNode);o._tgt=wijmo_1.asType(i,TreeNode);o._pos=n;return o}Object.defineProperty(TreeNodeDragDropEventArgs.prototype,"dragSource",{get:function(){return this._src},enumerable:!0,configurable:!0});Object.defineProperty(TreeNodeDragDropEventArgs.prototype,"dropTarget",{get:function(){return this._tgt},enumerable:!0,configurable:!0});Object.defineProperty(TreeNodeDragDropEventArgs.prototype,"position",{get:function(){return this._pos},set:function(e){this._pos=wijmo_1.asEnum(e,DropPosition)},enumerable:!0,configurable:!0});return TreeNodeDragDropEventArgs}(wijmo_1.CancelEventArgs);exports.TreeNodeDragDropEventArgs=TreeNodeDragDropEventArgs;!function(e){e[e.Before=0]="Before";e[e.After=1]="After";e[e.Into=2]="Into"}(DropPosition=exports.DropPosition||(exports.DropPosition={}));var TreeNode=function(){function TreeNode(e,t){if(wijmo_1.hasClass(t,"wj-treeview")){e=wijmo_1.Control.getControl(t);t=null}else TreeNode._assertNode(t);this._t=e;this._e=t}Object.defineProperty(TreeNode.prototype,"dataItem",{get:function(){return this._e[TreeView._DATAITEM_KEY]},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"element",{get:function(){return this._e},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"treeView",{get:function(){return this._t},enumerable:!0,configurable:!0});TreeNode.prototype.ensureVisible=function(){for(var e=this.parentNode;e;e=e.parentNode)e.isCollapsed=!1;var t=this._t.hostElement,i=this.element.getBoundingClientRect(),n=t.getBoundingClientRect();i.bottom>n.bottom?t.scrollTop+=i.bottom-n.bottom:i.top<n.top&&(t.scrollTop-=n.top-i.top)};TreeNode.prototype.equals=function(e){return null!=e&&e.element==this.element};TreeNode.prototype.select=function(){var e=this._t,t=e._selNode;if(!this.equals(t)){if(t){wijmo_1.removeClass(t.element,TreeView._CSEL);wijmo_1.setAttribute(t.element,"aria-selected",!1)}e._selNode=this;wijmo_1.addClass(this.element,TreeView._CSEL);wijmo_1.setAttribute(this.element,"aria-selected",!0);this.ensureVisible();e._updateFocus(t);e.onSelectedItemChanged()}};Object.defineProperty(TreeNode.prototype,"index",{get:function(){for(var e=0,t=this._pse(this.element);t;t=this._pse(t))TreeNode._isNode(t)&&e++;return e},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"parentNode",{get:function(){var e=null;if(this._e){var t=this._e.parentElement;TreeNode._assertNodeList(t);e=this._pse(t)}return e?new TreeNode(this._t,e):null},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"level",{get:function(){for(var e=-1,t=this;t;t=t.parentNode)e++;return e},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"hasChildren",{get:function(){return TreeNode._isNode(this._e)&&!TreeNode._isEmpty(this._e)},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"hasPendingChildren",{get:function(){return this.isCollapsed&&this.hasChildren&&!TreeNode._isNodeList(this.element.nextElementSibling)&&wijmo_1.isFunction(this._t.lazyLoadFunction)},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"nodes",{get:function(){return this.hasChildren?TreeNode._getChildNodes(this._t,this._e.nextSibling):null},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"checkBox",{get:function(){return this._e.querySelector("input."+TreeView._CNDC)},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"isCollapsed",{get:function(){return this.hasChildren&&wijmo_1.hasClass(this._e,TreeView._CCLD)},set:function(e){if(e!=this.isCollapsed){var t=this._t,i=new TreeNodeEventArgs(this);if(t.onIsCollapsedChanging(i)){this.setCollapsed(wijmo_1.asBoolean(e),t.isAnimated,t.autoCollapse);t.onIsCollapsedChanged(i)}}},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"isChecked",{get:function(){var e=this.checkBox;return e&&!e.indeterminate?e.checked:null},set:function(e){if(e!=this.isChecked){var t=this._t,i=new TreeNodeEventArgs(this);if(t.onIsCheckedChanging(i)){this.setChecked(wijmo_1.asBoolean(e),!0);t.onIsCheckedChanged(i)}}},enumerable:!0,configurable:!0});Object.defineProperty(TreeNode.prototype,"isDisabled",{get:function(){return this._e&&null!=this._e.getAttribute("disabled")},set:function(e){if((e=wijmo_1.asBoolean(e,!0))!=this.isDisabled){wijmo_1.enable(this._e,!e);this.isDisabled&&this._t&&this._t.collapseWhenDisabled&&(this.isCollapsed=!0)}},enumerable:!0,configurable:!0});TreeNode.prototype.previous=function(e,t){var i=this._pse(this._e);!i&&TreeNode._isNodeList(this._e.parentElement)&&(i=this._pse(this._e.parentElement));if(TreeNode._isNodeList(i)){for(;TreeNode._isNodeList(i)&&i.childElementCount;)i=i.lastChild;TreeNode._isNodeList(i)&&(i=this._pse(i))}var n=TreeNode._isNode(i)?new TreeNode(this._t,i):null;e&&n&&!n.element.offsetHeight&&(n=n.previous(e,t));t&&n&&n.isDisabled&&(n=n.previous(e,t));return n};TreeNode.prototype.next=function(e,t){var i=this._e.nextSibling;TreeNode._isNodeList(i)&&(i=i.childElementCount?i.firstChild:i.nextSibling);if(!i)for(var n=this._e.parentElement;!i&&TreeNode._isNodeList(n);n=n.parentElement)i=n.nextSibling;var o=TreeNode._isNode(i)?new TreeNode(this._t,i):null;e&&o&&!o.element.offsetHeight&&(o=o.next(e,t));t&&o&&o.isDisabled&&(o=o.next(e,t));return o};TreeNode.prototype.previousSibling=function(){for(var e=this._pse(this.element);TreeNode._isNodeList(e);)e=this._pse(e);return e?new TreeNode(this._t,e):null};TreeNode.prototype.nextSibling=function(){var e=this.element.nextSibling;TreeNode._isNodeList(e)&&(e=e.nextSibling);return e?new TreeNode(this._t,e):null};TreeNode.prototype.setCollapsed=function(e,t,i){var n=this._t,o=this._e,r=this._e.nextElementSibling,s=TreeNode._isNodeList(r);wijmo_1.setAttribute(o,"aria-expanded",s?(!e).toString():null);if(e!=this.isCollapsed)if(e||s||!wijmo_1.isFunction(n.lazyLoadFunction)){null==t&&(t=n.isAnimated);null==i&&(i=n.autoCollapse);if(t){if(s){var a=r.offsetHeight,d=r.style,l=n.hostElement,h=l.style;l.scrollHeight<=l.clientHeight&&(h.overflowY="hidden");if(e){wijmo_1.toggleClass(o,TreeView._CCLG,!0);wijmo_1.animate((function(e){if(e<1){e=1-e;d.height=(e*a).toFixed(0)+"px"}else{d.height=d.opacity=h.overflowY="";wijmo_1.toggleClass(o,TreeView._CCLD,!0);wijmo_1.toggleClass(o,TreeView._CCLG,!1)}}),TreeView._AN_DLY)}else{wijmo_1.toggleClass(o,TreeView._CCLD,!1);d.height=d.opacity="0";wijmo_1.animate((function(e){d.height=e>=1?d.opacity=h.overflowY="":(e*a).toFixed(0)+"px"}),TreeView._AN_DLY)}}}else wijmo_1.toggleClass(o,TreeView._CCLD,e);if(!e&&i){var c=o.parentElement;if(TreeNode._isNodeList(c))for(var _=0;_<c.children.length;_++){var u=c.children[_];if(u!=o&&TreeNode._isNode(u)){wijmo_1.toggleClass(u,TreeView._CCLD,!0);u.setAttribute("aria-expanded","false")}}}}else n._lazyLoadNode(this)};TreeNode.prototype.setChecked=function(e,t){var i=this.checkBox,n=i.checked!=e;wijmo_1.setChecked(i,e);if(this.hasChildren)for(var o=0;o<this.nodes.length;o++)this.nodes[o].setChecked(e,!1);var r=this._t;r&&r.checkedMemberPath&&r._chkPath.setValue(this.dataItem,this.level,e);if(t){var s=this.parentNode;s&&s._updateCheckedState()}r&&n&&r._raiseCheckedItemsChanged()};TreeNode.prototype.remove=function(){var e=this._t,t=this.parentNode,i=this._getArray(),n=i.indexOf(this.dataItem);e.selectedNode==this&&(e.selectedNode=this.nextSibling()||this.previousSibling()||t);var o=this.element.nextSibling;TreeNode._isNodeList(o)&&wijmo_1.removeChild(o);wijmo_1.removeChild(this.element);t&&t._updateState();i.splice(n,1);this._t=null};TreeNode.prototype.addChildNode=function(e,t){var i=this._t._createNode(t),n=this.nodes;n?e<n.length?i.move(n[e],DropPosition.Before):i.move(n[n.length-1],DropPosition.After):i.move(this,DropPosition.Into);return i};TreeNode.prototype.refresh=function(e){var t=this._getArray();e&&(t[this.index]=e);e=t[this.index];var i=this._t._createNode(e),n=this.hasChildren&&!this.hasPendingChildren?this.element.nextSibling:null;n&&wijmo_1.removeChild(n);(n=i.hasChildren&&!i.hasPendingChildren?i.element.nextSibling:null)&&this.element.parentElement.insertBefore(n,this.element.nextSibling);this.element.innerHTML=i.element.innerHTML;this._updateState()};TreeNode.prototype.move=function(e,t){if(e instanceof TreeNode&&this._contains(e))return!1;var i=this.parentNode,n=this._getArray();this._moveElements(e,t);e.treeView&&(this._t=e.treeView);i&&i._updateState();var o=this.parentNode;o&&o._updateState();var r=this.dataItem,s=n.indexOf(r),a=this._getArray();n.splice(s,1);a.splice(this.index,0,r);return!0};Object.defineProperty(TreeNode.prototype,"itemsSource",{get:function(){return this._getArray()},enumerable:!0,configurable:!0});TreeNode.prototype._pse=function(e){return e.previousElementSibling};TreeNode.prototype._contains=function(e){for(;e;e=e.parentNode)if(e.element==this.element)return!0;return!1};TreeNode.prototype._getArray=function(){var e=this._t,t=this.parentNode,i=e.itemsSource;if(t){var n=e._itmPath;if(!(i=n.getValue(t.dataItem,this.level))){i=[];n.setValue(t.dataItem,this.level,i)}}return i};TreeNode.prototype._moveElements=function(e,t){var i=document.createDocumentFragment(),n=this.hasChildren&&!this.hasPendingChildren?this.element.nextSibling:null;i.appendChild(this.element);if(n){TreeNode._assertNodeList(n);i.appendChild(n)}if(e instanceof TreeView)e._root.insertBefore(i,null);else{var o=e.element,r=o?o.parentElement:e.treeView._root;TreeNode._assertNodeList(r);var s=DropPosition;switch(t){case s.Before:r.insertBefore(i,o);break;case s.After:o=(e=e.nextSibling())?e.element:null;r.insertBefore(i,o);break;case s.Into:if(!e.hasChildren||e.hasPendingChildren){n=document.createElement("div");wijmo_1.addClass(n,TreeView._CNDL);r.insertBefore(n,o.nextSibling)}r=e.element.nextSibling;TreeNode._assertNodeList(r);r.insertBefore(i,null)}}};TreeNode.prototype._updateState=function(){this._updateEmptyState();this._updateCheckedState()};TreeNode.prototype._updateEmptyState=function(){var e=this.element.nextSibling,t=!1;TreeNode._isNodeList(e)&&(e.childElementCount?t=!0:wijmo_1.removeChild(e));wijmo_1.toggleClass(this.element,TreeView._CEMP,!t);t||this.element.removeAttribute("aria-expanded")};TreeNode.prototype._updateCheckedState=function(){var e=this._t,t=this.checkBox,i=this.nodes,n=0,o=0,r=!1;if(t&&i){for(var s=0;s<i.length&&!r;s++){switch(i[s].isChecked){case!0:n++;break;case!1:o++;break;case null:r=!0}n&&o&&(r=!0)}wijmo_1.setChecked(t,r?null:n>0);if(e&&e.checkedMemberPath){var a=r?null:t.checked;e._chkPath.setValue(this.dataItem,this.level,a)}}var d=this.parentNode;d&&d._updateCheckedState()};TreeNode._getChildNodes=function(e,t){var i=[];if(TreeNode._isNodeList(t))for(var n=t.children,o=0;o<n.length;o++){var r=n[o];TreeNode._isNode(r)&&i.push(new TreeNode(e,r))}return i};TreeNode._isNode=function(e){return e&&wijmo_1.hasClass(e,TreeView._CND)};TreeNode._isNodeList=function(e){return e&&wijmo_1.hasClass(e,TreeView._CNDL)};TreeNode._isEmpty=function(e){return TreeNode._isNode(e)&&wijmo_1.hasClass(e,TreeView._CEMP)};TreeNode._isCollapsed=function(e){return TreeNode._isNode(e)&&!TreeNode._isEmpty(e)&&wijmo_1.hasClass(e,TreeView._CCLD)};TreeNode._assertNode=function(e){wijmo_1.assert(TreeNode._isNode(e),"node expected")};TreeNode._assertNodeList=function(e){wijmo_1.assert(TreeNode._isNodeList(e),"nodeList expected")};return TreeNode}();exports.TreeNode=TreeNode;var _BindingArray=function(){function _BindingArray(e){this.path=e}Object.defineProperty(_BindingArray.prototype,"path",{get:function(){return this._path},set:function(e){this._path=e;if(wijmo_1.isString(e))this._bindings=[new wijmo_1.Binding(e)];else if(wijmo_1.isArray(e)){this._bindings=[];for(var t=0;t<e.length;t++)this._bindings.push(new wijmo_1.Binding(e[t]))}else null!=e&&wijmo_1.assert(!1,"Path should be a string or an array of strings.");this._maxLevel=this._bindings?this._bindings.length-1:-1},enumerable:!0,configurable:!0});_BindingArray.prototype.getValue=function(e,t){var i=Math.min(t,this._maxLevel);return i>-1?this._bindings[i].getValue(e):null};_BindingArray.prototype.setValue=function(e,t,i){var n=Math.min(t,this._maxLevel);n>-1&&this._bindings[n].setValue(e,i)};return _BindingArray}();exports._BindingArray=_BindingArray;var TreeView=function(e){__extends(TreeView,e);function TreeView(t,i){var n=e.call(this,t)||this;n._itmPath=new _BindingArray("items");n._chkPath=new _BindingArray;n._dspPath=new _BindingArray("header");n._imgPath=new _BindingArray;n._html=!1;n._animated=!0;n._chkOnClick=!1;n._collOnClick=!1;n._xpndOnClick=!0;n._xpndOnLoad=!0;n._autoColl=!0;n._showChk=!1;n._collapseWhenDisabled=!0;n._srch="";n._isReadOnly=!0;n.itemsSourceChanged=new wijmo_1.Event;n.loadingItems=new wijmo_1.Event;n.loadedItems=new wijmo_1.Event;n.itemClicked=new wijmo_1.Event;n.selectedItemChanged=new wijmo_1.Event;n.checkedItemsChanged=new wijmo_1.Event;n.isCollapsedChanging=new wijmo_1.Event;n.isCollapsedChanged=new wijmo_1.Event;n.isCheckedChanging=new wijmo_1.Event;n.isCheckedChanged=new wijmo_1.Event;n.formatItem=new wijmo_1.Event((function(){n.invalidate()}));n.dragStart=new wijmo_1.Event;n.dragOver=new wijmo_1.Event;n.drop=new wijmo_1.Event;n.dragEnd=new wijmo_1.Event;n.nodeEditStarting=new wijmo_1.Event;n.nodeEditStarted=new wijmo_1.Event;n.nodeEditEnding=new wijmo_1.Event;n.nodeEditEnded=new wijmo_1.Event;var o=n.getTemplate();n.applyTemplate("wj-control wj-content wj-treeview",o,{_root:"root"});var r=n.hostElement;wijmo_1.setAttribute(r,"role","tree",!0);wijmo_1.addClass(n._root,TreeView._CNDL);wijmo_1.setAttribute(n._root,"role","group",!0);n.addEventListener(r,"mousedown",n._mousedown.bind(n));n.addEventListener(r,"click",n._click.bind(n));n.addEventListener(r,"keydown",n._keydown.bind(n));n.addEventListener(r,"keypress",n._keypress.bind(n));n.addEventListener(r,"wheel",(function(e){r.scrollHeight>r.offsetHeight&&(e.deltaY<0&&0==r.scrollTop||e.deltaY>0&&r.scrollTop+r.offsetHeight>=r.scrollHeight)&&e.preventDefault()}));n.addEventListener(r,"blur",(function(){n._edtNode&&!wijmo_1.contains(n._edtNode.element,wijmo_1.getActiveElement())&&n.finishEditing()}),!0);n.addEventListener(r,"paste",(function(e){if(n._edtNode&&!n.isContentHtml){var t=(e.clipboardData||window.clipboardData).getData("text"),i=window.getSelection();if(t&&i.rangeCount){i.deleteFromDocument();i.getRangeAt(0).insertNode(document.createTextNode(t));e.preventDefault()}}}));n.initialize(i);n.refresh();return n}Object.defineProperty(TreeView.prototype,"itemsSource",{get:function(){return this._items},set:function(e){if(this._items!=e){this._items=wijmo_1.asArray(e);this.onItemsSourceChanged();this._srcChanged=!0;this._reload()}},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"childItemsPath",{get:function(){return this._itmPath.path},set:function(e){if(e!=this.childItemsPath){this._itmPath.path=e;this._reload()}},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"displayMemberPath",{get:function(){return this._dspPath.path},set:function(e){if(e!=this.displayMemberPath){this._dspPath.path=e;this._reload()}},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"imageMemberPath",{get:function(){return this._imgPath.path},set:function(e){if(e!=this.imageMemberPath){this._imgPath.path=e;this._reload()}},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"checkedMemberPath",{get:function(){return this._chkPath.path},set:function(e){if(e!=this.checkedMemberPath){this._chkPath.path=e;this._reload()}},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"isContentHtml",{get:function(){return this._html},set:function(e){if(e!=this._html){this._html=wijmo_1.asBoolean(e);this._reload()}},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"showCheckboxes",{get:function(){return this._showChk},set:function(e){if(e!=this._showChk){this._showChk=wijmo_1.asBoolean(e);this._reload()}},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"autoCollapse",{get:function(){return this._autoColl},set:function(e){this._autoColl=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"collapseWhenDisabled",{get:function(){return this._collapseWhenDisabled},set:function(e){this._collapseWhenDisabled=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"isAnimated",{get:function(){return this._animated},set:function(e){this._animated=wijmo_1.asBoolean(e);wijmo_1.toggleClass(this.hostElement,"wj-animated",this._animated)},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"isReadOnly",{get:function(){return this._isReadOnly},set:function(e){this._isReadOnly=wijmo_1.asBoolean(e);wijmo_1.toggleClass(this.hostElement,"wj-state-readonly",this.isReadOnly)},enumerable:!0,configurable:!0});TreeView.prototype.startEditing=function(e){if(this.isReadOnly)return!1;e||(e=this.selectedNode);if(!e||e.isDisabled)return!1;if(!this.finishEditing())return!1;var t=e.element.querySelector("."+TreeView._CNDT);if(!t)return!1;var i=new TreeNodeEventArgs(e);if(!this.onNodeEditStarting(i))return!1;t.tabIndex=0;t.focus();t.contentEditable="true";t.style.cursor="auto";var n=document.createRange();n.selectNodeContents(t);var o=getSelection();o.removeAllRanges();o.addRange(n);t.focus();wijmo_1.setAttribute(t,"autocomplete","off");wijmo_1.setAttribute(t,"autocorrect","off");this._edtNode=e;this.onNodeEditStarted(i);return!0};TreeView.prototype.finishEditing=function(e){var t=this._edtNode;if(t){var i=t.element.querySelector("."+TreeView._CNDT);if(!i)return!1;var n=new TreeNodeEventArgs(t);if(!this.onNodeEditEnding(n))return!1;var o=t.dataItem,r=t.level;this.isContentHtml?e?i.innerHTML=this._dspPath.getValue(o,r):this._dspPath.setValue(o,r,i.innerHTML):e?i.textContent=this._dspPath.getValue(o,r):this._dspPath.setValue(o,r,i.textContent);document.createRange().selectNodeContents(i);getSelection().removeAllRanges();i.contentEditable="false";i.style.cursor="";this._edtNode=null;this.onNodeEditEnded(n)}return!0};Object.defineProperty(TreeView.prototype,"allowDragging",{get:function(){return null!=this._dd},set:function(e){if(e!=this.allowDragging){if(wijmo_1.asBoolean(e))this._dd=new _TreeDragDropManager(this);else{this._dd.dispose();this._dd=null}for(var t=this.hostElement.querySelectorAll("."+TreeView._CND),i=0;i<t.length;i++){var n=t[i];wijmo_1.setAttribute(n,"draggable",!!this._dd||null)}}},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"checkOnClick",{get:function(){return this._chkOnClick},set:function(e){this._chkOnClick=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"expandOnClick",{get:function(){return this._xpndOnClick},set:function(e){this._xpndOnClick=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"collapseOnClick",{get:function(){return this._collOnClick},set:function(e){this._collOnClick=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"expandOnLoad",{get:function(){return this._xpndOnLoad},set:function(e){this._xpndOnLoad=wijmo_1.asBoolean(e)},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"selectedItem",{get:function(){return this._selNode?this._selNode.dataItem:null},set:function(e){if(e!=this.selectedItem){this._isDirty&&this.refresh();this.selectedNode=e?this.getNode(e):null}},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"selectedNode",{get:function(){return this._selNode},set:function(e){if(e!=this.selectedNode){this._prevSel=this._selNode;if(e)e.select();else if(this._selNode){var t=this._selNode.element;wijmo_1.removeClass(t,TreeView._CSEL);wijmo_1.setAttribute(t,"aria-selected",!1);this._selNode=null;this._updateFocus(this._prevSel);this.onSelectedItemChanged()}}},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"selectedPath",{get:function(){for(var e=[],t=this.selectedNode;t;t=t.parentNode){var i=this._dspPath.getValue(t.dataItem,t.level);e.splice(0,0,i)}return e},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"checkedItems",{get:function(){if(null==this._chkItems){var e=TreeView,t="."+e._CND+"."+e._CEMP+" > input:checked."+e._CNDC,i=this._root.querySelectorAll(t);this._chkItems=[];for(var n=0;n<i.length;n++){var o=i[n].parentElement[e._DATAITEM_KEY];this._chkItems.push(o)}}return this._chkItems},set:function(e){if(this.showCheckboxes){this._isDirty&&this.refresh();for(var t=TreeView,i="."+t._CND+"."+t._CEMP,n=this._root.querySelectorAll(i),o=0;o<n.length;o++){var r=new TreeNode(this,n[o]),s=e.indexOf(r.dataItem)>-1;r.isChecked!=s&&(r.isChecked=s)}}},enumerable:!0,configurable:!0});TreeView.prototype.checkAllItems=function(e){if(this.showCheckboxes)for(var t=TreeView,i="."+t._CND+"."+t._CEMP,n=this._root.querySelectorAll(i),o=0;o<n.length;o++){var r=new TreeNode(this,n[o]);r.isChecked!=e&&(r.isChecked=e)}};Object.defineProperty(TreeView.prototype,"totalItemCount",{get:function(){return this.hostElement.querySelectorAll("."+TreeView._CND).length},enumerable:!0,configurable:!0});Object.defineProperty(TreeView.prototype,"lazyLoadFunction",{get:function(){return this._lazyLoad},set:function(e){if(e!=this._lazyLoad){this._lazyLoad=wijmo_1.asFunction(e);this._reload()}},enumerable:!0,configurable:!0});TreeView.prototype.getFirstNode=function(e,t){var i=this.hostElement.querySelector("."+TreeView._CND),n=i?new TreeNode(this,i):null;e&&n&&!n.element.offsetHeight&&(n=n.next(e,t));t&&n&&n.isDisabled&&(n=n.next(e,t));return n};TreeView.prototype.getLastNode=function(e,t){var i=this.hostElement.querySelectorAll("."+TreeView._CND+":last-child"),n=i.length?new TreeNode(this,i[i.length-1]):null;e&&n&&!n.element.offsetHeight&&(n=n.previous(e,t));t&&n&&n.isDisabled&&(n=n.previous(e,t));return n};Object.defineProperty(TreeView.prototype,"nodes",{get:function(){return TreeNode._getChildNodes(this,this._root)},enumerable:!0,configurable:!0});TreeView.prototype.getNode=function(e){this._isDirty&&this._loadTree();for(var t=this.hostElement.querySelectorAll("."+TreeView._CND),i=0;i<t.length;i++){var n=t[i];if(n[TreeView._DATAITEM_KEY]==e)return new TreeNode(this,n)}return null};TreeView.prototype.addChildNode=function(e,t){var i=this._createNode(t),n=this.nodes;n?e<n.length?i.move(n[e],DropPosition.Before):i.move(n[n.length-1],DropPosition.After):i.move(this,DropPosition.Into);return i};TreeView.prototype.collapseToLevel=function(e){var t=this._animated,i=this._autoColl;this._animated=this._autoColl=!1;this._collapseToLevel(this.nodes,e,0);this._animated=t;this._autoColl=i};TreeView.prototype.loadTree=function(e){this._loadTree(e)};TreeView.prototype.onItemsSourceChanged=function(e){this.itemsSourceChanged.raise(this,e)};TreeView.prototype.onLoadingItems=function(e){this.loadingItems.raise(this,e);return!e.cancel};TreeView.prototype.onLoadedItems=function(e){this.loadedItems.raise(this,e)};TreeView.prototype.onItemClicked=function(e){this.itemClicked.raise(this,e)};TreeView.prototype.onSelectedItemChanged=function(e){this.selectedItemChanged.raise(this,e)};TreeView.prototype.onCheckedItemsChanged=function(e){this._chkItems=null;this.checkedItemsChanged.raise(this,e)};TreeView.prototype.onIsCollapsedChanging=function(e){this.isCollapsedChanging.raise(this,e);return!e.cancel};TreeView.prototype.onIsCollapsedChanged=function(e){this.isCollapsedChanged.raise(this,e)};TreeView.prototype.onIsCheckedChanging=function(e){this.isCheckedChanging.raise(this,e);return!e.cancel};TreeView.prototype.onIsCheckedChanged=function(e){this.isCheckedChanged.raise(this,e)};TreeView.prototype.onFormatItem=function(e){this.formatItem.raise(this,e)};TreeView.prototype.onDragStart=function(e){this.dragStart.raise(this,e);return!e.cancel};TreeView.prototype.onDragOver=function(e){this.dragOver.raise(this,e);return!e.cancel};TreeView.prototype.onDrop=function(e){this.drop.raise(this,e);return!e.cancel};TreeView.prototype.onDragEnd=function(e){this.dragEnd.raise(this,e)};TreeView.prototype.onNodeEditStarting=function(e){this.nodeEditStarting.raise(this,e);return!e.cancel};TreeView.prototype.onNodeEditStarted=function(e){this.nodeEditStarted.raise(this,e)};TreeView.prototype.onNodeEditEnding=function(e){this.nodeEditEnding.raise(this,e);return!e.cancel};TreeView.prototype.onNodeEditEnded=function(e){this.nodeEditEnded.raise(this,e)};TreeView.prototype.refresh=function(t){void 0===t&&(t=!0);e.prototype.refresh.call(this,t);!this.isUpdating&&this._isDirty&&this._loadTree(!0)};TreeView.prototype._updateFocus=function(e){this._updateTabIndex();if(this.containsFocus()){var t=this._selNode;t?t.element.focus():this.hostElement.focus()}e&&(e.element.tabIndex=-1)};TreeView.prototype._updateTabIndex=function(){var e=this._selNode;e&&(e.element.tabIndex=this._orgTabIndex);this.hostElement.tabIndex=e||this.isDisabled?-1:this._orgTabIndex};TreeView.prototype._setTabOrder=function(e){this._orgTabIndex=e;this._updateTabIndex()};TreeView.prototype._raiseCheckedItemsChanged=function(){var e=this;this._toItemsChanged&&clearTimeout(this._toItemsChanged);this._toItemsChanged=setTimeout((function(){e._toItemsChanged=null;e.onCheckedItemsChanged()}),10)};TreeView.prototype._reload=function(){this._isDirty=!0;this.invalidate()};TreeView.prototype._createNode=function(e){return new TreeView(document.createElement("div"),{expandOnLoad:this.expandOnLoad,allowDragging:this.allowDragging,lazyLoadFunction:this.lazyLoadFunction,childItemsPath:this.childItemsPath,displayMemberPath:this.displayMemberPath,imageMemberPath:this.imageMemberPath,isContentHtml:this.isContentHtml,showCheckboxes:this.showCheckboxes,itemsSource:[e]}).getFirstNode()};TreeView.prototype._mousedown=function(e){if(!e.defaultPrevented){var t=wijmo_1.closestClass(e.target,TreeView._CND),i=t?new TreeNode(this,t):null;i&&!i.isDisabled&&(this.selectedNode=i)}};TreeView.prototype._click=function(e){if(!e.defaultPrevented){var t=wijmo_1.closestClass(e.target,TreeView._CND);if(t){var i=new TreeNode(this,t),n="input."+TreeView._CNDC,o=wijmo_1.closest(e.target,n),r=t.getBoundingClientRect(),s=this.rightToLeft?r.right-e.clientX:e.clientX-r.left;if(i.isDisabled)return;if(!o&&i.equals(this._edtNode))return;!o&&this._chkOnClick&&(!i.hasChildren||s>t.offsetHeight)&&(o=t.querySelector(n));var a=this._prevSel;this.selectedNode=i;t.focus();if(o){e.preventDefault();e.stopPropagation();setTimeout((function(){i.isChecked=!i.isChecked}))}if(!o){var d=(e.ctrlKey||e.metaKey)&&!i.hasPendingChildren,l=i.isCollapsed,h=!1;if(i.hasChildren)if(s<=t.offsetHeight){h=!0;d?this.collapseToLevel(l?i.level+1:i.level):i.isCollapsed=!l}else if(this.expandOnClick&&l){h=!0;d?this.collapseToLevel(i.level+1):i.isCollapsed=!1}else if(this.collapseOnClick&&!l){h=!0;d?this.collapseToLevel(i.level):i.isCollapsed=!0}h&&d&&this.selectedNode&&this.selectedNode.ensureVisible();if(!h&&!this.isReadOnly){var c=this.selectedNode;c&&c.equals(a)&&this.startEditing()}}this.selectedItem&&this.onItemClicked()}}};TreeView.prototype._keydown=function(e){if(!e.defaultPrevented){var t=this._getKeyCode(e),i=this._selNode,n=void 0,o=!0;if(!i)switch(t){case wijmo_1.Key.Up:case wijmo_1.Key.Down:case wijmo_1.Key.Left:case wijmo_1.Key.Right:case wijmo_1.Key.Enter:case wijmo_1.Key.Home:case wijmo_1.Key.End:if(n=this.getFirstNode(!0,!0)){this.selectedNode=n;e.preventDefault();return}}if(i&&!i.isDisabled){switch(t){case wijmo_1.Key.F2:this.startEditing();e.preventDefault();break;case wijmo_1.Key.Escape:this.finishEditing(!0);e.preventDefault();break;case wijmo_1.Key.Up:case wijmo_1.Key.Down:this.finishEditing();break;case wijmo_1.Key.Enter:if(this._edtNode){this.finishEditing();t=wijmo_1.Key.Down}else{this.startEditing();e.preventDefault()}}if(this._edtNode)return;if(this.rightToLeft)switch(t){case wijmo_1.Key.Left:t=wijmo_1.Key.Right;break;case wijmo_1.Key.Right:t=wijmo_1.Key.Left}switch(t){case wijmo_1.Key.Left:!i.isCollapsed&&i.hasChildren?i.isCollapsed=!0:(i=i.parentNode)&&i.select();break;case wijmo_1.Key.Right:i.isCollapsed&&i.hasChildren&&(i.isCollapsed=!1);break;case wijmo_1.Key.Up:n=i.previous(!0,!0);break;case wijmo_1.Key.Down:n=i.next(!0,!0);break;case wijmo_1.Key.Home:n=this.getFirstNode(!0,!0);break;case wijmo_1.Key.End:n=this.getLastNode(!0,!0);break;case wijmo_1.Key.Space:if(this.selectedItem){var r=i.checkBox;r&&(i.isChecked=r.indeterminate||!r.checked)}break;case wijmo_1.Key.Enter:this.selectedItem&&this.onItemClicked();break;default:o=!1}if(o){e.preventDefault();n&&n.select()}}}};TreeView.prototype._keypress=function(e){var t=this;if(!e.defaultPrevented){if(e.ctrlKey||e.metaKey||e.altKey)return;if(e.target instanceof HTMLInputElement)return;if(this._edtNode)return;if(e.charCode>32&&this.startEditing(this.selectedNode)){var i=wijmo_1.getActiveElement();if(wijmo_1.contains(this._edtNode.element,i)){i.textContent=String.fromCharCode(e.charCode);e.preventDefault();var n=document.createRange();n.selectNodeContents(i);n.collapse(!1);var o=getSelection();o.removeAllRanges();o.addRange(n)}return}if(e.charCode>32||32==e.charCode&&this._srch){e.preventDefault();this._srch+=String.fromCharCode(e.charCode).toLowerCase();this._toSrch&&clearTimeout(this._toSrch);this._toSrch=setTimeout((function(){t._toSrch=null;t._srch=""}),TreeView._AS_DLY);var r=this._findNext();if(null==r&&this._srch.length>1){this._srch=this._srch[this._srch.length-1];r=this._findNext()}null!=r&&(this.selectedItem=r)}}};TreeView.prototype._findNext=function(){if(this.hostElement&&this.selectedItem){var e=this.getNode(this.selectedItem),t=e,i=!1,n=!1;1==this._srch.length&&(n=!0);for(;t;){if(!t.isDisabled&&!n){if(0==t.element.textContent.trim().toLowerCase().indexOf(this._srch))return t.dataItem}var o=t.next(!0,!0);if(o==e&&i)break;if(!o&&!i){o=this.getFirstNode(!0,!0);i=!0}t=o;n=!1}}return null};TreeView.prototype._loadTree=function(e){var t=this,i=this._root;if(i){if(!this.onLoadingItems(new wijmo_1.CancelEventArgs))return;var n=this.containsFocus(),o=this._srcChanged;this._isDirty=!1;this._srcChanged=!1;var r=this.selectedItem;this.selectedItem=null;this._chkItems=null;this._ldLvl=-1;var s=void 0;if(e&&wijmo_1.isFunction(window.Map)&&!o&&this.nodes.length>0){s=new Map;for(var a=this.hostElement.querySelectorAll("."+TreeView._CND),d=0;d<a.length;d++){var l=a[d];wijmo_1.hasClass(l,TreeView._CCLD)&&s.set(l[TreeView._DATAITEM_KEY],!0)}}i.innerHTML="";this._items&&this._items.forEach((function(e){t._addItem(i,0,e)}));if(s)for(a=this.hostElement.querySelectorAll("."+TreeView._CND),d=0;d<a.length;d++){l=a[d];var h=TreeNode._isNodeList(l.nextElementSibling),c=!TreeNode._isEmpty(l),_=s.get(l[TreeView._DATAITEM_KEY]);c&&(_||h)&&wijmo_1.toggleClass(l,TreeView._CCLD,1==_);wijmo_1.setAttribute(l,"aria-expanded",c?(!wijmo_1.hasClass(l,TreeView._CCLD)).toString():null)}n&&!this.containsFocus()&&this.focus();this.selectedItem=r;this.onLoadedItems();this._ldLvl=-1;this._srcChanged=!1}};TreeView.prototype._addItem=function(e,t,i){var n,o=this._dspPath.getValue(i,t),r=this._imgPath.getValue(i,t),s=wijmo_1.asArray(this._itmPath.getValue(i,t),!0),a=document.createElement("div");wijmo_1.addClass(a,TreeView._CND);a.tabIndex=-1;wijmo_1.setAttribute(a,"role","treeitem",!0);wijmo_1.setAttribute(a,"aria-selected",!1);var d=document.createElement("span");this.isContentHtml?d.innerHTML=o:d.textContent=o;wijmo_1.addClass(d,TreeView._CNDT);a.appendChild(d);if(r){var l=document.createElement("img");l.src=r;a.insertBefore(l,a.firstChild)}if(this._showChk&&!this._lazyLoad){(n=document.createElement("input")).type="checkbox";n.tabIndex=-1;wijmo_1.addClass(n,TreeView._CNDC);a.insertBefore(n,a.firstChild)}this._dd&&a.setAttribute("draggable","true");e.appendChild(a);a[TreeView._DATAITEM_KEY]=i;s&&0==s.length&&!this.lazyLoadFunction&&(s=null);if(s){var h=this.expandOnLoad;if(t>this._ldLvl&&h){this._ldLvl=t;if(0==s.length){h=!1;wijmo_1.addClass(a,TreeView._CCLD)}}else{h=!1;wijmo_1.addClass(a,TreeView._CCLD);t<this._ldLvl&&(this._ldLvl=100)}if(s.length>0){var c=document.createElement("div");c.tabIndex=-1;wijmo_1.addClass(c,TreeView._CNDL);for(var _=0;_<s.length;_++)this._addItem(c,t+1,s[_]);e.appendChild(c);wijmo_1.setAttribute(c,"role","group",!0)}wijmo_1.setAttribute(a,"aria-expanded",h.toString(),!0)}else wijmo_1.addClass(a,TreeView._CEMP);if(n&&this.checkedMemberPath)if(s&&s.length){new TreeNode(this,a)._updateCheckedState()}else n.checked=this._chkPath.getValue(i,t);this.formatItem.hasHandlers&&this.onFormatItem(new FormatNodeEventArgs(i,a,t))};TreeView.prototype._collapseToLevel=function(e,t,i){for(var n=0;n<e.length;n++){var o=e[n];if(!o.hasPendingChildren){o.isCollapsed=i>=t;o.hasChildren&&this._collapseToLevel(o.nodes,t,i+1)}}};TreeView.prototype._lazyLoadNode=function(e){var t=this.hostElement;if(!wijmo_1.hasClass(t,TreeView._CLDG)){wijmo_1.addClass(t,TreeView._CLDG);wijmo_1.addClass(e.element,TreeView._CLDG);this.lazyLoadFunction(e,this._lazyLoadCallback.bind(e))}};TreeView.prototype._lazyLoadCallback=function(e){this.treeView._lazyLoadNodeDone(this,e)};TreeView.prototype._lazyLoadNodeDone=function(e,t){var i=TreeView;wijmo_1.removeClass(e.element,i._CLDG);wijmo_1.removeClass(this.hostElement,i._CLDG);var n=e.dataItem,o=e.level,r=wijmo_1.asArray(t,!0);if(null==r||0==r.length){this._itmPath.setValue(n,o,null);wijmo_1.addClass(e.element,i._CEMP);wijmo_1.removeClass(e.element,i._CCLD)}else if(r.length){this._itmPath.setValue(n,o,r);var s=document.createElement("div"),a=e.element;wijmo_1.addClass(s,i._CNDL);a.parentElement.insertBefore(s,a.nextSibling);for(var d=0;d<r.length;d++)this._addItem(s,o+1,r[d]);e.isCollapsed=!1}};TreeView._DATAITEM_KEY="wj-Data-Item";TreeView._AS_DLY=600;TreeView._AN_DLY=200;TreeView._CND="wj-node";TreeView._CNDL="wj-nodelist";TreeView._CEMP="wj-state-empty";TreeView._CNDT="wj-node-text";TreeView._CNDC="wj-node-check";TreeView._CSEL="wj-state-selected";TreeView._CCLD="wj-state-collapsed";TreeView._CCLG="wj-state-collapsing";TreeView._CLDG="wj-state-loading";TreeView.controlTemplate='<div wj-part="root"></div>';return TreeView}(wijmo_1.Control);exports.TreeView=TreeView;var _TreeDragDropManager=function(){function _TreeDragDropManager(e){this._tree=wijmo_1.asType(e,TreeView);this._dragstartBnd=this._dragstart.bind(this);this._dragoverBnd=this._dragover.bind(this);this._dropBnd=this._drop.bind(this);this._dragendBnd=this._dragend.bind(this);var t=this._tree,i=t.hostElement;t.addEventListener(i,"dragstart",this._dragstartBnd);t.addEventListener(i,"dragover",this._dragoverBnd);t.addEventListener(i,"dragleave",this._dragoverBnd);t.addEventListener(i,"drop",this._dropBnd);t.addEventListener(i,"dragend",this._dragendBnd);t.addEventListener(i,"keydown",this._keydown)}_TreeDragDropManager.prototype.dispose=function(){var e=this._tree,t=e.hostElement;e.removeEventListener(t,"dragstart",this._dragstartBnd);e.removeEventListener(t,"dragover",this._dragoverBnd);e.removeEventListener(t,"dragleave",this._dragoverBnd);e.removeEventListener(t,"drop",this._dropBnd);e.removeEventListener(t,"dragend",this._dragendBnd);e.removeEventListener(t,"keydown",this._keydown);this._showDragMarker()};_TreeDragDropManager.prototype._dragstart=function(e){if(!e.defaultPrevented){var t=this._tree,i=wijmo_1.closestClass(e.target,TreeView._CND),n=_TreeDragDropManager;n._drgSrc=TreeNode._isNode(i)?new TreeNode(t,i):null;if(n._drgSrc){var o=new TreeNodeEventArgs(n._drgSrc);t.onDragStart(o)||(n._drgSrc=null)}if(n._drgSrc&&e.dataTransfer){wijmo_1._startDrag(e.dataTransfer,"copyMove");e.stopPropagation()}else e.preventDefault()}};_TreeDragDropManager.prototype._dragover=function(e){this._handleDragDrop(e,!1)};_TreeDragDropManager.prototype._drop=function(e){this._handleDragDrop(e,!0)};_TreeDragDropManager.prototype._dragend=function(e){_TreeDragDropManager._drgSrc=null;this._showDragMarker();this._tree.onDragEnd()};_TreeDragDropManager.prototype._keydown=function(e){e.defaultPrevented||e.keyCode==wijmo_1.Key.Escape&&this._dragendBnd(null)};_TreeDragDropManager.prototype._handleDragDrop=function(e,t){var i,n,o=this._tree,r=_TreeDragDropManager,s=DropPosition,a=s.Into;if(!e.defaultPrevented&&r._drgSrc){var d=document.elementFromPoint(e.clientX,e.clientY),l=wijmo_1.closestClass(d,TreeView._CND);if(null==l){var h=wijmo_1.Control.getControl(wijmo_1.closest(d,".wj-treeview"));h instanceof TreeView&&0==h.totalItemCount&&(l=h.hostElement)}l==r._drgSrc.element&&(l=null);if(l){n=l.getBoundingClientRect();var c=new TreeNode(o,l),_=c.hasPendingChildren?n.height/2:n.height/3;if(null==c.element){(n=wijmo_1.Rect.fromBoundingRect(n)).inflate(-12,-12);a=s.Before}else if(e.clientY<n.top+_)a=s.Before;else if(e.clientY>n.bottom-_||c.hasPendingChildren){a=s.After;if(c.hasChildren&&!c.isCollapsed&&!c.hasPendingChildren){a=s.Before;n=(l=(c=c.next(!0,!1)).element).getBoundingClientRect()}}if(r._drgSrc._contains(c))l=null;else{(i=new TreeNodeDragDropEventArgs(r._drgSrc,c,a)).cancel=r._drgSrc.treeView!=c.treeView;o.onDragOver(i)||(l=null)}}if(l)if((a=i.position)==s.Before){var u=i.dragSource.next(!0,!1);u&&u.element==l&&(l=null)}else if(a==s.After){var p=i.dragSource.previous(!0,!1);p&&p.element==l&&(l=null)}if(l&&!t){e.dataTransfer.dropEffect="move";e.preventDefault();e.stopPropagation();this._showDragMarker(n,a)}else this._showDragMarker();if(l&&t&&o.onDrop(i)){o.hostElement.focus();var f=i.dragSource;f.move(i.dropTarget,i.position);f.ensureVisible();f.select()}}};_TreeDragDropManager.prototype._showDragMarker=function(e,t){var i=this._tree,n=_TreeDragDropManager._dMarker.parentElement;if(e){var o=i.hostElement.getBoundingClientRect(),r=t==DropPosition.After?e.bottom:e.top,s={top:Math.round(r-o.top+i.hostElement.scrollTop-2),width:"75%",height:t==DropPosition.Into?e.height:4,opacity:t==DropPosition.Into?"0.15":""};i.rightToLeft?s.right=Math.round(o.right-e.right):s.left=Math.round(e.left-o.left);wijmo_1.setCss(_TreeDragDropManager._dMarker,s);n!=i._root&&i._root.appendChild(_TreeDragDropManager._dMarker)}else n&&n.removeChild(_TreeDragDropManager._dMarker)};_TreeDragDropManager._dMarker="undefined"!=typeof window?wijmo_1.createElement('<div class="wj-marker">&nbsp;</div>'):null;return _TreeDragDropManager}();exports._TreeDragDropManager=_TreeDragDropManager;wijmo_1._registerModule("wijmo.nav",selfModule);