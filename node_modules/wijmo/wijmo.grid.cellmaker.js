/*!
    *
    * Wijmo Library 5.20231.879
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */

"use strict";var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);r.default=e;return r};Object.defineProperty(exports,"__esModule",{value:!0});var SparklineType,SparklineMarkers,wijmo_1=require("wijmo/wijmo"),wijmo_grid_1=require("wijmo/wijmo.grid"),selfModule=__importStar(require("wijmo/wijmo.grid.cellmaker"));!function(e){e[e.Line=0]="Line";e[e.Column=1]="Column";e[e.WinLoss=2]="WinLoss"}(SparklineType=exports.SparklineType||(exports.SparklineType={}));!function(e){e[e.None=0]="None";e[e.First=1]="First";e[e.Last=2]="Last";e[e.High=4]="High";e[e.Low=8]="Low";e[e.Negative=16]="Negative"}(SparklineMarkers=exports.SparklineMarkers||(exports.SparklineMarkers={}));var CellMaker=function(){function CellMaker(){}CellMaker.makeButton=function(e){return function(r,t){r.col.isReadOnly=!0;t.innerHTML="";var a=wijmo_1.format('<button type="button" tabindex="-1">{txt}</button>',{txt:CellMaker._getOptionText(e,"text",r,r.text)});CellMaker._createElement(t,a,e,r);return null}};CellMaker.makeLink=function(e){return function(r,t){r.col.isReadOnly=!0;t.innerHTML="";var a=wijmo_1.format('<a href="{href}" tabindex="-1">{txt}</a>',{txt:CellMaker._getOptionText(e,"text",r,r.text),href:CellMaker._getOptionText(e,"href",r,"#")});CellMaker._createElement(t,a,e,r);return null}};CellMaker.makeSparkline=function(e){return function(r,t){r.col.isReadOnly=!0;t.innerHTML="";var a=wijmo_1.format("<div><svg><g>{spark}</g></svg></div>",{spark:CellMaker._getSparkline(r.value,e)});CellMaker._createElement(t,a,e,r);return null}};CellMaker.makeImage=function(e){return function(r,t){r.col.isReadOnly=!0;t.innerHTML="";var a=wijmo_1.format('<img src="{src}"></div>',{src:CellMaker._getOptionText(e,"src",r,r.text)});CellMaker._createElement(t,a,e,r);return null}};CellMaker.makeRating=function(e){return function(r,t){var a=r.col,l=wijmo_grid_1.DataMapEditor,i=a.cssClass||"",n=CellMaker._WJC_CellMaker;if(!a.dataMap||a.dataMapEditor!=l.RadioButtons||i.indexOf(n)<0){for(var o=e?e.range:null,s=[],u=(o=o&&wijmo_1.isArray(o)&&o.length>1&&o[1]>o[0]?o:[0,5])[0];u<=o[1];u++)s.push(u);a.dataMap=new wijmo_grid_1.DataMap(s);a.dataMapEditor=l.RadioButtons;i.indexOf(n)<0&&(a.cssClass=(i+" "+n).trim())}if(e&&e.label){var c=CellMaker._getOptionText(e,"label",r);t.setAttribute("aria-label",c.trim())}var m=t.querySelectorAll("label"),k=!!e&&e.showZeros,M=null==t.querySelector("input:checked");for(u=0;u<m.length;u++){var _=(c=m[u]).querySelector("input");wijmo_1.toggleClass(c,"wj-chk-hidden","0"==_.value&&!k);wijmo_1.toggleClass(c,"wj-chk-off",M);M=M||null!=c.querySelector("input:checked")}return null}};CellMaker._getOptionText=function(e,r,t,a){void 0===a&&(a="");var l=e?e[r]:"";return l?wijmo_1.evalTemplate(l,t):a};CellMaker._createElement=function(e,r,t,a){var l=wijmo_1.createElement(r,e),i=CellMaker._WJC_CellMaker;t&&t.cssClass&&(i+=" "+CellMaker._getOptionText(t,"cssClass",a));l.className=i.trim();if(t&&t.label){var n=CellMaker._getOptionText(t,"label",a);l.setAttribute("aria-label",n.trim());l instanceof HTMLImageElement&&l.setAttribute("alt",n.trim())}if(t&&t.attributes)for(var o in t.attributes)l.setAttribute(o,t.attributes[o]);t&&wijmo_1.isFunction(t.click)&&(l.onclick=CellMaker._handleClick.bind({options:t,ctx:CellMaker._cloneContext(a)}));return l};CellMaker._cloneContext=function(e){if(wijmo_1.isFunction(Object.assign))return Object.assign({},e);var r={};for(var t in e)r[t]=e[t];return r};CellMaker._handleClick=function(e){var r=this.options;if(wijmo_1.isFunction(r.click)){e.preventDefault();var t=this.ctx;r.click(e,t)}};CellMaker._getSparkline=function(e,r){var t="",a=SparklineType,l=SparklineMarkers,i=null!=(r=r||{}).type?r.type:a.Line,n=null!=r.markers?r.markers:l.None,o=wijmo_1.isNumber(r.baseValue)?r.baseValue:i==a.Line?null:0,s=wijmo_1.isNumber(r.maxPoints)?r.maxPoints:null;if(e instanceof Array&&e.length>1){i==a.WinLoss&&(e=e.map((function(e){return wijmo_1.isBoolean(e)?e?1:-1:wijmo_1.isNumber(e)?e>0?1:e<0?-1:null:null})));var u=CellMaker._scaleValues(e,o,s),c=u.points,m=u.base,k=100/(c.length-(i==a.Line?1:0)),M=k>4?k-2:k,_=k-M;switch(i){case a.Column:case a.WinLoss:for(var f=0;f<c.length;f++){var p=c[f];null!=p&&(t+=wijmo_1.format("<rect {cls}x={x}% y={y}% width={w}% height={h}% />",{x:(f*k+_).toFixed(2),y:Math.min(m,p),w:M.toFixed(2),h:Math.abs(m-p),cls:CellMaker._getMarkers(n,u,f)}))}break;case a.Line:for(f=0;f<c.length-1;f++){var C=c[f],w=c[f+1];null!=C&&null!=w&&(t+=wijmo_1.format("<line x1={x1}% y1={y1}% x2={x2}% y2={y2}% />",{x1:Math.round(k*f),y1:C,x2:Math.round(k*(f+1)),y2:w}));var x=CellMaker._getMarkers(n,u,f),g='<circle {cls}cx={x}% cy={y}% r="3"/>';x&&(t+=wijmo_1.format(g,{x:Math.round(k*f),y:C,cls:x}));f==c.length-2&&(x=CellMaker._getMarkers(n,u,f+1))&&(t+=wijmo_1.format(g,{x:Math.round(k*(f+1)),y:w,cls:x}))}}null!=o&&i!=a.WinLoss&&(t+=wijmo_1.format('<line class="x-axis" x1=0% y1={base}% x2=100% y2={base}% />',{base:u.base}))}return t};CellMaker._scaleValues=function(e,r,t){var a,l,i=[];t&&t>1&&e.length>t&&(e=e.slice(0,t));e.forEach((function(e){if(wijmo_1.isNumber(e)){a=!wijmo_1.isNumber(a)||e<a?e:a;l=!wijmo_1.isNumber(l)||e>l?e:l}}));if(wijmo_1.isNumber(a)&&wijmo_1.isNumber(l)){if(null!=r){a=Math.min(a,r);l=Math.max(l,r)}else r=a>0?a:l<0?l:0;if(a==l){a--;l++}var n=l-a;e.forEach((function(e){i.push(wijmo_1.isNumber(e)?100-Math.round((e-a)/n*100):null)}));r=100-Math.round((r-a)/n*100)}return{min:a,max:l,base:r,points:i,data:e}};CellMaker._getMarkers=function(e,r,t){var a="",l=SparklineMarkers;if(e){var i=r.data,n="wj-marker-";0!=(e&l.First)&&0==t&&(a+=n+"first ");0!=(e&l.Last)&&t==i.length-1&&(a+=n+"last ");0!=(e&l.High)&&i[t]==r.max&&(a+=n+"high ");0!=(e&l.Low)&&i[t]==r.min&&(a+=n+"low ");0!=(e&l.Negative)&&i[t]<0&&(a+=n+"negative ")}return a?'class="wj-marker '+a.trim()+'"':""};CellMaker._WJC_CellMaker="wj-cell-maker";return CellMaker}();exports.CellMaker=CellMaker;wijmo_1._registerModule("wijmo.grid.cellmaker",selfModule);